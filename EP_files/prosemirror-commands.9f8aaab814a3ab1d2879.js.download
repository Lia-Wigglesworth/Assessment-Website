(self.webpackChunkep_web=self.webpackChunkep_web||[]).push([["../libs/wp/prosemirror-commands/prosemirror-commands"],{"./node_modules/prosemirror-commands/dist/index.es.js":function(e,t,n){"use strict";n.r(t),n.d(t,{autoJoin:function(){return autoJoin},baseKeymap:function(){return d},chainCommands:function(){return chainCommands},createParagraphNear:function(){return createParagraphNear},deleteSelection:function(){return deleteSelection},exitCode:function(){return exitCode},joinBackward:function(){return joinBackward},joinDown:function(){return joinDown},joinForward:function(){return joinForward},joinUp:function(){return joinUp},lift:function(){return lift},liftEmptyBlock:function(){return liftEmptyBlock},macBaseKeymap:function(){return s},newlineInCode:function(){return newlineInCode},pcBaseKeymap:function(){return l},selectAll:function(){return selectAll},selectNodeBackward:function(){return selectNodeBackward},selectNodeForward:function(){return selectNodeForward},selectParentNode:function(){return selectParentNode},setBlockType:function(){return setBlockType},splitBlock:function(){return splitBlock},splitBlockKeepMarks:function(){return splitBlockKeepMarks},toggleMark:function(){return toggleMark},wrapIn:function(){return wrapIn}});var r=n("./node_modules/prosemirror-transform/dist/index.es.js"),o=n("./node_modules/prosemirror-model/dist/index.es.js"),i=n("./node_modules/prosemirror-state/dist/index.es.js");function deleteSelection(e,t){return!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0)}function joinBackward(e,t,n){var o=e.selection.$cursor;if(!o||(n?!n.endOfTextblock("backward",e):o.parentOffset>0))return!1;var a=findCutBefore(o);if(!a){var c=o.blockRange(),l=c&&(0,r.liftTarget)(c);return null!=l&&(t&&t(e.tr.lift(c,l).scrollIntoView()),!0)}var s=a.nodeBefore;if(!s.type.spec.isolating&&deleteBarrier(e,a,t))return!0;if(0==o.parent.content.size&&(textblockAt(s,"end")||i.NodeSelection.isSelectable(s))){if(t){var f=e.tr.deleteRange(o.before(),o.after());f.setSelection(textblockAt(s,"end")?i.Selection.findFrom(f.doc.resolve(f.mapping.map(a.pos,-1)),-1):i.NodeSelection.create(f.doc,a.pos-s.nodeSize)),t(f.scrollIntoView())}return!0}return!(!s.isAtom||a.depth!=o.depth-1)&&(t&&t(e.tr.delete(a.pos-s.nodeSize,a.pos).scrollIntoView()),!0)}function textblockAt(e,t){for(;e;e="start"==t?e.firstChild:e.lastChild)if(e.isTextblock)return!0;return!1}function selectNodeBackward(e,t,n){var r=e.selection,o=r.$head,a=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):o.parentOffset>0)return!1;a=findCutBefore(o)}var c=a&&a.nodeBefore;return!(!c||!i.NodeSelection.isSelectable(c))&&(t&&t(e.tr.setSelection(i.NodeSelection.create(e.doc,a.pos-c.nodeSize)).scrollIntoView()),!0)}function findCutBefore(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function joinForward(e,t,n){var r=e.selection.$cursor;if(!r||(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size))return!1;var o=findCutAfter(r);if(!o)return!1;var a=o.nodeAfter;if(deleteBarrier(e,o,t))return!0;if(0==r.parent.content.size&&(textblockAt(a,"start")||i.NodeSelection.isSelectable(a))){if(t){var c=e.tr.deleteRange(r.before(),r.after());c.setSelection(textblockAt(a,"start")?i.Selection.findFrom(c.doc.resolve(c.mapping.map(o.pos)),1):i.NodeSelection.create(c.doc,c.mapping.map(o.pos))),t(c.scrollIntoView())}return!0}return!(!a.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos,o.pos+a.nodeSize).scrollIntoView()),!0)}function selectNodeForward(e,t,n){var r=e.selection,o=r.$head,a=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size)return!1;a=findCutAfter(o)}var c=a&&a.nodeAfter;return!(!c||!i.NodeSelection.isSelectable(c))&&(t&&t(e.tr.setSelection(i.NodeSelection.create(e.doc,a.pos)).scrollIntoView()),!0)}function findCutAfter(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){var n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}function joinUp(e,t){var n,o=e.selection,a=o instanceof i.NodeSelection;if(a){if(o.node.isTextblock||!(0,r.canJoin)(e.doc,o.from))return!1;n=o.from}else if(null==(n=(0,r.joinPoint)(e.doc,o.from,-1)))return!1;if(t){var c=e.tr.join(n);a&&c.setSelection(i.NodeSelection.create(c.doc,n-e.doc.resolve(n).nodeBefore.nodeSize)),t(c.scrollIntoView())}return!0}function joinDown(e,t){var n,o=e.selection;if(o instanceof i.NodeSelection){if(o.node.isTextblock||!(0,r.canJoin)(e.doc,o.to))return!1;n=o.to}else if(null==(n=(0,r.joinPoint)(e.doc,o.to,1)))return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0}function lift(e,t){var n=e.selection,o=n.$from,i=n.$to,a=o.blockRange(i),c=a&&(0,r.liftTarget)(a);return null!=c&&(t&&t(e.tr.lift(a,c).scrollIntoView()),!0)}function newlineInCode(e,t){var n=e.selection,r=n.$head,o=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(o))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)}function defaultBlockAt(e){for(var t=0;t<e.edgeCount;t++){var n=e.edge(t).type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function exitCode(e,t){var n=e.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var a=r.node(-1),c=r.indexAfter(-1),l=defaultBlockAt(a.contentMatchAt(c));if(!a.canReplaceWith(c,c,l))return!1;if(t){var s=r.after(),f=e.tr.replaceWith(s,s,l.createAndFill());f.setSelection(i.Selection.near(f.doc.resolve(s),1)),t(f.scrollIntoView())}return!0}function createParagraphNear(e,t){var n=e.selection,r=n.$from,o=n.$to;if(r.parent.inlineContent||o.parent.inlineContent)return!1;var a=defaultBlockAt(r.parent.contentMatchAt(o.indexAfter()));if(!a||!a.isTextblock)return!1;if(t){var c=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,l=e.tr.insert(c,a.createAndFill());l.setSelection(i.TextSelection.create(l.doc,c+1)),t(l.scrollIntoView())}return!0}function liftEmptyBlock(e,t){var n=e.selection.$cursor;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){var o=n.before();if((0,r.canSplit)(e.doc,o))return t&&t(e.tr.split(o).scrollIntoView()),!0}var i=n.blockRange(),a=i&&(0,r.liftTarget)(i);return null!=a&&(t&&t(e.tr.lift(i,a).scrollIntoView()),!0)}function splitBlock(e,t){var n=e.selection,a=n.$from,c=n.$to;if(e.selection instanceof i.NodeSelection&&e.selection.node.isBlock)return!(!a.parentOffset||!(0,r.canSplit)(e.doc,a.pos))&&(t&&t(e.tr.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(t){var l=c.parentOffset==c.parent.content.size,s=e.tr;e.selection instanceof i.TextSelection&&s.deleteSelection();var f=0==a.depth?null:defaultBlockAt(a.node(-1).contentMatchAt(a.indexAfter(-1))),d=l&&f?[{type:f}]:null,p=(0,r.canSplit)(s.doc,s.mapping.map(a.pos),1,d);d||p||!(0,r.canSplit)(s.doc,s.mapping.map(a.pos),1,f&&[{type:f}])||(d=[{type:f}],p=!0),p&&(s.split(s.mapping.map(a.pos),1,d),l||a.parentOffset||a.parent.type==f||!a.node(-1).canReplace(a.index(-1),a.indexAfter(-1),o.Fragment.from(f.create(),a.parent))||s.setNodeMarkup(s.mapping.map(a.before()),f)),t(s.scrollIntoView())}return!0}function splitBlockKeepMarks(e,t){return splitBlock(e,t&&function(n){var r=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();r&&n.ensureMarks(r),t(n)})}function selectParentNode(e,t){var n,r=e.selection,o=r.$from,a=r.to,c=o.sharedDepth(a);return 0!=c&&(n=o.before(c),t&&t(e.tr.setSelection(i.NodeSelection.create(e.doc,n))),!0)}function selectAll(e,t){return t&&t(e.tr.setSelection(new i.AllSelection(e.doc))),!0}function deleteBarrier(e,t,n){var a,c,l=t.nodeBefore,s=t.nodeAfter;if(l.type.spec.isolating||s.type.spec.isolating)return!1;if(function joinMaybeClear(e,t,n){var o=t.nodeBefore,i=t.nodeAfter,a=t.index();return!(!(o&&i&&o.type.compatibleContent(i.type))||(!o.content.size&&t.parent.canReplace(a-1,a)?(n&&n(e.tr.delete(t.pos-o.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(a,a+1)||!i.isTextblock&&!(0,r.canJoin)(e.doc,t.pos)||(n&&n(e.tr.clearIncompatible(t.pos,o.type,o.contentMatchAt(o.childCount)).join(t.pos).scrollIntoView()),0)))}(e,t,n))return!0;if(t.parent.canReplace(t.index(),t.index()+1)&&(a=(c=l.contentMatchAt(l.childCount)).findWrapping(s.type))&&c.matchType(a[0]||s.type).validEnd){if(n){for(var f=t.pos+s.nodeSize,d=o.Fragment.empty,p=a.length-1;p>=0;p--)d=o.Fragment.from(a[p].create(null,d));d=o.Fragment.from(l.copy(d));var u=e.tr.step(new r.ReplaceAroundStep(t.pos-1,f,t.pos,f,new o.Slice(d,1,0),a.length,!0)),m=f+2*a.length;(0,r.canJoin)(u.doc,m)&&u.join(m),n(u.scrollIntoView())}return!0}var k=i.Selection.findFrom(t,1),v=k&&k.$from.blockRange(k.$to),w=v&&(0,r.liftTarget)(v);return null!=w&&w>=t.depth&&(n&&n(e.tr.lift(v,w).scrollIntoView()),!0)}function wrapIn(e,t){return function(n,o){var i=n.selection,a=i.$from,c=i.$to,l=a.blockRange(c),s=l&&(0,r.findWrapping)(l,e,t);return!!s&&(o&&o(n.tr.wrap(l,s).scrollIntoView()),!0)}}function setBlockType(e,t){return function(n,r){var o=n.selection,i=o.from,a=o.to,c=!1;return n.doc.nodesBetween(i,a,(function(r,o){if(c)return!1;if(r.isTextblock&&!r.hasMarkup(e,t))if(r.type==e)c=!0;else{var i=n.doc.resolve(o),a=i.index();c=i.parent.canReplaceWith(a,a+1,e)}})),!!c&&(r&&r(n.tr.setBlockType(i,a,e,t).scrollIntoView()),!0)}}function toggleMark(e,t){return function(n,r){var o=n.selection,i=o.empty,a=o.$cursor,c=o.ranges;if(i&&!a||!function markApplies(e,t,n){for(var loop=function(r){var o=t[r],i=o.$from,a=o.$to,c=0==i.depth&&e.type.allowsMarkType(n);if(e.nodesBetween(i.pos,a.pos,(function(e){if(c)return!1;c=e.inlineContent&&e.type.allowsMarkType(n)})),c)return{v:!0}},r=0;r<t.length;r++){var o=loop(r);if(o)return o.v}return!1}(n.doc,c,e))return!1;if(r)if(a)e.isInSet(n.storedMarks||a.marks())?r(n.tr.removeStoredMark(e)):r(n.tr.addStoredMark(e.create(t)));else{for(var l=!1,s=n.tr,f=0;!l&&f<c.length;f++){var d=c[f],p=d.$from,u=d.$to;l=n.doc.rangeHasMark(p.pos,u.pos,e)}for(var m=0;m<c.length;m++){var k=c[m],v=k.$from,w=k.$to;l?s.removeMark(v.pos,w.pos,e):s.addMark(v.pos,w.pos,e.create(t))}r(s.scrollIntoView())}return!0}}function autoJoin(e,t){if(Array.isArray(t)){var n=t;t=function(e){return n.indexOf(e.type.name)>-1}}return function(n,o){return e(n,o&&function wrapDispatchForJoin(e,t){return function(n){if(!n.isGeneric)return e(n);for(var o=[],i=0;i<n.mapping.maps.length;i++){for(var a=n.mapping.maps[i],c=0;c<o.length;c++)o[c]=a.map(o[c]);a.forEach((function(e,t,n,r){return o.push(n,r)}))}for(var l=[],s=0;s<o.length;s+=2)for(var f=o[s],d=o[s+1],p=n.doc.resolve(f),u=p.sharedDepth(d),m=p.node(u),k=p.indexAfter(u),v=p.after(u+1);v<=d;++k){var w=m.maybeChild(k);if(!w)break;if(k&&-1==l.indexOf(v)){var h=m.child(k-1);h.type==w.type&&t(h,w)&&l.push(v)}v+=w.nodeSize}l.sort((function(e,t){return e-t}));for(var g=l.length-1;g>=0;g--)(0,r.canJoin)(n.doc,l[g])&&n.join(l[g]);e(n)}}(o,t))}}function chainCommands(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(t,n,r){for(var o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}var a=chainCommands(deleteSelection,joinBackward,selectNodeBackward),c=chainCommands(deleteSelection,joinForward,selectNodeForward),l={Enter:chainCommands(newlineInCode,createParagraphNear,liftEmptyBlock,splitBlock),"Mod-Enter":exitCode,Backspace:a,"Mod-Backspace":a,Delete:c,"Mod-Delete":c,"Mod-a":selectAll},s={"Ctrl-h":l.Backspace,"Alt-Backspace":l["Mod-Backspace"],"Ctrl-d":l.Delete,"Ctrl-Alt-Backspace":l["Mod-Delete"],"Alt-Delete":l["Mod-Delete"],"Alt-d":l["Mod-Delete"]};for(var f in l)s[f]=l[f];var d=("undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&"darwin"==os.platform())?s:l}}]);