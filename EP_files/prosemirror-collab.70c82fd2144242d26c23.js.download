(self.webpackChunkep_web=self.webpackChunkep_web||[]).push([["../libs/wp/prosemirror-collab/prosemirror-collab"],{"./node_modules/prosemirror-collab/dist/index.es.js":function(e,n,t){"use strict";t.d(n,{Cw:function(){return collab},bo:function(){return getVersion},$E:function(){return receiveTransaction},_1:function(){return sendableSteps}});var r=t("./node_modules/prosemirror-state/dist/index.es.js"),i=function Rebaseable(e,n,t){this.step=e,this.inverted=n,this.origin=t};var o=function CollabState(e,n){this.version=e,this.unconfirmed=n};var s=new r.PluginKey("collab");function collab(e){return void 0===e&&(e={}),e={version:e.version||0,clientID:null==e.clientID?Math.floor(4294967295*Math.random()):e.clientID},new r.Plugin({key:s,state:{init:function(){return new o(e.version,[])},apply:function apply(e,n){var t=e.getMeta(s);return t||(e.docChanged?new o(n.version,n.unconfirmed.concat(function unconfirmedFrom(e){for(var n=[],t=0;t<e.steps.length;t++)n.push(new i(e.steps[t],e.steps[t].invert(e.docs[t]),e));return n}(e))):n)}},config:e,historyPreserveItems:!0})}function receiveTransaction(e,n,t,a){for(var c=s.getState(e),l=c.version+n.length,u=s.get(e).spec.config.clientID,p=0;p<t.length&&t[p]==u;)++p;var f=c.unconfirmed.slice(p);if(!(n=p?n.slice(p):n).length)return e.tr.setMeta(s,new o(l,f));var g=f.length,d=e.tr;if(g)f=function rebaseSteps(e,n,t){for(var r=e.length-1;r>=0;r--)t.step(e[r].inverted);for(var o=0;o<n.length;o++)t.step(n[o]);for(var s=[],a=0,c=e.length;a<e.length;a++){var l=e[a].step.map(t.mapping.slice(c));c--,l&&!t.maybeStep(l).failed&&(t.mapping.setMirror(c,t.steps.length-1),s.push(new i(l,l.invert(t.docs[t.docs.length-1]),e[a].origin)))}return s}(f,n,d);else{for(var v=0;v<n.length;v++)d.step(n[v]);f=[]}var h=new o(l,f);return a&&a.mapSelectionBackward&&e.selection instanceof r.TextSelection&&(d.setSelection(r.TextSelection.between(d.doc.resolve(d.mapping.map(e.selection.anchor,-1)),d.doc.resolve(d.mapping.map(e.selection.head,-1)),-1)),d.updated&=-2),d.setMeta("rebased",g).setMeta("addToHistory",!1).setMeta(s,h)}function sendableSteps(e){var n=s.getState(e);return 0==n.unconfirmed.length?null:{version:n.version,steps:n.unconfirmed.map((function(e){return e.step})),clientID:s.get(e).spec.config.clientID,get origins(){return this._origins||(this._origins=n.unconfirmed.map((function(e){return e.origin})))}}}function getVersion(e){return s.getState(e).version}}}]);