(self.webpackChunkep_web=self.webpackChunkep_web||[]).push([["../libs/wp/@pixi/particles/particles"],{"./node_modules/@pixi/particles/lib/particles.es.js":function(t,e,i){"use strict";i.d(e,{T:function(){return u},P:function(){return p}});var r=i("./node_modules/@pixi/constants/lib/constants.es.js"),a=i("./node_modules/@pixi/display/lib/display.es.js"),n=i("./node_modules/@pixi/utils/lib/utils.es.js"),o=i("./node_modules/@pixi/core/lib/core.es.js"),s=i("./node_modules/@pixi/math/lib/math.es.js"),extendStatics=function(t,e){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function __extends(t,e){function __(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(__.prototype=e.prototype,new __)}var u=function(t){function ParticleContainer(e,i,a,n){void 0===e&&(e=1500),void 0===a&&(a=16384),void 0===n&&(n=!1);var o=t.call(this)||this;return a>16384&&(a=16384),o._properties=[!1,!0,!1,!1,!1],o._maxSize=e,o._batchSize=a,o._buffers=null,o._bufferUpdateIDs=[],o._updateID=0,o.interactiveChildren=!1,o.blendMode=r.T$.NORMAL,o.autoResize=n,o.roundPixels=!0,o.baseTexture=null,o.setProperties(i),o._tint=0,o.tintRgb=new Float32Array(4),o.tint=16777215,o}return __extends(ParticleContainer,t),ParticleContainer.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},ParticleContainer.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(ParticleContainer.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,(0,n.hex2rgb)(t,this.tintRgb)},enumerable:!1,configurable:!0}),ParticleContainer.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",(function(){return e.onChildrenChange(0)}))),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},ParticleContainer.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},ParticleContainer.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},ParticleContainer.prototype.destroy=function(e){t.prototype.destroy.call(this,e),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},ParticleContainer}(a.W2),l=function(){function ParticleBuffer(t,e,i){this.geometry=new o.ZX,this.indexBuffer=null,this.size=i,this.dynamicProperties=[],this.staticProperties=[];for(var a=0;a<t.length;++a){var n=t[a];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||r.vK.FLOAT,offset:n.offset},e[a]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return ParticleBuffer.prototype.initBuffers=function(){var t=this.geometry,e=0;this.indexBuffer=new o.lW((0,n.createIndicesForQuads)(this.size),!0,!0),t.addIndex(this.indexBuffer),this.dynamicStride=0;for(var i=0;i<this.dynamicProperties.length;++i){(l=this.dynamicProperties[i]).offset=e,e+=l.size,this.dynamicStride+=l.size}var a=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(a),this.dynamicDataUint32=new Uint32Array(a),this.dynamicBuffer=new o.lW(this.dynamicData,!1,!1);var s=0;this.staticStride=0;for(i=0;i<this.staticProperties.length;++i){(l=this.staticProperties[i]).offset=s,s+=l.size,this.staticStride+=l.size}var u=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(u),this.staticDataUint32=new Uint32Array(u),this.staticBuffer=new o.lW(this.staticData,!0,!1);for(i=0;i<this.dynamicProperties.length;++i){var l=this.dynamicProperties[i];t.addAttribute(l.attributeName,this.dynamicBuffer,0,l.type===r.vK.UNSIGNED_BYTE,l.type,4*this.dynamicStride,4*l.offset)}for(i=0;i<this.staticProperties.length;++i){l=this.staticProperties[i];t.addAttribute(l.attributeName,this.staticBuffer,0,l.type===r.vK.UNSIGNED_BYTE,l.type,4*this.staticStride,4*l.offset)}},ParticleBuffer.prototype.uploadDynamic=function(t,e,i){for(var a=0;a<this.dynamicProperties.length;a++){var n=this.dynamicProperties[a];n.uploadFunction(t,e,i,n.type===r.vK.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++},ParticleBuffer.prototype.uploadStatic=function(t,e,i){for(var a=0;a<this.staticProperties.length;a++){var n=this.staticProperties[a];n.uploadFunction(t,e,i,n.type===r.vK.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++},ParticleBuffer.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},ParticleBuffer}(),p=function(t){function ParticleRenderer(e){var i=t.call(this,e)||this;return i.shader=null,i.properties=null,i.tempMatrix=new s.y3,i.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:i.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:i.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:i.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:i.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:r.vK.UNSIGNED_BYTE,uploadFunction:i.uploadTint,offset:0}],i.shader=o.ex.from("attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n","varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",{}),i.state=o.ZM.for2d(),i}return __extends(ParticleRenderer,t),ParticleRenderer.prototype.render=function(t){var e=t.children,i=t._maxSize,r=t._batchSize,a=this.renderer,o=e.length;if(0!==o){o>i&&!t.autoResize&&(o=i);var s=t._buffers;s||(s=t._buffers=this.generateBuffers(t));var u=e[0]._texture.baseTexture;this.state.blendMode=(0,n.correctBlendMode)(t.blendMode,u.alphaMode),a.state.set(this.state);var l=a.gl,p=t.worldTransform.copyTo(this.tempMatrix);p.prepend(a.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=p.toArray(!0),this.shader.uniforms.uColor=(0,n.premultiplyRgba)(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,u.alphaMode),this.shader.uniforms.uSampler=u,this.renderer.shader.bind(this.shader);for(var c=!1,h=0,d=0;h<o;h+=r,d+=1){var f=o-h;f>r&&(f=r),d>=s.length&&s.push(this._generateOneMoreBuffer(t));var y=s[d];y.uploadDynamic(e,h,f);var v=t._bufferUpdateIDs[d]||0;(c=c||y._updateID<v)&&(y._updateID=t._updateID,y.uploadStatic(e,h,f)),a.geometry.bind(y.geometry),l.drawElements(l.TRIANGLES,6*f,l.UNSIGNED_SHORT,0)}}},ParticleRenderer.prototype.generateBuffers=function(t){for(var e=[],i=t._maxSize,r=t._batchSize,a=t._properties,n=0;n<i;n+=r)e.push(new l(this.properties,a,r));return e},ParticleRenderer.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,i=t._properties;return new l(this.properties,i,e)},ParticleRenderer.prototype.uploadVertices=function(t,e,i,r,a,n){for(var o=0,s=0,u=0,l=0,p=0;p<i;++p){var c=t[e+p],h=c._texture,d=c.scale.x,f=c.scale.y,y=h.trim,v=h.orig;y?(o=(s=y.x-c.anchor.x*v.width)+y.width,u=(l=y.y-c.anchor.y*v.height)+y.height):(o=v.width*(1-c.anchor.x),s=v.width*-c.anchor.x,u=v.height*(1-c.anchor.y),l=v.height*-c.anchor.y),r[n]=s*d,r[n+1]=l*f,r[n+a]=o*d,r[n+a+1]=l*f,r[n+2*a]=o*d,r[n+2*a+1]=u*f,r[n+3*a]=s*d,r[n+3*a+1]=u*f,n+=4*a}},ParticleRenderer.prototype.uploadPosition=function(t,e,i,r,a,n){for(var o=0;o<i;o++){var s=t[e+o].position;r[n]=s.x,r[n+1]=s.y,r[n+a]=s.x,r[n+a+1]=s.y,r[n+2*a]=s.x,r[n+2*a+1]=s.y,r[n+3*a]=s.x,r[n+3*a+1]=s.y,n+=4*a}},ParticleRenderer.prototype.uploadRotation=function(t,e,i,r,a,n){for(var o=0;o<i;o++){var s=t[e+o].rotation;r[n]=s,r[n+a]=s,r[n+2*a]=s,r[n+3*a]=s,n+=4*a}},ParticleRenderer.prototype.uploadUvs=function(t,e,i,r,a,n){for(var o=0;o<i;++o){var s=t[e+o]._texture._uvs;s?(r[n]=s.x0,r[n+1]=s.y0,r[n+a]=s.x1,r[n+a+1]=s.y1,r[n+2*a]=s.x2,r[n+2*a+1]=s.y2,r[n+3*a]=s.x3,r[n+3*a+1]=s.y3,n+=4*a):(r[n]=0,r[n+1]=0,r[n+a]=0,r[n+a+1]=0,r[n+2*a]=0,r[n+2*a+1]=0,r[n+3*a]=0,r[n+3*a+1]=0,n+=4*a)}},ParticleRenderer.prototype.uploadTint=function(t,e,i,r,a,o){for(var s=0;s<i;++s){var u=t[e+s],l=u._texture.baseTexture.alphaMode>0,p=u.alpha,c=p<1&&l?(0,n.premultiplyTint)(u._tintRGB,p):u._tintRGB+(255*p<<24);r[o]=c,r[o+a]=c,r[o+2*a]=c,r[o+3*a]=c,o+=4*a}},ParticleRenderer.prototype.destroy=function(){t.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},ParticleRenderer}(o.bO)}}]);