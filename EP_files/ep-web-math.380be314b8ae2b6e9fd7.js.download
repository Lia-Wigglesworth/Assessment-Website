(self.webpackChunkep_web=self.webpackChunkep_web||[]).push([["../libs/wp/@educationperfect/ep-web-math/ep-web-math"],{"./node_modules/@educationperfect/ep-web-math/dist/math.min.js":function(t,r,o){var i=o("./node_modules/jquery/dist/jquery-exposed.js");!function webpackUniversalModuleDefinition(r,i){t.exports=i(o("./node_modules/@educationperfect/ep-web-services/lib/services.js"),o("./node_modules/@educationperfect/ep-web-utils/dist/ep-web-utils.min.js"),o("./node_modules/katex/dist/katex.js"),o("./node_modules/tslib/tslib.es6.js"))}("undefined"!=typeof self&&self,(function(t,r,o,a){return(()=>{"use strict";var p={7692:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.DeferredInProgess=void 0;var i=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(DeferredInProgess,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(DeferredInProgess);function DeferredInProgess(){return _classCallCheck(this,DeferredInProgess),r.apply(this,arguments)}return DeferredInProgess}(o(4774).Deferred);r.DeferredInProgess=i},9745:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.EquationInputType=void 0,function(t){t[t.Text=0]="Text"}(r.EquationInputType||(r.EquationInputType={}))},8062:(t,r,o)=>{function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.EquationManager=void 0;var i=o(9726),a=o(3892),p=o(4783),l=o(3033),u=o(1891),c=o(2687),h=o(7076),m=function(){function EquationManager(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,EquationManager),this.comparisonParsers=[],this.shaneTexLexer=new c.MathLexer,this.latexLexer=new u.LatexLexer}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(EquationManager,[{key:"areEquationsEquivalent",value:function areEquationsEquivalent(t,r){var o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l.FormulaFormats.AUTO_DETECT,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l.FormulaFormats.AUTO_DETECT;if(!this.shaneTexLexer||!this.latexLexer||0==this.comparisonParsers.length)return-1;switch(i){case l.FormulaFormats.LATEX:o=this.latexLexer.scanInput(t);break;case l.FormulaFormats.SHANETEX:default:o=this.shaneTexLexer.scanInput(t)}var p,u=[],c=_createForOfIteratorHelper(r);try{for(c.s();!(p=c.n()).done;){var h=p.value,m=void 0;switch(a){case l.FormulaFormats.LATEX:m=this.latexLexer.scanInput(h);break;case l.FormulaFormats.SHANETEX:default:m=this.shaneTexLexer.scanInput(h)}u.push(m)}}catch(t){c.e(t)}finally{c.f()}var T,E=_createForOfIteratorHelper(this.comparisonParsers);try{for(E.s();!(T=E.n()).done;)for(var y=T.value,d=y.parseTokenStream(o.clone()),C=0;C<r.length;C++){var _=y.parseTokenStream(u[C].clone());if(0==this.comparer.compare(d,_))return C}}catch(t){E.e(t)}finally{E.f()}return-1}},{key:"areAllNumbersInEquationRoundedAppropriately",value:function areAllNumbersInEquationRoundedAppropriately(t,r,o){if(null==o||o==h.AnswerRoundingHelper.NONE)return!0;var a=EquationManager.generateExpressionTreeForInput(t,this.shaneTexLexer,this.displayParser);return i.ExpressionTreeRoundingValidator.validateRounding(a,o,r)}},{key:"generateDisplayLatexFromEquationString",value:function generateDisplayLatexFromEquationString(t,r){if(!this.shaneTexLexer||!this.displayParser)return"";var o=EquationManager.generateExpressionTreeForInput(t,this.shaneTexLexer,this.displayParser),i=p.BaseExpressionTreeComponent.outputLatexForExpressionTree(o,r);return a.WorkingFormulaEditorConverter.removeExpressionEntityComponentsViaTextMatching(i)}}],[{key:"generateExpressionTreeForInput",value:function generateExpressionTreeForInput(t,r,o){var i=r.scanInput(t);return o.parseTokenStream(i)}}]),EquationManager}();r.EquationManager=m},3033:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.FormulaFormats=void 0,function(t){t[t.AUTO_DETECT=0]="AUTO_DETECT",t[t.MATHML=1]="MATHML",t[t.LATEX=2]="LATEX",t[t.SHANETEX=3]="SHANETEX",t[t.PLAIN_TEXT=4]="PLAIN_TEXT"}(r.FormulaFormats||(r.FormulaFormats={}))},4493:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.MathEquationManager=void 0;var i=o(1269),a=o(8062),p=o(6815),l=o(8987),u=o(6415),c=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(MathEquationManager,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(MathEquationManager);function MathEquationManager(){var t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;_classCallCheck(this,MathEquationManager),(t=r.call(this)).configuration=u.MathParserConfigurationHelper.getDefaultMarkedStepFormulaMarkingParameters();var c=p.MathFunctionsAndConstants.Instance.DefaultMathFunctions;null!=o&&(c=c.concat(o));var h=p.MathFunctionsAndConstants.Instance.DefaultMathConstants;return null!=a&&(h=h.concat(a)),t.comparer=new i.ExpressionTreeComparer,t.addSubtractComparisonParser=new l.MathParser(c,h,t.comparer,!0,!0),t.addSubtractComparisonParser.normaliseEqualsMode=l.MathParser.NORMALISE_EQUALS_MODE_ADDITION,t.addSubtractComparisonParser.anySimplification=!0,t.comparisonParsers.push(t.addSubtractComparisonParser),t.multiplyDivideComparisonParser=new l.MathParser(c,h,t.comparer,!0,!0),t.multiplyDivideComparisonParser.normaliseEqualsMode=l.MathParser.NORMALISE_EQUALS_MODE_MULTIPLICATION,t.multiplyDivideComparisonParser.anySimplification=!0,t.comparisonParsers.push(t.multiplyDivideComparisonParser),t.noMovementComparisonParser=new l.MathParser(c,h,t.comparer,!0,!0),t.noMovementComparisonParser.normaliseEqualsMode=l.MathParser.NORMALISE_EQUALS_MODE_NONE,t.noMovementComparisonParser.anySimplification=!0,t.displayParser=new l.MathParser(c,h,t.comparer,!0,!1),t.displayParser.anySimplification=!1,t}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathEquationManager,[{key:"configureParsers",value:function configureParsers(t){this.configuration=u.MathParserConfigurationHelper.getDefaultMarkedStepFormulaMarkingParameters(),u.MathParserConfigurationHelper.transferConfigurationParameters(t,this.configuration)}},{key:"checkAnswerWithCustomRounding",value:function checkAnswerWithCustomRounding(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=this.comparer;return l.applyAcceptableError=null!=a,l.roundingAmount=o,l.roundingType=i,l.acceptableErrorType=a,l.acceptableMarginValue=p,this.checkAnswer(t,r)}},{key:"checkAnswer",value:function checkAnswer(t,r){if(this.comparisonParsers=[],1!=this.configuration.EqualsMovements||1!=this.configuration.AddSubtractRearrangements&&1!=this.configuration.MultiplyDivideRearrangements?(u.MathParserConfigurationHelper.configureParser(this.noMovementComparisonParser,this.configuration),this.comparisonParsers.push(this.noMovementComparisonParser)):(1==this.configuration.AddSubtractRearrangements&&(u.MathParserConfigurationHelper.configureParser(this.addSubtractComparisonParser,this.configuration),this.comparisonParsers.push(this.addSubtractComparisonParser)),1==this.configuration.MultiplyDivideRearrangements&&(u.MathParserConfigurationHelper.configureParser(this.multiplyDivideComparisonParser,this.configuration),this.comparisonParsers.push(this.multiplyDivideComparisonParser))),-1!=this.areEquationsEquivalent(r,t)){var o=this.comparer;return this.areAllNumbersInEquationRoundedAppropriately(r,o.roundingAmount,o.roundingType)}return!1}}]),MathEquationManager}(a.EquationManager);r.MathEquationManager=c},6815:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MathFunctionsAndConstants=void 0;var i=o(252),a=o(8818),p=o(9884),l=function(){function MathFunctionsAndConstants(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MathFunctionsAndConstants),this.mathFunctions=[],this.mathConstants=[],this.mathFunctions=[];var t=this.mathFunctions;t.push(new p.MathEntityMatchInfo("sin",new a.MathFunctionComponent(null,"sin"))),t.push(new p.MathEntityMatchInfo("cos",new a.MathFunctionComponent(null,"cos"))),t.push(new p.MathEntityMatchInfo("tan",new a.MathFunctionComponent(null,"tan"))),t.push(new p.MathEntityMatchInfo("sinh",new a.MathFunctionComponent(null,"sinh"))),t.push(new p.MathEntityMatchInfo("cosh",new a.MathFunctionComponent(null,"cosh"))),t.push(new p.MathEntityMatchInfo("tanh",new a.MathFunctionComponent(null,"tanh"))),t.push(new p.MathEntityMatchInfo("cot",new a.MathFunctionComponent(null,"cot"))),t.push(new p.MathEntityMatchInfo("sec",new a.MathFunctionComponent(null,"sec"))),t.push(new p.MathEntityMatchInfo("cosec",new a.MathFunctionComponent(null,"cosec"))),t.push(new p.MathEntityMatchInfo("log",new a.MathFunctionComponent(null,"log"))),t.push(new p.MathEntityMatchInfo("lg",new a.MathFunctionComponent(null,"lg"))),t.push(new p.MathEntityMatchInfo("ln",new a.MathFunctionComponent(null,"ln"))),t.push(new p.MathEntityMatchInfo("Pr",new a.MathFunctionComponent(null,"Pr"))),this.mathConstants=[];var r=this.mathConstants;r.push(new p.MathEntityMatchInfo("pi",new i.MathEntityComponent("π"))),r.push(new p.MathEntityMatchInfo("π",new i.MathEntityComponent("π"))),r.push(new p.MathEntityMatchInfo("alpha",new i.MathEntityComponent("α"))),r.push(new p.MathEntityMatchInfo("α",new i.MathEntityComponent("α"))),r.push(new p.MathEntityMatchInfo("Alpha",new i.MathEntityComponent("Α"),!0)),r.push(new p.MathEntityMatchInfo("Α",new i.MathEntityComponent("Α"),!0)),r.push(new p.MathEntityMatchInfo("beta",new i.MathEntityComponent("β"))),r.push(new p.MathEntityMatchInfo("β",new i.MathEntityComponent("β"))),r.push(new p.MathEntityMatchInfo("Beta",new i.MathEntityComponent("Β"),!0)),r.push(new p.MathEntityMatchInfo("Β",new i.MathEntityComponent("Β"),!0)),r.push(new p.MathEntityMatchInfo("gamma",new i.MathEntityComponent("γ"))),r.push(new p.MathEntityMatchInfo("γ",new i.MathEntityComponent("γ"))),r.push(new p.MathEntityMatchInfo("Gamma",new i.MathEntityComponent("Γ"),!0)),r.push(new p.MathEntityMatchInfo("Γ",new i.MathEntityComponent("Γ"),!0)),r.push(new p.MathEntityMatchInfo("delta",new i.MathEntityComponent("δ"))),r.push(new p.MathEntityMatchInfo("δ",new i.MathEntityComponent("δ"))),r.push(new p.MathEntityMatchInfo("Delta",new i.MathEntityComponent("Δ"),!0)),r.push(new p.MathEntityMatchInfo("Δ",new i.MathEntityComponent("Δ"),!0)),r.push(new p.MathEntityMatchInfo("triangle",new i.MathEntityComponent("Δ"),!0)),r.push(new p.MathEntityMatchInfo("∆",new i.MathEntityComponent("Δ"))),r.push(new p.MathEntityMatchInfo("epsilon",new i.MathEntityComponent("ε"))),r.push(new p.MathEntityMatchInfo("ε",new i.MathEntityComponent("ε"))),r.push(new p.MathEntityMatchInfo("Epsilon",new i.MathEntityComponent("Ε"),!0)),r.push(new p.MathEntityMatchInfo("Ε",new i.MathEntityComponent("Ε"),!0)),r.push(new p.MathEntityMatchInfo("zeta",new i.MathEntityComponent("ζ"))),r.push(new p.MathEntityMatchInfo("ζ",new i.MathEntityComponent("ζ"))),r.push(new p.MathEntityMatchInfo("Zeta",new i.MathEntityComponent("Ζ"),!0)),r.push(new p.MathEntityMatchInfo("Ζ",new i.MathEntityComponent("Ζ"),!0)),r.push(new p.MathEntityMatchInfo("eta",new i.MathEntityComponent("η"))),r.push(new p.MathEntityMatchInfo("η",new i.MathEntityComponent("η"))),r.push(new p.MathEntityMatchInfo("Eta",new i.MathEntityComponent("Η"),!0)),r.push(new p.MathEntityMatchInfo("Η",new i.MathEntityComponent("Η"),!0)),r.push(new p.MathEntityMatchInfo("theta",new i.MathEntityComponent("θ"))),r.push(new p.MathEntityMatchInfo("θ",new i.MathEntityComponent("θ"))),r.push(new p.MathEntityMatchInfo("Theta",new i.MathEntityComponent("Θ"),!0)),r.push(new p.MathEntityMatchInfo("Θ",new i.MathEntityComponent("Θ"),!0)),r.push(new p.MathEntityMatchInfo("iota",new i.MathEntityComponent("ι"))),r.push(new p.MathEntityMatchInfo("ι",new i.MathEntityComponent("ι"))),r.push(new p.MathEntityMatchInfo("Iota",new i.MathEntityComponent("Ι"),!0)),r.push(new p.MathEntityMatchInfo("Ι",new i.MathEntityComponent("Ι"),!0)),r.push(new p.MathEntityMatchInfo("kappa",new i.MathEntityComponent("κ"))),r.push(new p.MathEntityMatchInfo("κ",new i.MathEntityComponent("κ"))),r.push(new p.MathEntityMatchInfo("Kappa",new i.MathEntityComponent("Κ"),!0)),r.push(new p.MathEntityMatchInfo("Κ",new i.MathEntityComponent("Κ"),!0)),r.push(new p.MathEntityMatchInfo("lambda",new i.MathEntityComponent("λ"))),r.push(new p.MathEntityMatchInfo("λ",new i.MathEntityComponent("λ"))),r.push(new p.MathEntityMatchInfo("Lambda",new i.MathEntityComponent("Λ"),!0)),r.push(new p.MathEntityMatchInfo("Λ",new i.MathEntityComponent("Λ"),!0)),r.push(new p.MathEntityMatchInfo("mu",new i.MathEntityComponent("μ"))),r.push(new p.MathEntityMatchInfo("μ",new i.MathEntityComponent("μ"))),r.push(new p.MathEntityMatchInfo("Mu",new i.MathEntityComponent("Μ"))),r.push(new p.MathEntityMatchInfo("Μ",new i.MathEntityComponent("Μ"))),r.push(new p.MathEntityMatchInfo("nu",new i.MathEntityComponent("ν"))),r.push(new p.MathEntityMatchInfo("ν",new i.MathEntityComponent("ν"))),r.push(new p.MathEntityMatchInfo("Nu",new i.MathEntityComponent("Ν"))),r.push(new p.MathEntityMatchInfo("Ν",new i.MathEntityComponent("Ν"))),r.push(new p.MathEntityMatchInfo("xi",new i.MathEntityComponent("ξ"))),r.push(new p.MathEntityMatchInfo("ξ",new i.MathEntityComponent("ξ"))),r.push(new p.MathEntityMatchInfo("Xi",new i.MathEntityComponent("Ξ"))),r.push(new p.MathEntityMatchInfo("Ξ",new i.MathEntityComponent("Ξ"))),r.push(new p.MathEntityMatchInfo("omicron",new i.MathEntityComponent("ο"))),r.push(new p.MathEntityMatchInfo("ο",new i.MathEntityComponent("ο"))),r.push(new p.MathEntityMatchInfo("Omicron",new i.MathEntityComponent("Ο"),!0)),r.push(new p.MathEntityMatchInfo("Ο",new i.MathEntityComponent("Ο"),!0)),r.push(new p.MathEntityMatchInfo("rho",new i.MathEntityComponent("ρ"))),r.push(new p.MathEntityMatchInfo("ρ",new i.MathEntityComponent("ρ"))),r.push(new p.MathEntityMatchInfo("Rho",new i.MathEntityComponent("Ρ"),!0)),r.push(new p.MathEntityMatchInfo("Ρ",new i.MathEntityComponent("Ρ"),!0)),r.push(new p.MathEntityMatchInfo("sigma",new i.MathEntityComponent("σ"))),r.push(new p.MathEntityMatchInfo("σ",new i.MathEntityComponent("σ"))),r.push(new p.MathEntityMatchInfo("Sigma",new i.MathEntityComponent("Σ"),!0)),r.push(new p.MathEntityMatchInfo("Σ",new i.MathEntityComponent("Σ"),!0)),r.push(new p.MathEntityMatchInfo("tau",new i.MathEntityComponent("τ"))),r.push(new p.MathEntityMatchInfo("τ",new i.MathEntityComponent("τ"))),r.push(new p.MathEntityMatchInfo("Tau",new i.MathEntityComponent("Τ"),!0)),r.push(new p.MathEntityMatchInfo("Τ",new i.MathEntityComponent("Τ"),!0)),r.push(new p.MathEntityMatchInfo("upsilon",new i.MathEntityComponent("υ"))),r.push(new p.MathEntityMatchInfo("υ",new i.MathEntityComponent("υ"))),r.push(new p.MathEntityMatchInfo("Upsilon",new i.MathEntityComponent("Υ"),!0)),r.push(new p.MathEntityMatchInfo("Υ",new i.MathEntityComponent("Υ"),!0)),r.push(new p.MathEntityMatchInfo("phi",new i.MathEntityComponent("φ"))),r.push(new p.MathEntityMatchInfo("φ",new i.MathEntityComponent("φ"))),r.push(new p.MathEntityMatchInfo("Phi",new i.MathEntityComponent("Φ"),!0)),r.push(new p.MathEntityMatchInfo("Φ",new i.MathEntityComponent("Φ"),!0)),r.push(new p.MathEntityMatchInfo("chi",new i.MathEntityComponent("χ"))),r.push(new p.MathEntityMatchInfo("χ",new i.MathEntityComponent("χ"))),r.push(new p.MathEntityMatchInfo("Chi",new i.MathEntityComponent("Χ"),!0)),r.push(new p.MathEntityMatchInfo("Χ",new i.MathEntityComponent("Χ"),!0)),r.push(new p.MathEntityMatchInfo("psi",new i.MathEntityComponent("ψ"))),r.push(new p.MathEntityMatchInfo("ψ",new i.MathEntityComponent("ψ"))),r.push(new p.MathEntityMatchInfo("Psi",new i.MathEntityComponent("Ψ"),!0)),r.push(new p.MathEntityMatchInfo("Ψ",new i.MathEntityComponent("Ψ"),!0)),r.push(new p.MathEntityMatchInfo("omega",new i.MathEntityComponent("ω"))),r.push(new p.MathEntityMatchInfo("ω",new i.MathEntityComponent("ω"))),r.push(new p.MathEntityMatchInfo("Omega",new i.MathEntityComponent("Ω"),!0)),r.push(new p.MathEntityMatchInfo("Ω",new i.MathEntityComponent("Ω"),!0)),r.push(new p.MathEntityMatchInfo("e",new i.MathEntityComponent("e")))}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathFunctionsAndConstants,[{key:"DefaultMathFunctions",get:function get(){return this.mathFunctions.concat()}},{key:"DefaultMathConstants",get:function get(){return this.mathConstants.concat()}}]),MathFunctionsAndConstants}();r.MathFunctionsAndConstants=l,l.Instance=new l},2792:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MathLib=void 0;var o=function MathLib(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MathLib)};r.MathLib=o,o.LIB_BASE_URL="",o.USE_WEBWORKER=!0},8878:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MathMarkingLocal=void 0;var i=o(8002),a=o(8373),p=o(8351),l=o(8447),u=function(){function MathMarkingLocal(t){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MathMarkingLocal),this.mathMarkingService=t}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathMarkingLocal,[{key:"init",value:function init(t,r){this.hasMetadataChanged(t)&&(this.comparisonEngine=null),this.metadata=t,this.isAdmin=r}},{key:"hasMetadataChanged",value:function hasMetadataChanged(t){if(!this.metadata)return!0;var r=this.metadata.MarkingParameters.AnySimplification!==t.MarkingParameters.AnySimplification||this.metadata.MarkingParameters.EqualsMovements!==t.MarkingParameters.EqualsMovements||this.metadata.MarkingParameters.NumericSimplification!==t.MarkingParameters.NumericSimplification||this.metadata.MarkingParameters.AddSubtractRearrangements!==t.MarkingParameters.AddSubtractRearrangements||this.metadata.MarkingParameters.MultiplyDivideRearrangements!==t.MarkingParameters.MultiplyDivideRearrangements||this.metadata.MarkingParameters.ExpansionOfBrackets!==t.MarkingParameters.ExpansionOfBrackets||this.metadata.MarkingParameters.GroupLikeTerms!==t.MarkingParameters.GroupLikeTerms||this.metadata.MarkingParameters.AutoCloseBrackets!==t.MarkingParameters.AutoCloseBrackets||this.metadata.MarkingParameters.SimplifyExponents!==t.MarkingParameters.SimplifyExponents||this.metadata.MarkingParameters.CaseSensitive!==t.MarkingParameters.CaseSensitive||this.metadata.MarkingParameters.ShowImmediateFeedback!==t.MarkingParameters.ShowImmediateFeedback||this.metadata.MarkingParameters.ShowHints!==t.MarkingParameters.ShowHints||this.metadata.MarkingParameters.MaxHints!==t.MarkingParameters.MaxHints||this.metadata.MarkingParameters.AutoGenerateLHSVariants!==t.MarkingParameters.AutoGenerateLHSVariants||this.metadata.MarkingParameters.AllowInvertedSigns!==t.MarkingParameters.AllowInvertedSigns||this.metadata.MarkingParameters.StringMatchMode!==t.MarkingParameters.StringMatchMode||(this.metadata.MarkingParameters.CustomFunctions||[]).join()!==(t.MarkingParameters.CustomFunctions||[]).join()||JSON.stringify(this.metadata.MarkingParameters.Synonyms)!==JSON.stringify(t.MarkingParameters.Synonyms),o=this.metadata.ComparisonInfo.RoundingAmount!==t.ComparisonInfo.RoundingAmount||this.metadata.ComparisonInfo.RoundingTypeCode!==t.ComparisonInfo.RoundingTypeCode||this.metadata.ComparisonInfo.AcceptableErrorValue!==t.ComparisonInfo.AcceptableErrorValue||this.metadata.ComparisonInfo.AcceptableErrorTypeCode!==t.ComparisonInfo.AcceptableErrorTypeCode||this.metadata.ComparisonInfo.RoundUsersAnswer!==t.ComparisonInfo.RoundUsersAnswer,i=this.metadata.IgnoreThousandsSeparators!==t.IgnoreThousandsSeparators;return r||o||i}},{key:"precompile",value:function precompile(t,r){try{var o=MathMarkingLocal.convertStepsSets(r),a=this.getComparisonEngine().preCompileStaticSteps(o),p={id:t,cmd:i.WorkerMessageCmds.PRECOMPILE_COMPLETE,trees:a};this.sendMessage(p)}catch(t){var l={cmd:i.WorkerMessageCmds.PRECOMPILE_ERROR,errorMsg:String(t)};this.sendMessage(l)}}},{key:"getComparisonEngine",value:function getComparisonEngine(){return null==this.comparisonEngine&&(this.comparisonEngine=this.prepareComparisonEngine()),this.comparisonEngine}},{key:"prepareComparisonEngine",value:function prepareComparisonEngine(){var t=null,r=null,o=!1;if(this.metadata.MarkingParameters.StringMatchMode)return new p.StringComparer;if(MathMarkingLocal.isWorkingFormulaComponent(this.metadata)){var i=this.metadata;t=i.UnmarkedStepMarkingParameters,r=i.UnmarkedStepComparisonInfo,o=i.IgnoreThousandsSeparators}return a.MathWorkingComparerConfigurationHelper.createAndConfigureWorkingComparer(this.metadata.MarkingParameters,t,this.metadata.ComparisonInfo,r,o)}},{key:"compareSteps",value:function compareSteps(t,r,o,a){try{a&&this.hasMetadataChanged(a)&&(this.metadata=a,this.comparisonEngine=null);var p=MathMarkingLocal.convertStepsSets(r),l=MathMarkingLocal.convertSteps(o),u=this.getComparisonEngine().compareSteps(p,l,this.isAdmin),c={cmd:i.WorkerMessageCmds.COMPARE_STEPS_COMPLETE,id:t,comparedSteps:u};this.sendMessage(c)}catch(r){var h={cmd:i.WorkerMessageCmds.COMPARE_STEPS_ERROR,id:t,errorMsg:String(r)};this.sendMessage(h)}}},{key:"sendMessage",value:function sendMessage(t){this.mathMarkingService.onWorkerMessage(t)}},{key:"postMessage",value:function postMessage(t){var r=t,o=t,a=t;switch(t.cmd){case i.WorkerMessageCmds.INIT:this.init(r.metadata,r.isAdmin);break;case i.WorkerMessageCmds.PRECOMPLILE:this.precompile(o.id,o.correctStepsSets);break;case i.WorkerMessageCmds.COMPARE_STEPS:this.compareSteps(a.id,a.correctStepsSets,a.usersSteps,a.metadata)}}},{key:"cleanup",value:function cleanup(){this.comparisonEngine=null,this.metadata=null}}],[{key:"isWorkingFormulaComponent",value:function isWorkingFormulaComponent(t){return void 0!==t.UnmarkedStepComparisonInfo}},{key:"convertStepsSets",value:function convertStepsSets(t){return t.map(this.convertSteps)}},{key:"convertSteps",value:function convertSteps(t){return t.map(l.WorkingStep.fromWorkingStep)}}]),MathMarkingLocal}();r.MathMarkingLocal=u},9521:(t,r,o)=>{function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MathMarkingService=void 0;var i=o(4780),a=o(2395),p=o(4774),l=o(7692),u=o(8002),c=o(2792),h=o(8878),m=o(8447),T=o(7722),E=function(){function MathMarkingService(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MathMarkingService),this.initilised=!1,this.metaDataSet=!1}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathMarkingService,[{key:"init",value:function init(){return i.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function _callee(){var t,r=this;return regeneratorRuntime.wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:if(!this.initilised){o.next=2;break}return o.abrupt("return");case 2:if(this.cleanupIntervalID=window.setInterval((function(){r.cleanUpOldSteps()}),1e4),!c.MathLib.USE_WEBWORKER){o.next=19;break}if(o.prev=4,MathMarkingService.cachedWorkerScript){o.next=10;break}return t="".concat(c.MathLib.LIB_BASE_URL,"/dist/").concat("mathMarkingWorker.js"),o.next=9,c.MathLib.FetchLocalFileAsUrl(t);case 9:MathMarkingService.cachedWorkerScript=o.sent;case 10:this.worker=new Worker(MathMarkingService.cachedWorkerScript),this.worker.onmessage=function(t){return r.onWorkerEvent(t)},o.next=17;break;case 14:throw o.prev=14,o.t0=o.catch(4),new Error("Problem loading MathMarkingWorker:".concat(o.t0));case 17:o.next=20;break;case 19:this.workerLocal=new h.MathMarkingLocal(this);case 20:case"end":return o.stop()}}),_callee,this,[[4,14]])})))}},{key:"setMetaData",value:function setMetaData(t,r){return i.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function _callee2(){var o;return regeneratorRuntime.wrap((function _callee2$(i){for(;;)switch(i.prev=i.next){case 0:return this.metadata=t,this.isAdmin=r,this.cleanupDeferredSteps(),this.compareStepsDefers={},this.precompileDefers={},o={cmd:u.WorkerMessageCmds.INIT,metadata:t,isAdmin:this.isAdmin},i.prev=6,i.next=9,this.workerPostMessage(o);case 9:i.next=14;break;case 11:throw i.prev=11,i.t0=i.catch(6),new Error("Error posting to WebWorker");case 14:this.metaDataSet=!0;case 15:case"end":return i.stop()}}),_callee2,this,[[6,11]])})))}},{key:"checkInit",value:function checkInit(){return i.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:if(this.initilised){t.next=4;break}return t.next=3,this.init();case 3:this.initilised=!0;case 4:case"end":return t.stop()}}),_callee3,this)})))}},{key:"workerPostMessage",value:function workerPostMessage(t){return i.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function _callee4(){var r=this;return regeneratorRuntime.wrap((function _callee4$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,this.checkInit();case 2:if(!c.MathLib.USE_WEBWORKER){o.next=13;break}o.prev=3,this.worker.postMessage(t),o.next=11;break;case 7:throw o.prev=7,o.t0=o.catch(3),MathMarkingService.logger.captureMessage("Math WebWorker failed to postMessage",{extra:{message:t},stacktrace:!0}),o.t0;case 11:o.next=14;break;case 13:setTimeout((function(){r.workerLocal.postMessage(t)}));case 14:case"end":return o.stop()}}),_callee4,this,[[3,7]])})))}},{key:"onWorkerEvent",value:function onWorkerEvent(t){var r=t.data;this.onWorkerMessage(r)}},{key:"onWorkerMessage",value:function onWorkerMessage(t){switch(t.cmd){case u.WorkerMessageCmds.COMPARE_STEPS_ERROR:var r=t;this.onErrorCompareSteps(r.id,r.errorMsg);break;case u.WorkerMessageCmds.COMPARE_STEPS_COMPLETE:var o=t;this.onCompareSteps(o.id,o.comparedSteps);break;case u.WorkerMessageCmds.PRECOMPILE_ERROR:var i=t;this.onErrorPrecompile(i.id,i.errorMsg);break;case u.WorkerMessageCmds.PRECOMPILE_COMPLETE:var a=t;this.onPrecompileComplete(a.id,a.trees);break;default:console.error("I just received a message I know not how to handle.",t)}}},{key:"preCompile",value:function preCompile(t){var r=this.getAttemptHash(t,[]),o=this.precompileDefers&&this.precompileDefers[r];if(o)return o;var i=new l.DeferredInProgess;i.inProgress=!0,i.time=Date.now();var a={id:r,cmd:u.WorkerMessageCmds.PRECOMPLILE,correctStepsSets:t};try{this.workerPostMessage(a)}catch(t){i.reject("Error posting to WebWorker")}return this.precompileDefers[r]=i,i}},{key:"onPrecompileComplete",value:function onPrecompileComplete(t,r){var o=this.precompileDefers&&this.precompileDefers[t];o&&(o.inProgress&&(o.inProgress=!1,o.time=Date.now()-o.time),o.resolve(r))}},{key:"onErrorPrecompile",value:function onErrorPrecompile(t,r){var o=this.precompileDefers&&this.precompileDefers[t];o?o.reject(r):console.error("MathMarkingWebWorker:preCompile ".concat(t," error:").concat(r))}},{key:"getAttemptHash",value:function getAttemptHash(t,r){var o,i=[],l=_createForOfIteratorHelper(t);try{for(l.s();!(o=l.n()).done;){var u,c=o.value,h=[],m=_createForOfIteratorHelper(c);try{for(m.s();!(u=m.n()).done;){var T=u.value;h.push(T.getFormulas())}}catch(t){m.e(t)}finally{m.f()}i.push(h)}}catch(t){l.e(t)}finally{l.f()}var E,y=[],d=[],C=_createForOfIteratorHelper(r);try{for(C.s();!(E=C.n()).done;){var _=E.value;y.push(_.getFormulas()),d.push(_.id)}}catch(t){C.e(t)}finally{C.f()}var O={correctStepsSets:i,usersSteps:y,usersStepIDs:d},g=a.JSONUtil.stringifyJson(O);return p.md5.hash(g)}},{key:"compareSteps",value:function compareSteps(t,r,o){return i.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function _callee5(){var i,a,p,c;return regeneratorRuntime.wrap((function _callee5$(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.checkInit();case 2:if(i=this.getAttemptHash(t,r),!(a=this.getCompareStepsDefer(i))){h.next=6;break}return h.abrupt("return",a);case 6:if(p=new l.DeferredInProgess,this.compareStepsDefers)if(this.worker||this.workerLocal){c={cmd:u.WorkerMessageCmds.COMPARE_STEPS,id:i,correctStepsSets:t,usersSteps:r,metadata:o};try{this.workerPostMessage(c)}catch(t){p.reject("Error posting to WebWorker")}}else p.reject("No Worker");else p.reject("No compare steps");return this.compareStepsDefers[i]=p,h.abrupt("return",p);case 10:case"end":return h.stop()}}),_callee5,this)})))}},{key:"onCompareSteps",value:function onCompareSteps(t,r){var o=this.getCompareStepsDefer(t);if(null!=o){o.inProgress=!1;var i,a=[],p=_createForOfIteratorHelper(r);try{for(p.s();!(i=p.n()).done;){var l=i.value,u=T.WorkingStepComparison.fromWorker(l);l.userStep&&(u.userStep=m.WorkingStep.fromWorkingStep(l.userStep)),l.correctStep&&(u.correctStep=m.WorkingStep.fromWorkingStep(l.correctStep)),a.push(u)}}catch(t){p.e(t)}finally{p.f()}this.compareStepsDefers[t].resolve(a)}}},{key:"cleanUpOldSteps",value:function cleanUpOldSteps(){var t=Date.now()-1e4;p.DictionaryHelper.removeWhere(this.compareStepsDefers,(function(r){return r.time<t&&!r.inProgress}))}},{key:"getCompareStepsDefer",value:function getCompareStepsDefer(t){return this.compareStepsDefers&&this.compareStepsDefers.hasOwnProperty(t)?this.compareStepsDefers[t]:null}},{key:"onErrorCompareSteps",value:function onErrorCompareSteps(t,r){if(null!=this.getCompareStepsDefer(t)){this.compareStepsDefers[t].reject(r),delete this.compareStepsDefers[t];try{var o={message:"MathMarkingWebWorker:compareSteps",category:"action",level:"info",data:{errorMsg:r,metadata:a.JSONUtil.stringifyJson(this.metadata)}};MathMarkingService.logger.captureBreadcrumb(o),MathMarkingService.logger.captureMessage("MathMarkingWebWorker:compareSteps error")}catch(t){}this.isAdmin&&window.alert("There is a problem with this formula component: ".concat(this.metadata.ComponentID,". ").concat(r))}else console.error("ID not found")}},{key:"cancelCleanupTimer",value:function cancelCleanupTimer(){this.cleanupTimerID=null}},{key:"resetCleanupTimer",value:function resetCleanupTimer(){var t=this;this.cancelCleanupTimer();var r=Date.now();this.cleanupTimerID=r,setTimeout((function(){t.cleanupTimerID===r&&t.cleanup()}),3e4)}},{key:"cleanup",value:function cleanup(){if(this.areAnyDefersPending())return console.error("Tried to cleanup MathMarkingService with pending defers."),void this.resetCleanupTimer();console.error("kill MathMarkingWebWorker"),this.initilised=!1,this.cleanupIntervalID&&(window.clearInterval(this.cleanupIntervalID),this.cleanupIntervalID=null),this.cleanupDeferredSteps(),this.metaDataSet=!1,this.worker&&(this.worker.terminate(),this.worker=null),this.workerLocal&&(this.workerLocal.cleanup(),this.workerLocal=null)}},{key:"areAnyDefersPending",value:function areAnyDefersPending(){if(this.compareStepsDefers)for(var t=0,r=Object.keys(this.compareStepsDefers);t<r.length;t++){var o=r[t];if(this.compareStepsDefers[o].inProgress)return!0}if(this.precompileDefers)for(var i=0,a=Object.keys(this.precompileDefers);i<a.length;i++){var p=a[i];if(this.precompileDefers[p].inProgress)return!0}return!1}},{key:"cleanupDeferredSteps",value:function cleanupDeferredSteps(){if(this.compareStepsDefers){for(var t=0,r=Object.keys(this.compareStepsDefers);t<r.length;t++){var o=r[t];this.compareStepsDefers[o].reject("Reject promise in cleanupDeferredSteps"),delete this.compareStepsDefers[o]}this.compareStepsDefers=null}}}],[{key:"getInstance",value:function getInstance(){return this.instance||(this.instance=new MathMarkingService),this.instance}},{key:"setLogger",value:function setLogger(t){MathMarkingService.logger=t}},{key:"serviceName",get:function get(){return"mathMarkingService"}}]),MathMarkingService}();r.MathMarkingService=E},8373:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MathWorkingComparerConfigurationHelper=void 0;var i=o(1269),a=o(6815),p=o(8987),l=o(6415),u=o(8181),c=o(907),h=o(7722),m=function(){function MathWorkingComparerConfigurationHelper(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MathWorkingComparerConfigurationHelper)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathWorkingComparerConfigurationHelper,null,[{key:"createAndConfigureWorkingComparer",value:function createAndConfigureWorkingComparer(t,r,o,p,u){var h=!(null==r&&null==p);null==t&&(t=l.MathParserConfigurationHelper.getDefaultMarkedStepFormulaMarkingParameters()),null==r&&(r=l.MathParserConfigurationHelper.getDefaultUnmarkedStepFormulaMarkingParameters()),null==o&&(o=l.MathParserConfigurationHelper.getDefaultComparisonParameters()),null==p&&(p=o);var m=l.MathParserConfigurationHelper.generateCustomFunctionItemsFromParameters(t),T=a.MathFunctionsAndConstants.Instance.DefaultMathFunctions.concat(m),E=l.MathParserConfigurationHelper.generateSynonymItemsForComparisonFromParameters(t),y=a.MathFunctionsAndConstants.Instance.DefaultMathConstants.concat(E),d=new i.ExpressionTreeComparer;l.MathParserConfigurationHelper.configureExpressionTreeComparer(d,o);var C=new i.ExpressionTreeComparer;l.MathParserConfigurationHelper.configureExpressionTreeComparer(C,p);var _,O=this.configureQuestionSpecificParsers(t,d,T,y);_=h?this.configureQuestionSpecificParsers(r,C,T,y):O.concat();var g=null==t.AutoGenerateLHSVariants||t.AutoGenerateLHSVariants>0,v=null==r.AutoGenerateLHSVariants||r.AutoGenerateLHSVariants>0;return new c.WorkingComparer(T,y,d,C,O,_,g,v,u)}},{key:"configureQuestionSpecificParsers",value:function configureQuestionSpecificParsers(t,r,o,i){var a=[];if(1==t.NumericSimplification){var c=new p.MathParser(o,i,r,!0,!0);c.anySimplification=!0,c.normaliseEqualsMode=p.MathParser.NORMALISE_EQUALS_MODE_NONE,l.MathParserConfigurationHelper.configureParser(c,t),c.numericSimplification=!1,c.allowInvertedSigns=!1,a.push(new u.ParserStrictnessScoringInfo(c,.8,h.WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT))}var m=new p.MathParser(o,i,r,!0,!0);if(m.anySimplification=!0,m.normaliseEqualsMode=p.MathParser.NORMALISE_EQUALS_MODE_NONE,l.MathParserConfigurationHelper.configureParser(m,t),a.push(new u.ParserStrictnessScoringInfo(m,.8,h.WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT)),t.EqualsMovements>0){if(t.AddSubtractRearrangements>0){var T=new p.MathParser(o,i,r,!0,!0);T.anySimplification=!0,T.normaliseEqualsMode=p.MathParser.NORMALISE_EQUALS_MODE_ADDITION,l.MathParserConfigurationHelper.configureParser(T,t),a.push(new u.ParserStrictnessScoringInfo(T,.75,h.WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT))}if(t.MultiplyDivideRearrangements>0){var E=new p.MathParser(o,i,r,!0,!0);E.anySimplification=!0,E.normaliseEqualsMode=p.MathParser.NORMALISE_EQUALS_MODE_MULTIPLICATION,l.MathParserConfigurationHelper.configureParser(E,t),a.push(new u.ParserStrictnessScoringInfo(E,.75,h.WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT))}}return a}}]),MathWorkingComparerConfigurationHelper}();r.MathWorkingComparerConfigurationHelper=m},1269:(t,r,o)=>{function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.ExpressionTreeComparer=void 0;var i=o(340),a=o(9837),p=o(3597),l=function(){function ExpressionTreeComparer(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ExpressionTreeComparer),this.applyAcceptableError=!1,this.roundingType=null,this.roundingAmount=0,this.acceptableErrorType=null,this.acceptableMarginValue=0,this.autoRoundUsersAnswer=!1,this.componentDirectWeightedChildrenDict={},this.componentExpandedWeightedChildrenDict={}}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(ExpressionTreeComparer,[{key:"compare",value:function compare(t,r){var o,p,l,u,c=this;if(t==r)return 0;if(null==t)return 1;if(null==r)return-1;if(t.type!=r.type)return 1-2*Number(t.type<r.type);if(t.subtype!=r.subtype)return 1-2*Number(t.subtype<r.subtype);if(t.implementsInterface("IExpressionToken"))l=t.originalString,u=r.originalString;else switch(t.type){case i.ExpressionTreeTypes.TYPE_GROUP_COMPONENT:case i.ExpressionTreeTypes.TYPE_OR_COMPONENT:case i.ExpressionTreeTypes.TYPE_EQUALS_COMPONENT:case i.ExpressionTreeTypes.TYPE_ARROW_COMPONENT:case i.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT:case i.ExpressionTreeTypes.TYPE_SUBSCRIPT_SUPERSCRIPT_COMPONENT:o=t.getAllChildren(),p=r.getAllChildren();break;case i.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT:return a.MultiOperatorComponent.sortCompare(t,r,(function(t,r){return c.compare(t,r)}),!0);case i.ExpressionTreeTypes.TYPE_MATH_ENTITY_COMPONENT:l=t.entityName,u=r.entityName;break;case i.ExpressionTreeTypes.TYPE_MATH_FUNCTION_COMPONENT:if((l=t.getFunctionName())!=(u=r.getFunctionName()))return 1-2*Number(l<u);l=null,u=null,o=[t.child],p=[r.child];break;case i.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT:return this.compareNumbers(t.value,r.value);case i.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT:o=[t.child],p=[r.child]}if(null!=o){for(var h=Math.min(o.length,p.length),m=0;m<h;m++){var T=this.compare(o[m],p[m]);if(0!=T)return T}if(o.length!=p.length)return 1-2*Number(o.length<p.length)}return l&&l!=u?1-2*Number(l<u):0}},{key:"equal",value:function equal(t,r){var o,p,l=this;if(t==r)return!0;if(null==t||null==r)return!1;if(t.type!=r.type||t.subtype!=r.subtype)return!1;if(t.implementsInterface("IExpressionToken"))return t.originalString==r.originalString;switch(t.type){case i.ExpressionTreeTypes.TYPE_GROUP_COMPONENT:case i.ExpressionTreeTypes.TYPE_OR_COMPONENT:case i.ExpressionTreeTypes.TYPE_EQUALS_COMPONENT:case i.ExpressionTreeTypes.TYPE_ARROW_COMPONENT:case i.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT:case i.ExpressionTreeTypes.TYPE_SUBSCRIPT_SUPERSCRIPT_COMPONENT:o=t.getAllChildren(),p=r.getAllChildren();break;case i.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT:return 0==this.compareNumbers(t.value,r.value);case i.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT:return 0==a.MultiOperatorComponent.sortCompare(t,r,(function(t,r){return l.compare(t,r)}),!0);case i.ExpressionTreeTypes.TYPE_MATH_ENTITY_COMPONENT:return t.entityName==r.entityName;case i.ExpressionTreeTypes.TYPE_MATH_FUNCTION_COMPONENT:return t.getFunctionName()==r.getFunctionName()&&this.equal(t.child,r.child);case i.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT:return this.equal(t.child,r.child)}if(null!=o){if(o.length!=p.length)return!1;for(var u=o.length,c=0;c<u;c++)if(!this.equal(o[c],p[c]))return!1}return!0}},{key:"compareNumbers",value:function compareNumbers(t,r){if(this.applyAcceptableError&&(this.acceptableErrorType||this.acceptableMarginValue)){var o=this.acceptableErrorType||ExpressionTreeComparer.defaultAcceptableErrorType;if(p.MarginErrorHelper.withinMarginOfError(o,r,t,this.acceptableMarginValue,this.roundingAmount,this.roundingType,this.autoRoundUsersAnswer))return 0}else if(t==r)return 0;return 1-2*Number(t<r)}},{key:"numbersAreEqual",value:function numbersAreEqual(t,r){return 0==this.compareNumbers(t,r)}},{key:"generateSimilarityScore",value:function generateSimilarityScore(t,r,o){if(this.equal(t,r))return 1;if(!o)return 0;if(null==t||null==r)return 0;var i;if(null!=this.componentExpandedWeightedChildrenDict[t.id])i=this.componentExpandedWeightedChildrenDict[t.id];else{var a={component:t,value:1};t.implementsInterface("IParentComponent")?(i=t.getRelativeImportanceOfChildren(!0,1)).unshift(a):i=[a],this.componentExpandedWeightedChildrenDict[t.id]=i}return this.generateSimilarityScoreForSubcomponent(r,.8,i)}},{key:"generateSimilarityScoreForSubcomponent",value:function generateSimilarityScoreForSubcomponent(t,r,o){var i,a=_createForOfIteratorHelper(o);try{for(a.s();!(i=a.n()).done;){var p=i.value;if(this.equal(t,p.component)){var l=(r+p.value)/2;return Math.min(l,r)}}}catch(t){a.e(t)}finally{a.f()}var u=0;if(null!=t&&t.implementsInterface("IParentComponent")){var c;null!=this.componentDirectWeightedChildrenDict[t.id]?c=this.componentDirectWeightedChildrenDict[t.id]:(c=t.getRelativeImportanceOfChildren(!1,r),this.componentDirectWeightedChildrenDict[t.id]=c);var h,m=_createForOfIteratorHelper(c);try{for(m.s();!(h=m.n()).done;){var T=h.value;u+=this.generateSimilarityScoreForSubcomponent(T.component,T.value,o)}}catch(t){m.e(t)}finally{m.f()}}return u}},{key:"flushComparisonDictionaries",value:function flushComparisonDictionaries(){this.componentDirectWeightedChildrenDict={},this.componentExpandedWeightedChildrenDict={}}}]),ExpressionTreeComparer}();r.ExpressionTreeComparer=l,l.defaultAcceptableErrorType=p.MarginErrorHelper.ABSOLUTE},9726:(t,r,o)=>{function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.ExpressionTreeRoundingValidator=void 0;var i=o(340),a=o(3721),p=o(7076),l=function(){function ExpressionTreeRoundingValidator(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ExpressionTreeRoundingValidator)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(ExpressionTreeRoundingValidator,null,[{key:"validateRounding",value:function validateRounding(t,r,o){if(null==r||r==p.AnswerRoundingHelper.NONE)return!0;var l=[];l.push(t);for(var u=0;u<l.length;u++){var c=l[u];switch(c.type){case i.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT:var h=c;if(""==h.originalString)break;if(!r.check(h.originalString,o))return!1;break;case i.ExpressionTreeTypes.TYPE_EQUALS_COMPONENT:case i.ExpressionTreeTypes.TYPE_GROUP_COMPONENT:case i.ExpressionTreeTypes.TYPE_MATH_FUNCTION_COMPONENT:case i.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT:case i.ExpressionTreeTypes.TYPE_OR_COMPONENT:case i.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT:if(c.implementsInterface("IParentComponent")){var m,T=_createForOfIteratorHelper(c.getAllChildren());try{for(T.s();!(m=T.n()).done;){var E=m.value;l.push(E)}}catch(t){T.e(t)}finally{T.f()}}break;case i.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT:var y=c.base;if(y instanceof a.NumberComponent&&10==y.value)break;l.push(y)}}return!0}}]),ExpressionTreeRoundingValidator}();r.ExpressionTreeRoundingValidator=l},8125:(t,r)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.VectorComparer=void 0;var o=function(){function VectorComparer(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,VectorComparer)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(VectorComparer,null,[{key:"FindBestOffsetSetForPairOfVectors",value:function FindBestOffsetSetForPairOfVectors(t,r,o){for(var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-2,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-2,u=t.length+1,c=r.length+1,h=new Array(c),m=0;m<c;m++)h[m]=new Array(u),h[m][0]=0;for(var T=0;T<u;T++)h[0][T]=0;for(var E=1;E<c;E++)for(var y=1;y<u;y++){var d=o(r[E-1],t[y-1]);i=0!=d?h[E-1][y-1]+d*a:h[E-1][y-1]+p;var C=h[E][y-1]+l,_=h[E-1][y]+l,O=Math.max(i,C,_);h[E][y]=O}for(var g=[],v=c-1,P=u-1;v>0&&P>0;){var S=o(r[v-1],t[P-1]);i=0!=S?S*a:p,v>0&&P>0&&h[v][P]==h[v-1][P-1]+i?(g.push({staticItem:t[P-1],comparisonItem:r[v-1],weightingScore:S}),v-=1,P-=1):P>0&&h[v][P]==h[v][P-1]+l?(g.push({staticItem:t[P-1],comparisonItem:null,weightingScore:0}),P-=1):(g.push({staticItem:null,comparisonItem:r[v-1],weightingScore:0}),v-=1)}if(v>0)for(;v>0;)g.push({staticItem:null,comparisonItem:r[v-1],weightingScore:0}),v--;else if(P>0)for(;P>0;)g.push({staticItem:t[P-1],comparisonItem:null,weightingScore:0}),P--;return g.reverse(),g}}]),VectorComparer}();r.VectorComparer=o},9336:(t,r)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.AsciiMathToLatexConverter=void 0;var o,i=function(){function AsciiMathToLatexConverter(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,AsciiMathToLatexConverter),this.config={translateOnLoad:!0,mathcolor:"",displaystyle:!0,showasciiformulaonhover:!0,decimalsign:".",AMdelimiter1:"`",AMescape1:"\\\\`",AMusedelimiter2:!1,AMdelimiter2:"$",AMescape2:"\\\\\\$",AMdelimiter2regexp:"\\$",AMdocumentId:"wikitext",doubleblankmathdelimiter:!1},this.boldTextModifier={active:!1,nestingDepth:-1},this.AMsqrt={input:"sqrt",tag:"msqrt",output:"sqrt",tex:null,ttype:o.UNARY},this.AMroot={input:"root",tag:"mroot",output:"root",tex:null,ttype:o.BINARY},this.AMfrac={input:"frac",tag:"mfrac",output:"/",tex:null,ttype:o.BINARY},this.AMdiv={input:"/",tag:"mfrac",output:"/",tex:null,ttype:o.INFIX},this.AMover={input:"stackrel",tag:"mover",output:"stackrel",tex:null,ttype:o.BINARY},this.AMsub={input:"_",tag:"msub",output:"_",tex:null,ttype:o.INFIX},this.AMsup={input:"^",tag:"msup",output:"^",tex:null,ttype:o.INFIX},this.AMtext={input:"text",tag:"mtext",output:"text",tex:null,ttype:o.TEXT},this.AMmbox={input:"mbox",tag:"mtext",output:"mbox",tex:null,ttype:o.TEXT},this.AMquote={input:'"',tag:"mtext",output:"mbox",tex:null,ttype:o.TEXT},this.AMnames=[],this.AMsymbols=[{input:"alpha",tag:"mi",output:"α",tex:"alpha",ttype:o.CONST},{input:"α",tag:"mi",output:"α",tex:"alpha",ttype:o.CONST},{input:"beta",tag:"mi",output:"β",tex:"beta",ttype:o.CONST},{input:"β",tag:"mi",output:"β",tex:"beta",ttype:o.CONST},{input:"chi",tag:"mi",output:"χ",tex:null,ttype:o.CONST},{input:"delta",tag:"mi",output:"δ",tex:"delta",ttype:o.CONST},{input:"δ",tag:"mi",output:"δ",tex:"delta",ttype:o.CONST},{input:"Delta",tag:"mo",output:"Δ",tex:"Delta",ttype:o.CONST},{input:"Δ",tag:"mo",output:"Δ",tex:"Delta",ttype:o.CONST},{input:"∆",tag:"mo",output:"∆",tex:"Delta",ttype:o.CONST},{input:"△",tag:"mo",output:"△",tex:"Delta",ttype:o.CONST},{input:"epsi",tag:"mi",output:"ε",tex:"epsilon",ttype:o.CONST},{input:"ε",tag:"mi",output:"ε",tex:"epsilon",ttype:o.CONST},{input:"varepsilon",tag:"mi",output:"ɛ",tex:"varepsilon",ttype:o.CONST},{input:"ɛ",tag:"mi",output:"ɛ",tex:"varepsilon",ttype:o.CONST},{input:"eta",tag:"mi",output:"η",tex:null,ttype:o.CONST},{input:"gamma",tag:"mi",output:"γ",tex:"gamma",ttype:o.CONST},{input:"γ",tag:"mi",output:"γ",tex:"gamma",ttype:o.CONST},{input:"Gamma",tag:"mo",output:"Γ",tex:"Gamma",ttype:o.CONST},{input:"Γ",tag:"mo",output:"Γ",tex:"Gamma",ttype:o.CONST},{input:"iota",tag:"mi",output:"ι",tex:null,ttype:o.CONST},{input:"kappa",tag:"mi",output:"κ",tex:"kappa",ttype:o.CONST},{input:"κ",tag:"mi",output:"κ",tex:"kappa",ttype:o.CONST},{input:"lambda",tag:"mi",output:"λ",tex:"lambda",ttype:o.CONST},{input:"λ",tag:"mi",output:"λ",tex:"lambda",ttype:o.CONST},{input:"Lambda",tag:"mo",output:"Λ",tex:"Lambda",ttype:o.CONST},{input:"Λ",tag:"mo",output:"Λ",tex:"Lambda",ttype:o.CONST},{input:"lamda",tag:"mi",output:"lambda",tex:null,ttype:o.DEFINITION},{input:"Lamda",tag:"mi",output:"Lambda",tex:null,ttype:o.DEFINITION},{input:"mu",tag:"mi",output:"μ",tex:"mu",ttype:o.CONST},{input:"μ",tag:"mi",output:"μ",tex:"mu",ttype:o.CONST},{input:"nu",tag:"mi",output:"ν",tex:null,ttype:o.CONST},{input:"omega",tag:"mi",output:"ω",tex:"omega",ttype:o.CONST},{input:"ω",tag:"mi",output:"ω",tex:"omega",ttype:o.CONST},{input:"Omega",tag:"mo",output:"Ω",tex:"Omega",ttype:o.CONST},{input:"Ω",tag:"mo",output:"Ω",tex:"Omega",ttype:o.CONST},{input:"phi",tag:"mi",output:"φ",tex:null,ttype:o.CONST},{input:"varphi",tag:"mi",output:"ϕ",tex:null,ttype:o.CONST},{input:"Phi",tag:"mo",output:"Φ",tex:null,ttype:o.CONST},{input:"pi",tag:"mi",output:"π",tex:"pi",ttype:o.CONST},{input:"π",tag:"mi",output:"π",tex:"pi",ttype:o.CONST},{input:"Pi",tag:"mo",output:"Π",tex:"Pi",ttype:o.CONST},{input:"Π",tag:"mo",output:"Π",tex:"Pi",ttype:o.CONST},{input:"psi",tag:"mi",output:"ψ",tex:null,ttype:o.CONST},{input:"Psi",tag:"mi",output:"Ψ",tex:null,ttype:o.CONST},{input:"rho",tag:"mi",output:"ρ",tex:null,ttype:o.CONST},{input:"sigma",tag:"mi",output:"σ",tex:"sigma",ttype:o.CONST},{input:"σ",tag:"mi",output:"σ",tex:"sigma",ttype:o.CONST},{input:"Sigma",tag:"mo",output:"Σ",tex:"Sigma",ttype:o.CONST},{input:"Σ",tag:"mo",output:"Σ",tex:"Sigma",ttype:o.CONST},{input:"tau",tag:"mi",output:"τ",tex:"tau",ttype:o.CONST},{input:"τ",tag:"mi",output:"τ",tex:"tau",ttype:o.CONST},{input:"theta",tag:"mi",output:"θ",tex:"theta",ttype:o.CONST},{input:"θ",tag:"mi",output:"θ",tex:"theta",ttype:o.CONST},{input:"vartheta",tag:"mi",output:"ϑ",tex:null,ttype:o.CONST},{input:"Theta",tag:"mo",output:"Θ",tex:"Theta",ttype:o.CONST},{input:"Θ",tag:"mo",output:"Θ",tex:"Theta",ttype:o.CONST},{input:"upsilon",tag:"mi",output:"υ",tex:null,ttype:o.CONST},{input:"xi",tag:"mi",output:"ξ",tex:null,ttype:o.CONST},{input:"Xi",tag:"mo",output:"Ξ",tex:null,ttype:o.CONST},{input:"zeta",tag:"mi",output:"ζ",tex:null,ttype:o.CONST},{input:"°",tag:"mo",output:"°",tex:"^{\\circ}",ttype:o.CONST,val:!0},{input:"∘",tag:"mo",output:"∘",tex:"\\circ",ttype:o.CONST,val:!0},{input:"*",tag:"mo",output:"⋅",tex:"cdot",ttype:o.CONST},{input:"**",tag:"mo",output:"∗",tex:"ast",ttype:o.CONST},{input:"***",tag:"mo",output:"⋆",tex:"star",ttype:o.CONST},{input:"//",tag:"mo",output:"/",tex:"/",ttype:o.CONST,val:!0,notexcopy:!0},{input:"\\\\",tag:"mo",output:"\\",tex:"backslash",ttype:o.CONST},{input:"setminus",tag:"mo",output:"\\",tex:null,ttype:o.CONST},{input:"xx",tag:"mo",output:"×",tex:"times",ttype:o.CONST},{input:"-:",tag:"mo",output:"÷",tex:"div",ttype:o.CONST},{input:"divide",tag:"mo",output:"-:",tex:null,ttype:o.DEFINITION},{input:"@",tag:"mo",output:"∘",tex:"circ",ttype:o.CONST},{input:"o+",tag:"mo",output:"⊕",tex:"oplus",ttype:o.CONST},{input:"ox",tag:"mo",output:"⊗",tex:"otimes",ttype:o.CONST},{input:"o.",tag:"mo",output:"⊙",tex:"odot",ttype:o.CONST},{input:"sum",tag:"mo",output:"∑",tex:null,ttype:o.UNDEROVER},{input:"prod",tag:"mo",output:"∏",tex:null,ttype:o.UNDEROVER},{input:"^^",tag:"mo",output:"∧",tex:"wedge",ttype:o.CONST},{input:"^^^",tag:"mo",output:"⋀",tex:"bigwedge",ttype:o.UNDEROVER},{input:"vv",tag:"mo",output:"∨",tex:"vee",ttype:o.CONST},{input:"vvv",tag:"mo",output:"⋁",tex:"bigvee",ttype:o.UNDEROVER},{input:"nn",tag:"mo",output:"∩",tex:"cap",ttype:o.CONST},{input:"nnn",tag:"mo",output:"⋂",tex:"bigcap",ttype:o.UNDEROVER},{input:"uu",tag:"mo",output:"∪",tex:"cup",ttype:o.CONST},{input:"uuu",tag:"mo",output:"⋃",tex:"bigcup",ttype:o.UNDEROVER},{input:"overset",tag:"mover",output:"stackrel",tex:null,ttype:o.BINARY},{input:"underset",tag:"munder",output:"stackrel",tex:null,ttype:o.BINARY},{input:"!=",tag:"mo",output:"≠",tex:"ne",ttype:o.CONST},{input:":=",tag:"mo",output:":=",tex:null,ttype:o.CONST},{input:"lt",tag:"mo",output:"<",tex:null,ttype:o.CONST},{input:"gt",tag:"mo",output:">",tex:null,ttype:o.CONST},{input:"<=",tag:"mo",output:"≤",tex:"le",ttype:o.CONST},{input:"lt=",tag:"mo",output:"≤",tex:"leq",ttype:o.CONST},{input:"gt=",tag:"mo",output:"≥",tex:"geq",ttype:o.CONST},{input:">=",tag:"mo",output:"≥",tex:"ge",ttype:o.CONST},{input:"-<",tag:"mo",output:"≺",tex:"prec",ttype:o.CONST},{input:"-lt",tag:"mo",output:"≺",tex:null,ttype:o.CONST},{input:">-",tag:"mo",output:"≻",tex:"succ",ttype:o.CONST},{input:"-<=",tag:"mo",output:"⪯",tex:"preceq",ttype:o.CONST},{input:">-=",tag:"mo",output:"⪰",tex:"succeq",ttype:o.CONST},{input:"in",tag:"mo",output:"∈",tex:null,ttype:o.CONST},{input:"!in",tag:"mo",output:"∉",tex:"notin",ttype:o.CONST},{input:"sub",tag:"mo",output:"⊂",tex:"subset",ttype:o.CONST},{input:"sup",tag:"mo",output:"⊃",tex:"supset",ttype:o.CONST},{input:"sube",tag:"mo",output:"⊆",tex:"subseteq",ttype:o.CONST},{input:"supe",tag:"mo",output:"⊇",tex:"supseteq",ttype:o.CONST},{input:"-=",tag:"mo",output:"≡",tex:"equiv",ttype:o.CONST},{input:"~=",tag:"mo",output:"≅",tex:"stackrel{\\sim}{=}",ttype:o.CONST},{input:"cong",tag:"mo",output:"~=",tex:null,ttype:o.DEFINITION},{input:"~~",tag:"mo",output:"≈",tex:"approx",ttype:o.CONST},{input:"prop",tag:"mo",output:"∝",tex:"propto",ttype:o.CONST},{input:"and",tag:"mtext",output:"and",tex:null,ttype:o.SPACE},{input:"or",tag:"mtext",output:"or",tex:null,ttype:o.SPACE},{input:"not",tag:"mo",output:"¬",tex:"neg",ttype:o.CONST},{input:"=>",tag:"mo",output:"⇒",tex:"Rightarrow",ttype:o.CONST},{input:"implies",tag:"mo",output:"=>",tex:null,ttype:o.DEFINITION},{input:"if",tag:"mo",output:"if",tex:null,ttype:o.SPACE},{input:"<=>",tag:"mo",output:"⇔",tex:"Leftrightarrow",ttype:o.CONST},{input:"iff",tag:"mo",output:"<=>",tex:null,ttype:o.DEFINITION},{input:"AA",tag:"mo",output:"∀",tex:"forall",ttype:o.CONST},{input:"EE",tag:"mo",output:"∃",tex:"exists",ttype:o.CONST},{input:"_|_",tag:"mo",output:"⊥",tex:"bot",ttype:o.CONST},{input:"TT",tag:"mo",output:"⊤",tex:"top",ttype:o.CONST},{input:"|--",tag:"mo",output:"⊢",tex:"vdash",ttype:o.CONST},{input:"|==",tag:"mo",output:"⊨",tex:"models",ttype:o.CONST},{input:"(",tag:"mo",output:"(",tex:null,ttype:o.LEFTBRACKET},{input:")",tag:"mo",output:")",tex:null,ttype:o.RIGHTBRACKET},{input:"[",tag:"mo",output:"[",tex:null,ttype:o.LEFTBRACKET},{input:"]",tag:"mo",output:"]",tex:null,ttype:o.RIGHTBRACKET},{input:"{",tag:"mo",output:"{",tex:"lbrace",ttype:o.LEFTBRACKET},{input:"}",tag:"mo",output:"}",tex:"rbrace",ttype:o.RIGHTBRACKET},{input:"|",tag:"mo",output:"|",tex:null,ttype:o.LEFTRIGHT},{input:"(:",tag:"mo",output:"〈",tex:"langle",ttype:o.LEFTBRACKET},{input:":)",tag:"mo",output:"〉",tex:"rangle",ttype:o.RIGHTBRACKET},{input:"<<",tag:"mo",output:"〈",tex:"langle",ttype:o.LEFTBRACKET},{input:">>",tag:"mo",output:"〉",tex:"rangle",ttype:o.RIGHTBRACKET},{input:"{:",tag:"mo",output:"{:",tex:null,ttype:o.LEFTBRACKET,invisible:!0},{input:":}",tag:"mo",output:":}",tex:null,ttype:o.RIGHTBRACKET,invisible:!0},{input:"$",tag:"mo",output:"$",tex:null,ttype:o.CONST},{input:"#",tag:"mo",output:"#",tex:"#",ttype:o.CONST},{input:"int",tag:"mo",output:"∫",tex:null,ttype:o.CONST},{input:"dx",tag:"mi",output:"{:d x:}",tex:null,ttype:o.DEFINITION},{input:"dy",tag:"mi",output:"{:d y:}",tex:null,ttype:o.DEFINITION},{input:"dz",tag:"mi",output:"{:d z:}",tex:null,ttype:o.DEFINITION},{input:"dt",tag:"mi",output:"{:d t:}",tex:null,ttype:o.DEFINITION},{input:"oint",tag:"mo",output:"∮",tex:null,ttype:o.CONST},{input:"del",tag:"mo",output:"∂",tex:"partial",ttype:o.CONST},{input:"grad",tag:"mo",output:"∇",tex:"nabla",ttype:o.CONST},{input:"+-",tag:"mo",output:"±",tex:"pm",ttype:o.CONST},{input:"O/",tag:"mo",output:"∅",tex:"emptyset",ttype:o.CONST},{input:"oo",tag:"mo",output:"∞",tex:"infty",ttype:o.CONST},{input:"aleph",tag:"mo",output:"ℵ",tex:null,ttype:o.CONST},{input:"...",tag:"mo",output:"...",tex:"ldots",ttype:o.CONST},{input:":.",tag:"mo",output:"∴",tex:"therefore",ttype:o.CONST},{input:"/_",tag:"mo",output:"∠",tex:"angle",ttype:o.CONST},{input:"/_\\",tag:"mo",output:"△",tex:"triangle",ttype:o.CONST},{input:"\\ ",tag:"mo",output:" ",tex:null,ttype:o.CONST,val:!0},{input:"%",tag:"mo",output:"%",tex:"%",ttype:o.CONST,notexcopy:!0},{input:"quad",tag:"mo",output:"  ",tex:null,ttype:o.CONST},{input:"qquad",tag:"mo",output:"    ",tex:null,ttype:o.CONST},{input:"cdots",tag:"mo",output:"⋯",tex:null,ttype:o.CONST},{input:"vdots",tag:"mo",output:"⋮",tex:null,ttype:o.CONST},{input:"ddots",tag:"mo",output:"⋱",tex:null,ttype:o.CONST},{input:"diamond",tag:"mo",output:"⋄",tex:null,ttype:o.CONST},{input:"square",tag:"mo",output:"□",tex:"boxempty",ttype:o.CONST},{input:"|__",tag:"mo",output:"⌊",tex:"lfloor",ttype:o.CONST},{input:"__|",tag:"mo",output:"⌋",tex:"rfloor",ttype:o.CONST},{input:"|~",tag:"mo",output:"⌈",tex:"lceil",ttype:o.CONST},{input:"lceiling",tag:"mo",output:"|~",tex:null,ttype:o.DEFINITION},{input:"~|",tag:"mo",output:"⌉",tex:"rceil",ttype:o.CONST},{input:"rceiling",tag:"mo",output:"~|",tex:null,ttype:o.DEFINITION},{input:"CC",tag:"mo",output:"ℂ",tex:"mathbb{C}",ttype:o.CONST,notexcopy:!0},{input:"NN",tag:"mo",output:"ℕ",tex:"mathbb{N}",ttype:o.CONST,notexcopy:!0},{input:"QQ",tag:"mo",output:"ℚ",tex:"mathbb{Q}",ttype:o.CONST,notexcopy:!0},{input:"RR",tag:"mo",output:"ℝ",tex:"mathbb{R}",ttype:o.CONST,notexcopy:!0},{input:"ZZ",tag:"mo",output:"ℤ",tex:"mathbb{Z}",ttype:o.CONST,notexcopy:!0},{input:"f",tag:"mi",output:"f",tex:null,ttype:o.UNARY,func:!0,val:!0},{input:"g",tag:"mi",output:"g",tex:null,ttype:o.UNARY,func:!0,val:!0},{input:"''",tag:"mo",output:"''",tex:null,val:!0},{input:"'''",tag:"mo",output:"'''",tex:null,val:!0},{input:"''''",tag:"mo",output:"''''",tex:null,val:!0},{input:"lim",tag:"mo",output:"lim",tex:null,ttype:o.UNDEROVER},{input:"Lim",tag:"mo",output:"Lim",tex:null,ttype:o.UNDEROVER},{input:"sin",tag:"mo",output:"sin",tex:null,ttype:o.UNARY,func:!0},{input:"cos",tag:"mo",output:"cos",tex:null,ttype:o.UNARY,func:!0},{input:"tan",tag:"mo",output:"tan",tex:null,ttype:o.UNARY,func:!0},{input:"arcsin",tag:"mo",output:"arcsin",tex:null,ttype:o.UNARY,func:!0},{input:"arccos",tag:"mo",output:"arccos",tex:null,ttype:o.UNARY,func:!0},{input:"arctan",tag:"mo",output:"arctan",tex:null,ttype:o.UNARY,func:!0},{input:"sinh",tag:"mo",output:"sinh",tex:null,ttype:o.UNARY,func:!0},{input:"cosh",tag:"mo",output:"cosh",tex:null,ttype:o.UNARY,func:!0},{input:"tanh",tag:"mo",output:"tanh",tex:null,ttype:o.UNARY,func:!0},{input:"cot",tag:"mo",output:"cot",tex:null,ttype:o.UNARY,func:!0},{input:"coth",tag:"mo",output:"coth",tex:null,ttype:o.UNARY,func:!0},{input:"sech",tag:"mo",output:"sech",tex:null,ttype:o.UNARY,func:!0},{input:"csch",tag:"mo",output:"csch",tex:null,ttype:o.UNARY,func:!0},{input:"sec",tag:"mo",output:"sec",tex:null,ttype:o.UNARY,func:!0},{input:"csc",tag:"mo",output:"csc",tex:null,ttype:o.UNARY,func:!0},{input:"log",tag:"mo",output:"log",tex:null,ttype:o.UNARY,func:!0},{input:"ln",tag:"mo",output:"ln",tex:null,ttype:o.UNARY,func:!0},{input:"abs",tag:"mo",output:"abs",tex:null,ttype:o.UNARY,notexcopy:!0,rewriteleftright:["|","|"]},{input:"norm",tag:"mo",output:"norm",tex:null,ttype:o.UNARY,notexcopy:!0,rewriteleftright:["\\|","\\|"]},{input:"floor",tag:"mo",output:"floor",tex:null,ttype:o.UNARY,notexcopy:!0,rewriteleftright:["\\lfloor","\\rfloor"]},{input:"ceil",tag:"mo",output:"ceil",tex:null,ttype:o.UNARY,notexcopy:!0,rewriteleftright:["\\lceil","\\rceil"]},{input:"Sin",tag:"mo",output:"sin",tex:null,ttype:o.UNARY,func:!0},{input:"Cos",tag:"mo",output:"cos",tex:null,ttype:o.UNARY,func:!0},{input:"Tan",tag:"mo",output:"tan",tex:null,ttype:o.UNARY,func:!0},{input:"Arcsin",tag:"mo",output:"arcsin",tex:null,ttype:o.UNARY,func:!0},{input:"Arccos",tag:"mo",output:"arccos",tex:null,ttype:o.UNARY,func:!0},{input:"Arctan",tag:"mo",output:"arctan",tex:null,ttype:o.UNARY,func:!0},{input:"Sinh",tag:"mo",output:"sinh",tex:null,ttype:o.UNARY,func:!0},{input:"Sosh",tag:"mo",output:"cosh",tex:null,ttype:o.UNARY,func:!0},{input:"Tanh",tag:"mo",output:"tanh",tex:null,ttype:o.UNARY,func:!0},{input:"Cot",tag:"mo",output:"cot",tex:null,ttype:o.UNARY,func:!0},{input:"Sec",tag:"mo",output:"sec",tex:null,ttype:o.UNARY,func:!0},{input:"Csc",tag:"mo",output:"csc",tex:null,ttype:o.UNARY,func:!0},{input:"Log",tag:"mo",output:"log",tex:null,ttype:o.UNARY,func:!0},{input:"Ln",tag:"mo",output:"ln",tex:null,ttype:o.UNARY,func:!0},{input:"Abs",tag:"mo",output:"abs",tex:null,ttype:o.UNARY,notexcopy:!0,rewriteleftright:["|","|"]},{input:"det",tag:"mo",output:"det",tex:null,ttype:o.UNARY,func:!0},{input:"exp",tag:"mo",output:"exp",tex:null,ttype:o.UNARY,func:!0},{input:"dim",tag:"mo",output:"dim",tex:null,ttype:o.CONST},{input:"mod",tag:"mo",output:"mod",tex:"text{mod}",ttype:o.CONST,notexcopy:!0},{input:"gcd",tag:"mo",output:"gcd",tex:null,ttype:o.UNARY,func:!0},{input:"lcm",tag:"mo",output:"lcm",tex:"text{lcm}",ttype:o.UNARY,func:!0,notexcopy:!0},{input:"lub",tag:"mo",output:"lub",tex:null,ttype:o.CONST},{input:"glb",tag:"mo",output:"glb",tex:null,ttype:o.CONST},{input:"min",tag:"mo",output:"min",tex:null,ttype:o.UNDEROVER},{input:"max",tag:"mo",output:"max",tex:null,ttype:o.UNDEROVER},{input:"uarr",tag:"mo",output:"↑",tex:"uparrow",ttype:o.CONST},{input:"darr",tag:"mo",output:"↓",tex:"downarrow",ttype:o.CONST},{input:"rarr",tag:"mo",output:"→",tex:"rightarrow",ttype:o.CONST},{input:"->",tag:"mo",output:"→",tex:"to",ttype:o.CONST},{input:">->",tag:"mo",output:"↣",tex:"rightarrowtail",ttype:o.CONST},{input:"->>",tag:"mo",output:"↠",tex:"twoheadrightarrow",ttype:o.CONST},{input:">->>",tag:"mo",output:"⤖",tex:"twoheadrightarrowtail",ttype:o.CONST},{input:"|->",tag:"mo",output:"↦",tex:"mapsto",ttype:o.CONST},{input:"larr",tag:"mo",output:"←",tex:"leftarrow",ttype:o.CONST},{input:"harr",tag:"mo",output:"↔",tex:"leftrightarrow",ttype:o.CONST},{input:"rArr",tag:"mo",output:"⇒",tex:"Rightarrow",ttype:o.CONST},{input:"lArr",tag:"mo",output:"⇐",tex:"Leftarrow",ttype:o.CONST},{input:"hArr",tag:"mo",output:"⇔",tex:"Leftrightarrow",ttype:o.CONST},this.AMsqrt,this.AMroot,this.AMfrac,this.AMdiv,this.AMover,this.AMsub,this.AMsup,{input:"cancel",tag:"menclose",output:"cancel",tex:null,ttype:o.UNARY},{input:"Sqrt",tag:"msqrt",output:"sqrt",tex:null,ttype:o.UNARY},{input:"hat",tag:"mover",output:"^",tex:null,ttype:o.UNARY,acc:!0},{input:"bar",tag:"mover",output:"¯",tex:"overline",ttype:o.UNARY,acc:!0},{input:"vec",tag:"mover",output:"→",tex:null,ttype:o.UNARY,acc:!0},{input:"tilde",tag:"mover",output:"~",tex:null,ttype:o.UNARY,acc:!0},{input:"dot",tag:"mover",output:".",tex:null,ttype:o.UNARY,acc:!0},{input:"ddot",tag:"mover",output:"..",tex:null,ttype:o.UNARY,acc:!0},{input:"ul",tag:"munder",output:"̲",tex:"underline",ttype:o.UNARY,acc:!0},{input:"ubrace",tag:"munder",output:"⏟",tex:"underbrace",ttype:o.UNARY,acc:!0},{input:"obrace",tag:"mover",output:"⏞",tex:"overbrace",ttype:o.UNARY,acc:!0},this.AMtext,this.AMmbox,this.AMquote,{input:"color",tag:"mstyle",ttype:o.BINARY},{input:"bb",tag:"mstyle",atname:"mathvariant",atval:"bold",output:"bb",tex:"mathbf",ttype:o.UNARY,notexcopy:!0},{input:"mathbf",tag:"mstyle",atname:"mathvariant",atval:"bold",output:"mathbf",tex:null,ttype:o.UNARY},{input:"sf",tag:"mstyle",atname:"mathvariant",atval:"sans-serif",output:"sf",tex:"mathsf",ttype:o.UNARY,notexcopy:!0},{input:"mathsf",tag:"mstyle",atname:"mathvariant",atval:"sans-serif",output:"mathsf",tex:null,ttype:o.UNARY},{input:"bbb",tag:"mstyle",atname:"mathvariant",atval:"double-struck",output:"bbb",tex:"mathbb",ttype:o.UNARY,notexcopy:!0},{input:"mathbb",tag:"mstyle",atname:"mathvariant",atval:"double-struck",output:"mathbb",tex:null,ttype:o.UNARY},{input:"cc",tag:"mstyle",atname:"mathvariant",atval:"script",output:"cc",tex:"mathcal",ttype:o.UNARY,notexcopy:!0},{input:"mathcal",tag:"mstyle",atname:"mathvariant",atval:"script",output:"mathcal",tex:null,ttype:o.UNARY},{input:"tt",tag:"mstyle",atname:"mathvariant",atval:"monospace",output:"tt",tex:"mathtt",ttype:o.UNARY,notexcopy:!0},{input:"mathtt",tag:"mstyle",atname:"mathvariant",atval:"monospace",output:"mathtt",tex:null,ttype:o.UNARY},{input:"fr",tag:"mstyle",atname:"mathvariant",atval:"fraktur",output:"fr",tex:"mathfrak",ttype:o.UNARY,notexcopy:!0},{input:"mathfrak",tag:"mstyle",atname:"mathvariant",atval:"fraktur",output:"mathfrak",tex:null,ttype:o.UNARY}],this.AMinitSymbols()}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(AsciiMathToLatexConverter,[{key:"compareNames",value:function compareNames(t,r){return t.input>r.input?1:-1}},{key:"AMinitSymbols",value:function AMinitSymbols(){var t,r=[];for(t=0;t<this.AMsymbols.length;t++)!this.AMsymbols[t].tex||"boolean"==typeof this.AMsymbols[t].notexcopy&&this.AMsymbols[t].notexcopy||(r[r.length]={input:this.AMsymbols[t].tex,tag:this.AMsymbols[t].tag,output:this.AMsymbols[t].output,ttype:this.AMsymbols[t].ttype,acc:this.AMsymbols[t].acc||!1});for(this.AMsymbols=this.AMsymbols.concat(r),this.AMsymbols.sort(this.compareNames),t=0;t<this.AMsymbols.length;t++)this.AMnames[t]=this.AMsymbols[t].input}},{key:"newcommand",value:function newcommand(t,r){this.AMsymbols=this.AMsymbols.concat([{input:t,tag:"mo",output:r,tex:null,ttype:o.DEFINITION}])}},{key:"AMremoveCharsAndBlanks",value:function AMremoveCharsAndBlanks(t,r){var o,i;for(o="\\"==t.charAt(r)&&"\\"!=t.charAt(r+1)&&" "!=t.charAt(r+1)?t.slice(r+1):t.slice(r),i=0;i<o.length&&o.charCodeAt(i)<=32;i+=1);return o.slice(i)}},{key:"AMposition",value:function AMposition(t,r,o){if(0==o){var i,a;for(o=-1,i=t.length;o+1<i;)t[a=o+i>>1]<r?o=a:i=a;return i}var p;for(p=o;p<t.length&&t[p]<r;p++);return p}},{key:"AMgetSymbol",value:function AMgetSymbol(t){for(var r,i,a,p=0,l=0,u="",c=!0,h=1;h<=t.length&&c;h++)i=t.slice(0,h),l=p,(p=this.AMposition(this.AMnames,i,l))<this.AMnames.length&&t.slice(0,this.AMnames[p].length)==this.AMnames[p]&&(r=p,h=(u=this.AMnames[p]).length),c=p<this.AMnames.length&&t.slice(0,this.AMnames[p].length)>=this.AMnames[p];if(this.AMpreviousSymbol=this.AMcurrentSymbol,""!=u)return this.AMcurrentSymbol=this.AMsymbols[r].ttype,this.AMsymbols[r];this.AMcurrentSymbol=o.CONST,p=1,i=t.slice(0,1);for(var m=!0;i>="0"&&i<="9"&&p<=t.length;)i=t.slice(p,p+1),p++;if(i==this.config.decimalsign&&(i=t.slice(p,p+1))>="0"&&i<="9")for(m=!1,p++;i>="0"&&i<="9"&&p<=t.length;)i=t.slice(p,p+1),p++;return m&&p>1||p>2?(i=t.slice(0,p-1),a="mn"):(p=2,a=((i=t.slice(0,1))<"A"||i>"Z")&&(i<"a"||i>"z")?"mo":"mi"),"-"==i&&this.AMpreviousSymbol==o.INFIX?(this.AMcurrentSymbol=o.INFIX,{input:i,tag:a,output:i,ttype:o.UNARY,func:!0,val:!0}):{input:i,tag:a,output:i,ttype:o.CONST,val:!0}}},{key:"AMTremoveBrackets",value:function AMTremoveBrackets(t){var r;if("{"==t.charAt(0)&&"}"==t.charAt(t.length-1)){var o=0;"\\left"==(r=t.substr(1,5))?"("==(r=t.charAt(6))||"["==r||"{"==r?o=7:"\\lbrace"==(r=t.substr(6,7))&&(o=13):"("!=(r=t.charAt(1))&&"["!=r||(o=2),o>0&&("\\right)}"==(r=t.substr(t.length-8))||"\\right]}"==r||"\\right.}"==r?(t="{".concat(t.substr(o)),t="".concat(t.substr(0,t.length-8),"}")):"\\rbrace}"==r&&(t="{".concat(t.substr(o)),t="".concat(t.substr(0,t.length-14),"}")))}return t}},{key:"AMTgetTeXsymbol",value:function AMTgetTeXsymbol(t){var r;return r="boolean"==typeof t.val&&t.val?"":"\\",null==t.tex?r+t.input:r+t.tex}},{key:"AMTgetTeXbracket",value:function AMTgetTeXbracket(t){return null==t.tex?t.input:"\\".concat(t.tex)}},{key:"AMTparseSexpr",value:function AMTparseSexpr(t){var r,i,a,p,l,u="";if(t=this.AMremoveCharsAndBlanks(t,0),null==(r=this.AMgetSymbol(t))||r.ttype==o.RIGHTBRACKET&&this.AMnestingDepth>0)return[null,t];switch(r.ttype==o.DEFINITION&&(t=r.output+this.AMremoveCharsAndBlanks(t,r.input.length),r=this.AMgetSymbol(t)),r.ttype){case o.UNDEROVER:case o.CONST:t=this.AMremoveCharsAndBlanks(t,r.input.length);var c=this.AMTgetTeXsymbol(r);return"\\"==c.charAt(0)||"mo"==r.tag?[c,t]:["{".concat(c,"}"),t];case o.LEFTBRACKET:this.AMnestingDepth++,t=this.AMremoveCharsAndBlanks(t,r.input.length),a=this.AMTparseExpr(t,!0),this.boldTextModifier.active&&this.boldTextModifier.nestingDepth+1==this.AMnestingDepth&&(this.boldTextModifier.active=!1,this.boldTextModifier.nestingDepth=-1),this.AMnestingDepth--;var h=0;return"\\right"==a[0].substr(0,6)&&(")"==(l=a[0].charAt(6))||"]"==l||"}"==l?h=6:"."==l?h=7:"\\rbrace"==(l=a[0].substr(6,7))&&(h=13)),h>0?(a[0]=a[0].substr(h),i="boolean"==typeof r.invisible&&r.invisible?"{".concat(a[0],"}"):"{".concat(this.AMTgetTeXbracket(r)).concat(a[0],"}")):i="boolean"==typeof r.invisible&&r.invisible?"{\\left.".concat(a[0],"}"):"{\\left".concat(this.AMTgetTeXbracket(r)).concat(a[0],"}"),[i,a[1]];case o.TEXT:r!=this.AMquote&&(t=this.AMremoveCharsAndBlanks(t,r.input.length)),-1==(p="{"==t.charAt(0)?t.indexOf("}"):"("==t.charAt(0)?t.indexOf(")"):"["==t.charAt(0)?t.indexOf("]"):r==this.AMquote?t.slice(1).indexOf('"')+1:0)&&(p=t.length)," "==(l=t.slice(1,p)).charAt(0)&&(u="\\ ");var m="\\text";return this.boldTextModifier.active&&this.boldTextModifier.nestingDepth<=this.AMnestingDepth&&this.boldTextModifier.nestingDepth>=0&&(m+="bf"),u+="".concat(m,"{").concat(l,"}"),this.boldTextModifier.active&&this.boldTextModifier.nestingDepth==this.AMnestingDepth&&(this.boldTextModifier.active=!1,this.boldTextModifier.nestingDepth=-1)," "==l.charAt(l.length-1)&&(u+="\\ "),[u,t=this.AMremoveCharsAndBlanks(t,p+1)];case o.UNARY:return t=this.AMremoveCharsAndBlanks(t,r.input.length),null==(a=this.AMTparseSexpr(t))[0]?["{".concat(this.AMTgetTeXsymbol(r),"}"),t]:"boolean"==typeof r.func&&r.func?"^"==(l=t.charAt(0))||"_"==l||"/"==l||"|"==l||","==l||1==r.input.length&&r.input.match(/\w/)&&"("!=l?["{".concat(this.AMTgetTeXsymbol(r),"}"),t]:[i="{".concat(this.AMTgetTeXsymbol(r),"{").concat(a[0],"}}"),a[1]]:(a[0]=this.AMTremoveBrackets(a[0]),"sqrt"==r.input?["\\sqrt{".concat(a[0],"}"),a[1]]:"cancel"==r.input?["\\cancel{".concat(a[0],"}"),a[1]]:void 0!==r.rewriteleftright?["{\\left".concat(r.rewriteleftright[0]).concat(a[0],"\\right").concat(r.rewriteleftright[1],"}"),a[1]]:"boolean"==typeof r.acc&&r.acc?["".concat(this.AMTgetTeXsymbol(r),"{").concat(a[0],"}"),a[1]]:["{".concat(this.AMTgetTeXsymbol(r),"{").concat(a[0],"}}"),a[1]]);case o.BINARY:if(t=this.AMremoveCharsAndBlanks(t,r.input.length),null==(a=this.AMTparseSexpr(t))[0])return["{".concat(this.AMTgetTeXsymbol(r),"}"),t];a[0]=this.AMTremoveBrackets(a[0]);var T=this.AMTparseSexpr(a[1]);return null==T[0]?["{".concat(this.AMTgetTeXsymbol(r),"}"),t]:(T[0]=this.AMTremoveBrackets(T[0]),[u="color"==r.input?"{\\color{".concat(a[0].replace(/[{}]/g,""),"}").concat(T[0],"}"):"root"==r.input?"{\\sqrt[".concat(a[0],"]{").concat(T[0],"}}"):"{".concat(this.AMTgetTeXsymbol(r),"{").concat(a[0],"}{").concat(T[0],"}}"),T[1]]);case o.INFIX:return t=this.AMremoveCharsAndBlanks(t,r.input.length),[r.output,t];case o.SPACE:return t=this.AMremoveCharsAndBlanks(t,r.input.length),["{\\quad\\text{".concat(r.input,"}\\quad}"),t];case o.LEFTRIGHT:return this.AMnestingDepth++,t=this.AMremoveCharsAndBlanks(t,r.input.length),a=this.AMTparseExpr(t,!1),this.AMnestingDepth--,"|"==(l=a[0].charAt(a[0].length-1))?[i="{\\left|".concat(a[0],"}"),a[1]]:[i="{\\mid}",t];default:return t=this.AMremoveCharsAndBlanks(t,r.input.length),["{".concat(this.AMTgetTeXsymbol(r),"}"),t]}}},{key:"AMTparseIexpr",value:function AMTparseIexpr(t){var r,i,a,p=this.AMremoveCharsAndBlanks(t,0),l=this.AMgetSymbol(p);"bold"==l.atval&&(this.boldTextModifier.active=!0,this.boldTextModifier.nestingDepth=this.AMnestingDepth),r=(i=this.AMTparseSexpr(p))[0],this.AMnestingDepth===this.boldTextModifier.nestingDepth&&(this.boldTextModifier.active=!1,this.boldTextModifier.nestingDepth=-1),p=i[1];var u=this.AMgetSymbol(p);if(u.ttype==o.INFIX&&"/"!=u.input){if(p=this.AMremoveCharsAndBlanks(p,u.input.length),null==(i=this.AMTparseSexpr(p))[0]?i[0]="{}":i[0]=this.AMTremoveBrackets(i[0]),p=i[1],"_"==u.input)if("^"==(a=this.AMgetSymbol(p)).input){p=this.AMremoveCharsAndBlanks(p,a.input.length);var c=this.AMTparseSexpr(p);c[0]=this.AMTremoveBrackets(c[0]),p=c[1],r="{".concat(r),r+="_{".concat(i[0],"}"),r+="^{".concat(c[0],"}"),r+="}"}else r+="_{".concat(i[0],"}");else r="".concat(r,"^{").concat(i[0],"}");void 0!==l.func&&l.func&&(a=this.AMgetSymbol(p)).ttype!=o.INFIX&&a.ttype!=o.RIGHTBRACKET&&(i=this.AMTparseIexpr(p),r="{".concat(r).concat(i[0],"}"),p=i[1])}return[r,p]}},{key:"AMTparseExpr",value:function AMTparseExpr(t,r){var i,a,p,l,u="",c=!1;do{t=this.AMremoveCharsAndBlanks(t,0),a=(p=this.AMTparseIexpr(t))[0],t=p[1],(i=this.AMgetSymbol(t)).ttype==o.INFIX&&"/"==i.input?(t=this.AMremoveCharsAndBlanks(t,i.input.length),null==(p=this.AMTparseIexpr(t))[0]?p[0]="{}":p[0]=this.AMTremoveBrackets(p[0]),t=p[1],a=this.AMTremoveBrackets(a),a="\\frac{".concat(a,"}"),u+=a+="{".concat(p[0],"}"),i=this.AMgetSymbol(t)):null!=a&&(u+=a)}while((i.ttype!=o.RIGHTBRACKET&&(i.ttype!=o.LEFTRIGHT||r)||0==this.AMnestingDepth)&&null!=i&&""!=i.output);if(i.ttype==o.RIGHTBRACKET||i.ttype==o.LEFTRIGHT){var h=u.length;if(h>2&&"{"==u.charAt(0)&&u.indexOf(",")>0){var m=u.charAt(h-2);if(")"==m||"]"==m){var T=u.charAt(6);if("("==T&&")"==m&&"}"!=i.output||"["==T&&"]"==m){var E="\\matrix{",y=[];y.push(0);var d=!0,C=0,_=[];_[0]=[0];var O=0,g=0;for(l=1;l<h-1;l++)u.charAt(l)==T&&C++,u.charAt(l)==m&&0==--C&&","==u.charAt(l+2)&&"{"==u.charAt(l+3)&&(y.push(l+2),_[O=l+2]=[l+2]),"["!=u.charAt(l)&&"("!=u.charAt(l)&&"{"!=u.charAt(l)||g++,"]"!=u.charAt(l)&&")"!=u.charAt(l)&&"}"!=u.charAt(l)||g--,","==u.charAt(l)&&1==g&&_[O].push(l);y.push(h);var v=-1;if(0==C&&y.length>0)for(l=0;l<y.length-1;l++){var P=void 0;if(l>0&&(E+="\\\\"),0==l)if(1==_[y[l]].length)P=[u.substr(y[l]+7,y[l+1]-y[l]-15)];else{P=[u.substring(y[l]+7,_[y[l]][1])];for(var S=2;S<_[y[l]].length;S++)P.push(u.substring(_[y[l]][S-1]+1,_[y[l]][S]));P.push(u.substring(_[y[l]][_[y[l]].length-1]+1,y[l+1]-8))}else if(1==_[y[l]].length)P=[u.substr(y[l]+8,y[l+1]-y[l]-16)];else{P=[u.substring(y[l]+8,_[y[l]][1])];for(var M=2;M<_[y[l]].length;M++)P.push(u.substring(_[y[l]][M-1]+1,_[y[l]][M]));P.push(u.substring(_[y[l]][_[y[l]].length-1]+1,y[l+1]-8))}v>0&&P.length!=v?d=!1:-1==v&&(v=P.length),E+=P.join("&")}E+="}",d&&(u=E)}}}t=this.AMremoveCharsAndBlanks(t,i.input.length),"boolean"==typeof i.invisible&&i.invisible?(u+="\\right.",c=!0):(u+=a="\\right".concat(this.AMTgetTeXbracket(i)),c=!0)}return this.AMnestingDepth>0&&!c&&(u+="\\right."),[u,t]}},{key:"ParseAMtoTeX",value:function ParseAMtoTeX(t){return this.AMnestingDepth=0,null==(t=(t=(t=(t=t.replace(/(&nbsp;|\u00a0|&#160;)/g,"")).replace(/&gt;/g,">")).replace(/&lt;/g,"<")).replace(/\u2013|\u2014/g,"-")).match(/\S/)?"":this.AMTparseExpr(t.replace(/^\s+/g,""),!1)[0]}}],[{key:"Instance",get:function get(){return void 0===this.__instance&&(this.__instance=new AsciiMathToLatexConverter),this.__instance}}]),AsciiMathToLatexConverter}();r.AsciiMathToLatexConverter=i,function(t){t[t.CONST=0]="CONST",t[t.UNARY=1]="UNARY",t[t.BINARY=2]="BINARY",t[t.INFIX=3]="INFIX",t[t.LEFTBRACKET=4]="LEFTBRACKET",t[t.RIGHTBRACKET=5]="RIGHTBRACKET",t[t.SPACE=6]="SPACE",t[t.UNDEROVER=7]="UNDEROVER",t[t.DEFINITION=8]="DEFINITION",t[t.LEFTRIGHT=9]="LEFTRIGHT",t[t.TEXT=10]="TEXT"}(o||(o={}))},3892:(t,r)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.WorkingFormulaEditorConverter=void 0;var o=function(){function WorkingFormulaEditorConverter(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,WorkingFormulaEditorConverter)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(WorkingFormulaEditorConverter,null,[{key:"convertFormulas",value:function convertFormulas(t,r,o){return t.split("\n").map((function(t){return WorkingFormulaEditorConverter.convertFormula(t,r,o)})).join("\n")}},{key:"convertFormula",value:function convertFormula(t,r,o){var i=null;do{i=(1e8*Math.random()).toFixed(0)}while(t.indexOf(i)>=0);var a,p=[],l=t.replace(WorkingFormulaEditorConverter.convertFormulaVariableReplacement,(function(t){return p.push(t),"".concat(i," ")})),u=l.match(WorkingFormulaEditorConverter.checkColonRegex);u&&void 0===u[1]?(a=WorkingFormulaEditorConverter.convertFormulaViaTextMatching(l).replace(new RegExp("\\(".concat(i,"\\)"),"g"),i),a=WorkingFormulaEditorConverter.removeExpressionEntityComponentsViaTextMatching(a)):a=WorkingFormulaEditorConverter.convertFormulaViaExpressionTree(l,r,o);for(var c=0,h=p;c<h.length;c++){var m=h[c];a=a.replace(i,"\\var".concat(m))}return a}},{key:"convertFormulaViaExpressionTree",value:function convertFormulaViaExpressionTree(t,r,o){return r.generateDisplayLatexFromEquationString(t,o)}},{key:"removeExpressionEntityComponentsViaTextMatching",value:function removeExpressionEntityComponentsViaTextMatching(t){t=t.replace(WorkingFormulaEditorConverter.removeEmptyComponentMatch,"");var r=0;do{if((r=t.indexOf(WorkingFormulaEditorConverter.removeExpressionEntityMatchText,r))>=0){var o=r+WorkingFormulaEditorConverter.removeTextEntityMatchLength-1,i=WorkingFormulaEditorConverter.matchingBracketIndex(t,o,1),a=t.substring(o+1,i-1);t=t.substring(0,r)+a+t.substring(i),r+=a.length}}while(r>=0);return t}},{key:"matchingBracketIndex",value:function matchingBracketIndex(t,r,o){var i,a=WorkingFormulaEditorConverter.matchingBrackets.hasOwnProperty(t[r]),p=[],l="";for(i=r;i>=0&&i<t.length;i+=o){var u=t[i];if(!a&&0==p.length&&!WorkingFormulaEditorConverter.expressionGroupCharacters.test(u))return i;if(u==l){if(p.pop(),0==p.length&&a)return i+o;l=p[p.length-1]}else WorkingFormulaEditorConverter.matchingBrackets.hasOwnProperty(u)&&(l=WorkingFormulaEditorConverter.matchingBrackets[u],p.push(l))}return i}},{key:"groupSubstring",value:function groupSubstring(t,r,o){return WorkingFormulaEditorConverter.matchingBrackets.hasOwnProperty(t[r])&&WorkingFormulaEditorConverter.matchingBrackets.hasOwnProperty(t[o-1])?t.substring(r+1,o-1):t.substring(r,o)}},{key:"convertFormulaViaTextMatching",value:function convertFormulaViaTextMatching(t){var r,o=t;for(r=0;r<o.length;r+=1){var i=o[r];if("_"==i||"^"==i){var a=WorkingFormulaEditorConverter.matchingBracketIndex(o,r+1,1),p=WorkingFormulaEditorConverter.groupSubstring(o,r+1,a);o="".concat(o.substring(0,r)).concat(i,"{").concat(p,"}").concat(o.substring(a))}else if("/"==i){var l=r,u=WorkingFormulaEditorConverter.matchingBracketIndex(o,l-1,-1)+1,c=r+1,h=WorkingFormulaEditorConverter.matchingBracketIndex(o,c,1),m=WorkingFormulaEditorConverter.groupSubstring(o,u,l),T=WorkingFormulaEditorConverter.groupSubstring(o,c,h);o="".concat(o.substring(0,u),"\\frac{").concat(m,"}{").concat(T,"}").concat(o.substring(h))}else if("√"==i){var E="",y=r;r>0&&"]"==o[r-1]&&(y=WorkingFormulaEditorConverter.matchingBracketIndex(o,r-1,-1)+1,E=WorkingFormulaEditorConverter.groupSubstring(o,y,r));var d=WorkingFormulaEditorConverter.matchingBracketIndex(o,r+1,1),C=WorkingFormulaEditorConverter.groupSubstring(o,r+1,d);o="".concat(o.substring(0,y),"\\sqrt").concat(E?"[".concat(E,"]"):"","{").concat(C,"}").concat(o.substring(d))}}return o}}]),WorkingFormulaEditorConverter}();r.WorkingFormulaEditorConverter=o,o.convertFormulaVariableReplacement=/\{(.*?)\}/g,o.checkColonRegex=/(-)?:/,o.removeExpressionEntityMatchText="\\expression{",o.removeTextEntityMatchLength=o.removeExpressionEntityMatchText.length,o.removeEmptyComponentMatch=/(?:\[ {2}\])/g,o.matchingBrackets={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{"},o.expressionGroupCharacters=/[a-z0-9.]/i},8002:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.WorkerMessageCmds=void 0,function(t){t.INIT="init",t.COMPARE_STEPS="compareSteps",t.COMPARE_STEPS_COMPLETE="onCompareSteps",t.COMPARE_STEPS_ERROR="errorCompareSteps",t.PRECOMPLILE="precompile",t.PRECOMPILE_ERROR="errorPrecompile",t.PRECOMPILE_COMPLETE="onPrecompile"}(r.WorkerMessageCmds||(r.WorkerMessageCmds={}))},9310:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _get(t,r,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,r,o){var i=function _superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(o):a.value}})(t,r,o||t)}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.ArrowComponent=void 0;var i=o(5223),a=o(5099),p=o(340),l=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(ArrowComponent,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(ArrowComponent);function ArrowComponent(t){var o;return function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ArrowComponent),(o=r.call(this,t,!0)).type=p.ExpressionTreeTypes.TYPE_ARROW_COMPONENT,o}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(ArrowComponent,[{key:"addChild",value:function addChild(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;r>1||this.children.length>1||_get(_getPrototypeOf(ArrowComponent.prototype),"addChild",this).call(this,t,r)}},{key:"outputLatex",value:function outputLatex(t){var r="";switch(this.subtype){case ArrowComponent.SUBTYPE_RIGHT:r="\\rightarrow";break;case ArrowComponent.SUBTYPE_LEFT:r="\\leftarrow";break;case ArrowComponent.SUBTYPE_RIGHT_LEFT:r="\\rightleftharpoons"}return 2==this.children.length?"".concat(this.children[0].outputLatex(t)+r," ").concat(this.children[1].outputLatex(t)):""}},{key:"sortChildren",value:function sortChildren(t){if(2==this.children.length){var r=this.children[0];this.children.sort(t),this.children[0]!=r&&(this.invertDirection(),this.compiled=!1)}}},{key:"invertDirection",value:function invertDirection(){switch(this.subtype){case ArrowComponent.SUBTYPE_RIGHT:this.subtype=ArrowComponent.SUBTYPE_LEFT;break;case ArrowComponent.SUBTYPE_LEFT:this.subtype=ArrowComponent.SUBTYPE_RIGHT;break;case ArrowComponent.SUBTYPE_RIGHT_LEFT:}}},{key:"clone",value:function clone(){var t=new ArrowComponent(this.subtype);t.type=this.type,t.subtype=this.subtype,t.childrenAreSortable=this.childrenAreSortable,t.operatorsExtracted=this.operatorsExtracted;for(var r=0;r<this.children.length;r++)t.addChild(this.children[r].clone());return t.compiled=this.compiled,t}}]),ArrowComponent}(a.BaseGroupComponent);r.ArrowComponent=l,l.SUBTYPE_RIGHT=i.ExpressionTokenTemplate.SUBTYPE_RIGHT,l.SUBTYPE_LEFT=i.ExpressionTokenTemplate.SUBTYPE_LEFT,l.SUBTYPE_RIGHT_LEFT=i.ExpressionTokenTemplate.SUBTYPE_RIGHT_LEFT},4783:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.BaseExpressionTreeComponent=void 0;var i=o(3728),a=o(340),p=function(){function BaseExpressionTreeComponent(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,BaseExpressionTreeComponent),this.parent=null,this._compiled=!1,this.id=i.GuidUtilMath.create(),this.interfaces="|IExpressionTreeComponent|",this.type=a.ExpressionTreeTypes.TYPE_UNKNOWN,this.subtype=BaseExpressionTreeComponent.SUBTYPE_UNKNOWN}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(BaseExpressionTreeComponent,[{key:"compiled",get:function get(){return this._compiled},set:function set(t){void 0!==this._compiled&&this._compiled==t||(this._compiled=t,this.parent&&!t&&(this.parent.compiled=t))}},{key:"compile",value:function compile(t){var r=t.parse(this);return this.compiled=r,r}},{key:"removeParentIfCurrent",value:function removeParentIfCurrent(t){this.parent==t&&(this.parent=null)}},{key:"allChildrenAreCompiled",get:function get(){return!0}},{key:"outputLatex",value:function outputLatex(t){return""}},{key:"clone",value:function clone(){var t=new BaseExpressionTreeComponent;return t.type=this.type,t.subtype=this.subtype,t._compiled=this._compiled,t}},{key:"treatAsMathEntity",value:function treatAsMathEntity(){return!1}},{key:"implementsInterface",value:function implementsInterface(t){return this.interfaces.indexOf("|".concat(t,"|"))>-1}},{key:"addImplementedInterface",value:function addImplementedInterface(t){""==this.interfaces||null==this.interfaces?this.interfaces="|".concat(t,"|"):this.interfaces+="".concat(t,"|")}}],[{key:"outputLatexForExpressionTree",value:function outputLatexForExpressionTree(t,r){return null==t?"":t.outputLatex(r)}}]),BaseExpressionTreeComponent}();r.BaseExpressionTreeComponent=p,p.MAX_COMPILE_ATTEMPTS=10,p.SUBTYPE_UNKNOWN=0},5099:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.BaseGroupComponent=void 0;var i=o(5223),a=o(4783),p=o(340),l=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(BaseGroupComponent,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(BaseGroupComponent);function BaseGroupComponent(){var t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:BaseGroupComponent.GROUP_TYPE_UNDEFINED,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _classCallCheck(this,BaseGroupComponent),(t=r.call(this)).children=[],t.operatorsExtracted=!1,t._childrenAreSortable=!1,t.unmatchedBracket=!1,t.explicitBrackets=!1,t.addImplementedInterface("IParentComponent"),t.type=p.ExpressionTreeTypes.TYPE_GROUP_COMPONENT,t.subtype=o,t.childrenAreSortable=i,t}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(BaseGroupComponent,[{key:"addChild",value:function addChild(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;t&&(-1==r?this.children.push(t):this.children.splice(r,0,t),t.parent=this,this.compiled=!1)}},{key:"getChildAtPosition",value:function getChildAtPosition(t){return t<this.children.length?this.children[t]:null}},{key:"getPositionOfChild",value:function getPositionOfChild(t){return this.children.indexOf(t)}},{key:"replaceChild",value:function replaceChild(t,r){if(r){var o=this.children.indexOf(t);-1!=o&&(this.children[o]=r,t.removeParentIfCurrent(this),r.parent=this,this.compiled=!1)}else this.removeChild(t)}},{key:"removeChild",value:function removeChild(t){var r=this.children.indexOf(t);-1!=r&&(this.children.splice(r,1),t.removeParentIfCurrent(this),this.compiled=!1)}},{key:"removeAllChildren",value:function removeAllChildren(){var t,r=_createForOfIteratorHelper(this.children);try{for(r.s();!(t=r.n()).done;)t.value.removeParentIfCurrent(this)}catch(t){r.e(t)}finally{r.f()}this.children=[],this.compiled=!1}},{key:"compile",value:function compile(t){for(var r=this.operatorsExtracted?1:2,o=0;o<r;o+=1){for(var i=0,p=!1;!p&&i<a.BaseExpressionTreeComponent.MAX_COMPILE_ATTEMPTS;){p=!0;var l,u=_createForOfIteratorHelper(this.children);try{for(u.s();!(l=u.n()).done;)if(!l.value.compile(t)){p=!1;break}}catch(t){u.e(t)}finally{u.f()}i+=1}var c=t.parse(this)&&this.allChildrenAreCompiled;this.compiled=c,this.operatorsExtracted||(this.operatorsExtracted=!0)}return this.compiled}},{key:"numberOfChildren",get:function get(){return this.children.length}},{key:"getAllChildren",value:function getAllChildren(){return this.children.concat()}},{key:"allChildrenAreCompiled",get:function get(){var t,r=_createForOfIteratorHelper(this.children);try{for(r.s();!(t=r.n()).done;)if(0==t.value.compiled)return!1}catch(t){r.e(t)}finally{r.f()}return!0}},{key:"childrenAreSortable",get:function get(){return this._childrenAreSortable},set:function set(t){void 0!==this._childrenAreSortable&&t==this._childrenAreSortable||(this._childrenAreSortable=t,this.compiled=!1)}},{key:"bracketIsUnmatched",get:function get(){return this.unmatchedBracket},set:function set(t){void 0!==this.unmatchedBracket&&t==this.unmatchedBracket||(this.unmatchedBracket=t,this.compiled=!1)}},{key:"sortChildren",value:function sortChildren(t){this.childrenAreSortable&&(this.children.sort(t),this.compiled=!1)}},{key:"clone",value:function clone(){var t=new BaseGroupComponent;t.type=this.type,t.subtype=this.subtype,t.childrenAreSortable=this.childrenAreSortable,t.unmatchedBracket=this.unmatchedBracket,t.explicitBrackets=this.explicitBrackets,t.operatorsExtracted=this.operatorsExtracted;var r,o=_createForOfIteratorHelper(this.children);try{for(o.s();!(r=o.n()).done;){var i=r.value;t.addChild(i.clone())}}catch(t){o.e(t)}finally{o.f()}return t.compiled=this.compiled,t}},{key:"reparentAllChildren",value:function reparentAllChildren(){var t,r=_createForOfIteratorHelper(this.children);try{for(r.s();!(t=r.n()).done;)t.value.parent=this}catch(t){r.e(t)}finally{r.f()}}},{key:"outputLatex",value:function outputLatex(t){var r,o="",i="";switch(this.subtype){case BaseGroupComponent.GROUP_TYPE_CURLY_BRACKETS:o="\\{",i="\\}";break;case BaseGroupComponent.GROUP_TYPE_SQUARE_BRACKETS:o="[",i="]";break;case BaseGroupComponent.GROUP_TYPE_ROUND_BRACKETS:o="(",i=")";break;case BaseGroupComponent.GROUP_TYPE_PIPE_BRACKETS:o="|",i="|"}if(r=this.children.map((function(r){return r.outputLatex(t)})).join(" "),""==o&&1==this.numberOfChildren)return r;if(this.subtype==BaseGroupComponent.GROUP_TYPE_UNDEFINED&&(""==r||!this.explicitBrackets))return r;var a="\\left".concat(""==o?".":o),p="\\right".concat(""==i?"":i);return"".concat(a," ").concat(r," ").concat(p)}},{key:"getRelativeImportanceOfChildren",value:function getRelativeImportanceOfChildren(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=[],i=this.getAllChildren();if(0==i.length)return o;var a,p=r/i.length,l=_createForOfIteratorHelper(i);try{for(l.s();!(a=l.n()).done;){var u=a.value;o.push({component:u,value:p})}}catch(t){l.e(t)}finally{l.f()}if(t){var c,h=[],m=_createForOfIteratorHelper(i);try{for(m.s();!(c=m.n()).done;){var T=c.value;if(T.implementsInterface("IParentComponent")){var E=T.getRelativeImportanceOfChildren(t,r);E.length>0&&(h=h.concat(E))}}}catch(t){m.e(t)}finally{m.f()}h.length>0&&(o=o.concat(h))}return o}}]),BaseGroupComponent}(a.BaseExpressionTreeComponent);r.BaseGroupComponent=l,l.GROUP_TYPE_UNDEFINED=0,l.GROUP_TYPE_CURLY_BRACKETS=i.ExpressionTokenTemplate.BRACE_TYPE_CURLY,l.GROUP_TYPE_SQUARE_BRACKETS=i.ExpressionTokenTemplate.BRACE_TYPE_SQUARE,l.GROUP_TYPE_ROUND_BRACKETS=i.ExpressionTokenTemplate.BRACE_TYPE_ROUND,l.GROUP_TYPE_PIPE_BRACKETS=i.ExpressionTokenTemplate.BRACE_TYPE_PIPES,l.GROUP_TYPE_STATEMENT_GROUP=4,l.GROUP_TYPE_STATEMENT_CONTENTS=5,l.GROUP_TYPE_EXPRESSION_CONTENTS=6,l.GROUP_TYPE_PARAMETER_GROUP=7,l.GROUP_TYPE_PARAMETER_CONTENTS=8,l.GROUP_TYPE_EITHER_OR=9},4662:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _get(t,r,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,r,o){var i=function _superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(o):a.value}})(t,r,o||t)}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.EqualsComponent=void 0;var i=o(5223),a=o(5099),p=o(340),l=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(EqualsComponent,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(EqualsComponent);function EqualsComponent(t){var o;return function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,EqualsComponent),(o=r.call(this,t,!0)).type=p.ExpressionTreeTypes.TYPE_EQUALS_COMPONENT,o}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(EqualsComponent,[{key:"addChild",value:function addChild(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;r>1||this.children.length>1||_get(_getPrototypeOf(EqualsComponent.prototype),"addChild",this).call(this,t,r)}},{key:"outputLatex",value:function outputLatex(t){var r="";switch(this.subtype){case EqualsComponent.SUBTYPE_EQUAL_TO:r="=";break;case EqualsComponent.SUBTYPE_NOT_EQUAL_TO:r="\\ne";break;case EqualsComponent.SUBTYPE_GREATER_THAN:r=">";break;case EqualsComponent.SUBTYPE_GREATER_THAN_EQUAL_TO:r="\\ge";break;case EqualsComponent.SUBTYPE_LESS_THAN:r="<";break;case EqualsComponent.SUBTYPE_LESS_THAN_EQUAL_TO:r="\\le"}return 2==this.children.length?this.children[0].outputLatex(t)+r+this.children[1].outputLatex(t):1==this.children.length?this.children[0].outputLatex(t)+r:""}},{key:"sortChildren",value:function sortChildren(t){var r=this.children[0];this.children.sort(t),this.children[0]!=r&&(this.invertEqualsSign(),this.compiled=!1)}},{key:"invertEqualsSign",value:function invertEqualsSign(){switch(this.subtype){case EqualsComponent.SUBTYPE_GREATER_THAN:this.subtype=EqualsComponent.SUBTYPE_LESS_THAN;break;case EqualsComponent.SUBTYPE_GREATER_THAN_EQUAL_TO:this.subtype=EqualsComponent.SUBTYPE_LESS_THAN_EQUAL_TO;break;case EqualsComponent.SUBTYPE_LESS_THAN:this.subtype=EqualsComponent.SUBTYPE_GREATER_THAN;break;case EqualsComponent.SUBTYPE_LESS_THAN_EQUAL_TO:this.subtype=EqualsComponent.SUBTYPE_GREATER_THAN_EQUAL_TO}}},{key:"clone",value:function clone(){var t=new EqualsComponent(this.subtype);t.type=this.type,t.subtype=this.subtype,t.childrenAreSortable=this.childrenAreSortable,t.operatorsExtracted=this.operatorsExtracted;for(var r=0;r<this.children.length;r++)t.addChild(this.children[r].clone());return t.compiled=this.compiled,t}}]),EqualsComponent}(a.BaseGroupComponent);r.EqualsComponent=l,l.SUBTYPE_EQUAL_TO=i.ExpressionTokenTemplate.SUBTYPE_EQUAL_TO,l.SUBTYPE_NOT_EQUAL_TO=i.ExpressionTokenTemplate.SUBTYPE_NOT_EQUAL_TO,l.SUBTYPE_GREATER_THAN=i.ExpressionTokenTemplate.SUBTYPE_GREATER_THAN,l.SUBTYPE_GREATER_THAN_EQUAL_TO=i.ExpressionTokenTemplate.SUBTYPE_GREATER_THAN_EQUAL_TO,l.SUBTYPE_LESS_THAN=i.ExpressionTokenTemplate.SUBTYPE_LESS_THAN,l.SUBTYPE_LESS_THAN_EQUAL_TO=i.ExpressionTokenTemplate.SUBTYPE_LESS_THAN_EQUAL_TO},2178:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _get(t,r,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,r,o){var i=function _superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(o):a.value}})(t,r,o||t)}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.ExponentComponent=void 0;var i=o(5223),a=o(4808),p=o(4783),l=o(340),u=o(4712),c=o(3721),h=o(7491),m=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(ExponentComponent,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(ExponentComponent);function ExponentComponent(){var t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return _classCallCheck(this,ExponentComponent),(t=r.call(this)).addImplementedInterface("IParentComponent"),t.addImplementedInterface("IWrapperComponent"),t.addImplementedInterface("IExponentComponent"),t.type=l.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT,t.subtype=a,t.base=o,t.exponent=i,t}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(ExponentComponent,[{key:"base",get:function get(){return this._base},set:function set(t){void 0!==this._base&&t==this._base||(this._base&&this._base.removeParentIfCurrent(this),this._base=t,this._base&&(this._base.parent=this),this.compiled=!1)}},{key:"exponent",get:function get(){return this._exponent},set:function set(t){void 0!==this._exponent&&t==this._exponent||(this._exponent&&this._exponent.removeParentIfCurrent(this),this._exponent=t,this._exponent&&(this._exponent.parent=this),this.compiled=!1)}},{key:"hasNumericExponent",get:function get(){return this.exponent.type==l.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT}},{key:"compile",value:function compile(t){for(var r=0,o=!1;!o&&r<p.BaseExpressionTreeComponent.MAX_COMPILE_ATTEMPTS;)o=!0,this.base&&(this.base.compile(t)||(o=!1)),this.exponent&&(this.exponent.compile(t)||(o=!1)),r++;return null!=this.parent&&_get(_getPrototypeOf(ExponentComponent.prototype),"compile",this).call(this,t)}},{key:"removeChild",value:function removeChild(t){t==this.base?(this.base=null,this.compiled=!1):t==this.exponent&&(this.parent.replaceChild(this,this.base),this.exponent=null,this.compiled=!1)}},{key:"replaceChild",value:function replaceChild(t,r){r?(t==this.base&&(this.base=r,this.compiled=!1),t==this.exponent&&(this.exponent=r,this.compiled=!1)):this.removeChild(t)}},{key:"allChildrenAreCompiled",get:function get(){return!(this.base&&!this.base.compiled||this.exponent&&!this.exponent.compiled)}},{key:"outputLatex",value:function outputLatex(t){var r="";if(!this.base||!this.exponent)return"";var o=this.base.outputLatex(t),p=this.exponent.outputLatex(t);switch(this.subtype){case ExponentComponent.OPERATION_TYPE_EXPONENT:var c=!1,m=!1,T=!0;if(this.base.type==l.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT&&(c=!0),this.base.type==l.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&(c=!0,this.base.subtype==u.MultiOperatorComponentSubtypes.MULTIPLY_DIVIDE)){var E,y=_createForOfIteratorHelper(this.base.getAllChildren());try{for(y.s();!(E=y.n()).done;){var d=E.value;d.type!=l.ExpressionTreeTypes.TYPE_MATH_ENTITY_COMPONENT&&d.type!=l.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT&&d.type!=i.ExpressionTokenTemplate.TYPE_TEXT_NOS&&(m=!0)}}catch(t){y.e(t)}finally{y.f()}}this.base.type!=l.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT||this._base.subtype!=h.UnaryOperatorComponentSubtypes.MINUS&&this._base.subtype!=h.UnaryOperatorComponentSubtypes.PLUS_MINUS||(c=!0),this.exponent.type==l.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT&&(T=!1),(m||c&&!a.LatexUtil.isBoundedByRoundBrackets(o))&&(o=a.LatexUtil.addBracketsAroundLatex(o)),r=T?"".concat(o,"^{").concat(p,"}"):"".concat(o,"^").concat(p);break;case ExponentComponent.OPERATION_TYPE_ROOT:r=this._exponent.type==l.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT&&2==this._exponent.value?"\\sqrt{".concat(o,"}"):"\\sqrt[".concat(p,"]{").concat(o,"}")}return r}},{key:"removeAllChildren",value:function removeAllChildren(){this.base=null,this.exponent=null}},{key:"numberOfChildren",get:function get(){var t=0;return null!=this.base&&t++,null!=this.exponent&&t++,t}},{key:"getAllChildren",value:function getAllChildren(){var t=[];return null!=this.base&&t.push(this.base),null!=this.exponent&&t.push(this.exponent),t}},{key:"evaluateAsNumberComponentIfPossible",value:function evaluateAsNumberComponentIfPossible(){if(this.base.type!=l.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT||this.exponent.type!=l.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT)return null;this.base.value;var t=this.exponent.value;this.subtype==ExponentComponent.OPERATION_TYPE_ROOT&&(t=1/t);var r=Math.pow(this.base.value,t);return new c.NumberComponent(r)}},{key:"normaliseNumericExponent",value:function normaliseNumericExponent(){if(this.exponent.type==l.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT){var t=this.exponent.value;if(Math.abs(t)<1){var r=new c.NumberComponent(1/t);return this.exponent=r,this.subtype=this.subtype==ExponentComponent.OPERATION_TYPE_ROOT?ExponentComponent.OPERATION_TYPE_EXPONENT:ExponentComponent.OPERATION_TYPE_ROOT,this.compiled=!1,!0}}return!1}},{key:"clone",value:function clone(){var t=new ExponentComponent;return t.type=this.type,t.subtype=this.subtype,null!=this.base&&(t.base=this.base.clone()),null!=this.exponent&&(t.exponent=this.exponent.clone()),t.compiled=this.compiled,t}},{key:"treatAsMathEntity",value:function treatAsMathEntity(){return this.base instanceof p.BaseExpressionTreeComponent&&this.base.treatAsMathEntity()}},{key:"getBaseComponent",value:function getBaseComponent(){return this.base.implementsInterface("IWrapperComponent")?this.base.getBaseComponent():this.base}},{key:"getRelativeImportanceOfChildren",value:function getRelativeImportanceOfChildren(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=[];if(null!=this.base&&o.push({component:this.base,value:.6*r}),null!=this.exponent&&o.push({component:this.exponent,value:.6*r}),t&&o.length>0){var i,a=[],p=_createForOfIteratorHelper(o);try{for(p.s();!(i=p.n()).done;){var l=i.value;if(l&&l.component&&l.component.implementsInterface("IParentComponent")){var u=l.component.getRelativeImportanceOfChildren(t,l.value);u.length>0&&(a=a.concat(u))}}}catch(t){p.e(t)}finally{p.f()}a.length>0&&(o=o.concat(a))}return o}}]),ExponentComponent}(p.BaseExpressionTreeComponent);r.ExponentComponent=m,m.OPERATION_TYPE_EXPONENT=i.ExpressionTokenTemplate.SUBTYPE_POWER,m.OPERATION_TYPE_ROOT=i.ExpressionTokenTemplate.SUBTYPE_ROOT},9873:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.ExponentComponentHelper=void 0;var i=o(2178),a=o(340),p=o(9837),l=o(3721),u=o(1997),c=o(7491),h=function(){function ExponentComponentHelper(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ExponentComponentHelper)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(ExponentComponentHelper,null,[{key:"splitOutMultiplyDivide",value:function splitOutMultiplyDivide(t){if(!t||!t.base)return!1;if(!t||!t.base)return!1;var r,o=!1,h=!1;if(t.base.type==a.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&t.base.subtype==p.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE)o=!0,r=t.base;else if(t.base.type==a.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT&&t.base.subtype==c.UnaryOperatorComponentSubtypes.MINUS){var m=t.base;m.child.type==a.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&m.child.subtype==p.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE&&(o=!0,r=m.child,h=!0)}if(!o)return!1;for(var T=r.getAllChildren(),E=0;E<T.length;E++){var y=T[E],d=new i.ExponentComponent(y,t.exponent.clone(),t.subtype);r.replaceChild(y,d)}if(h){var C=new u.UnaryOperatorComponent(new l.NumberComponent(1),c.UnaryOperatorComponentSubtypes.MINUS);r.addChild(C,!1)}return t.parent.replaceChild(t,r),!0}},{key:"mergeWithParentIfAlsoExponent",value:function mergeWithParentIfAlsoExponent(t){if(t.parent.type==a.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT){var r=t.parent;if(r.base==t){var o=new p.MultiOperatorComponent(p.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE);o.addChild(r.exponent,!1);var i=t.subtype!=t.parent.subtype;return o.addChild(t.exponent,i),r.base=t.base,r.exponent=o,!0}}return!1}}]),ExponentComponentHelper}();r.ExponentComponentHelper=h},7410:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ExponentComponentSubtypes=void 0,function(t){t[t.EXPONENT=5]="EXPONENT",t[t.ROOT=30]="ROOT"}(r.ExponentComponentSubtypes||(r.ExponentComponentSubtypes={}))},340:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ExpressionTreeTypes=void 0,function(t){t[t.TYPE_UNKNOWN=1001]="TYPE_UNKNOWN",t[t.TYPE_EQUALS_COMPONENT=1010]="TYPE_EQUALS_COMPONENT",t[t.TYPE_ARROW_COMPONENT=1013]="TYPE_ARROW_COMPONENT",t[t.TYPE_OR_COMPONENT=1015]="TYPE_OR_COMPONENT",t[t.TYPE_NUMBER_COMPONENT=1020]="TYPE_NUMBER_COMPONENT",t[t.TYPE_TEXT_COMPONENT=1021]="TYPE_TEXT_COMPONENT",t[t.TYPE_MATH_ENTITY_COMPONENT=1025]="TYPE_MATH_ENTITY_COMPONENT",t[t.TYPE_MATH_FUNCTION_COMPONENT=1030]="TYPE_MATH_FUNCTION_COMPONENT",t[t.TYPE_GROUP_COMPONENT=1040]="TYPE_GROUP_COMPONENT",t[t.TYPE_EXPONENT_COMPONENT=1050]="TYPE_EXPONENT_COMPONENT",t[t.TYPE_UNARY_OPERATOR_COMPONENT=1060]="TYPE_UNARY_OPERATOR_COMPONENT",t[t.TYPE_MULTI_OPERATOR_COMPONENT=1070]="TYPE_MULTI_OPERATOR_COMPONENT",t[t.TYPE_SUBSCRIPT_SUPERSCRIPT_COMPONENT=1080]="TYPE_SUBSCRIPT_SUPERSCRIPT_COMPONENT"}(r.ExpressionTreeTypes||(r.ExpressionTreeTypes={}))},4100:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0})},252:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.MathEntityComponent=void 0;var i=o(4808),a=o(4783),p=o(340),l=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(MathEntityComponent,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(MathEntityComponent);function MathEntityComponent(){var t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return _classCallCheck(this,MathEntityComponent),(t=r.call(this)).type=p.ExpressionTreeTypes.TYPE_MATH_ENTITY_COMPONENT,t.entityName=o,t}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathEntityComponent,[{key:"entityName",get:function get(){return this._entityName},set:function set(t){void 0!==this._entityName&&t==this._entityName||(this._entityName=t,this.compiled=!1)}},{key:"outputLatex",value:function outputLatex(t){return i.LatexUtil.replaceSpecialCharactersWithLatexCodes(this.entityName)}},{key:"clone",value:function clone(){var t=new MathEntityComponent;return t.type=this.type,t.subtype=this.subtype,t.compiled=this.compiled,t.entityName=this.entityName,t}},{key:"evaluateIfMathConstant",value:function evaluateIfMathConstant(){switch(this.entityName){case"π":return Math.PI}return NaN}},{key:"treatAsMathEntity",value:function treatAsMathEntity(){return!0}},{key:"isPlaceholder",get:function get(){return this._entityName==MathEntityComponent.PlaceholderString}},{key:"compile",value:function compile(t){return this.compiled=!0,!0}}],[{key:"generatePlaceholderComponent",value:function generatePlaceholderComponent(){return new MathEntityComponent(MathEntityComponent.PlaceholderString)}},{key:"generatePlaceholderML",value:function generatePlaceholderML(){return'<mi mathcolor="#cc0000">'.concat(MathEntityComponent.PlaceholderString,"</mi>")}}]),MathEntityComponent}(a.BaseExpressionTreeComponent);r.MathEntityComponent=l,l.PlaceholderString="[  ]"},8818:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.MathFunctionComponent=void 0;var i=o(4808),a=o(4783),p=o(340),l=o(3721),u=/^(?:sin|cos|tan|sinh|cosh|tanh)$/,c=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(MathFunctionComponent,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(MathFunctionComponent);function MathFunctionComponent(){var t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return _classCallCheck(this,MathFunctionComponent),(t=r.call(this)).addImplementedInterface("IWrapperComponent"),t.addImplementedInterface("IParentComponent"),t.addImplementedInterface("IMathFunctionComponent"),t.type=p.ExpressionTreeTypes.TYPE_MATH_FUNCTION_COMPONENT,t.setChild(o),t.setFunctionName(i),t}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathFunctionComponent,[{key:"setChild",value:function setChild(t){void 0!==this.child&&t==this.child||(this.child&&this.child.removeParentIfCurrent(this),this.child=t,this.child&&(this.child.parent=this),this.compiled=!1)}},{key:"getChild",value:function getChild(){return this.child}},{key:"setFunctionName",value:function setFunctionName(t){if(void 0===this.functionName||t!=this.functionName){switch(this.isInverseFunction=!1,t){case"arcsin":this.functionName="sin",this.isInverseFunction=!0;break;case"arccos":this.functionName="cos",this.isInverseFunction=!0;break;case"arctan":this.functionName="tan",this.isInverseFunction=!0;break;case"cosec":this.functionName="csc";break;default:this.functionName=t}this.compiled=!1}}},{key:"getFunctionName",value:function getFunctionName(){return(this.isInverseFunction?"arc":"")+this.functionName}},{key:"compile",value:function compile(t){for(var r=0,o=!1;!o&&r<a.BaseExpressionTreeComponent.MAX_COMPILE_ATTEMPTS;)o=!0,this.child&&(this.child.compile(t)||(o=!1)),r++;var i=t.parse(this);return this.compiled=i&&this.allChildrenAreCompiled,this.compiled}},{key:"removeChild",value:function removeChild(t){this.child==t&&this.setChild(null)}},{key:"replaceChild",value:function replaceChild(t,r){this.child==t&&this.setChild(r)}},{key:"removeAllChildren",value:function removeAllChildren(){this.setChild(null)}},{key:"numberOfChildren",get:function get(){return null!=this.child?1:0}},{key:"getAllChildren",value:function getAllChildren(){var t=[];return null!=this.child&&t.push(this.child),t}},{key:"allChildrenAreCompiled",get:function get(){return!this.child||0!=this.child.compiled}},{key:"clone",value:function clone(){var t=new MathFunctionComponent;return t.type=this.type,t.subtype=this.subtype,t.functionName=this.functionName,t.isInverseFunction=this.isInverseFunction,t.compiled=this.compiled,null!=this.child&&(t.child=this.child.clone()),t}},{key:"outputLatex",value:function outputLatex(t){var r=this.child?this.child.outputLatex(t):"",o=i.LatexUtil.latexIsKnownFunction(this.functionName)?"\\".concat(this.functionName):this.functionName;return this.isInverseFunction&&(o+="^{-1}"),i.LatexUtil.isBoundedByRoundBrackets(r)?o+=r:o+=i.LatexUtil.addBracketsAroundLatex(r),o}},{key:"evaluateIfNumeric",value:function evaluateIfNumeric(){if(!this.child)return NaN;var t;if(this.child instanceof l.NumberComponent)t=this.child.value;else{if(this.child.type!=p.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT)return NaN;t=this.child.evaluateIfNumeric()}if(isNaN(t))return NaN;switch(this.functionName){case"sin":return this.isInverseFunction?Math.asin(t):Math.sin(t);case"cos":return this.isInverseFunction?Math.acos(t):Math.cos(t);case"tan":return this.isInverseFunction?Math.atan(t):Math.tan(t);case"sinh":return this.isInverseFunction?Math.asinh(t):Math.sinh(t);case"cosh":return this.isInverseFunction?Math.acosh(t):Math.cosh(t);case"tanh":return this.isInverseFunction?Math.atanh(t):Math.tanh(t);case"log":return Math.log(t)*Math.LOG10E;case"ln":return Math.log(t)}return NaN}},{key:"treatAsMathEntity",value:function treatAsMathEntity(){return!0}},{key:"getRelativeImportanceOfChildren",value:function getRelativeImportanceOfChildren(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=[];if(null!=this.child&&(o[0]={component:this.child,value:r},t&&this.child.implementsInterface("IParentComponent"))){var i=this.child.getRelativeImportanceOfChildren(!0,r);i.length>0&&(o=o.concat(i))}return o}},{key:"getBaseComponent",value:function getBaseComponent(){return this.child.implementsInterface("IWrapperComponent")?this.child.getBaseComponent():this.child}},{key:"canInvertFunction",get:function get(){return u.test(this.functionName)}},{key:"invertFunction",value:function invertFunction(){this.canInvertFunction&&(this.isInverseFunction=!0)}}]),MathFunctionComponent}(a.BaseExpressionTreeComponent);r.MathFunctionComponent=c},9837:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.MultiOperatorComponent=void 0;var i=o(4808),a=o(4783),p=o(7410),l=o(340),u=o(252),c=o(8818),h=o(3721),m=o(7491),T=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(MultiOperatorComponent,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(MultiOperatorComponent);function MultiOperatorComponent(){var t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.BaseExpressionTreeComponent.SUBTYPE_UNKNOWN,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_AUTOMATIC,p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return _classCallCheck(this,MultiOperatorComponent),(t=r.call(this)).children=[],t.multiplicationDisplayType=MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_AUTOMATIC,t.childOperationType={},t.addImplementedInterface("IParentComponent"),t.type=l.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT,t.subtype=o,t.multiplicationDisplayType=i,t.positiveCharacterDisplayString=p,t.inverseCharacterDisplayString=u,t}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MultiOperatorComponent,[{key:"addChild",value:function addChild(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;t&&(-1==o?this.children.push(t):this.children.splice(o,0,t),this.childOperationType[t.id]=r,t.parent=this,this.compiled=!1)}},{key:"removeChild",value:function removeChild(t){var r=this.children.indexOf(t);-1!=r&&(this.children.splice(r,1),this.childOperationType[t.id]=null,t.removeParentIfCurrent(this),this.compiled=!1)}},{key:"removeAllChildren",value:function removeAllChildren(){var t,r=_createForOfIteratorHelper(this.children);try{for(r.s();!(t=r.n()).done;){var o=t.value;this.childOperationType[o.id]=null,o.removeParentIfCurrent(this)}}catch(t){r.e(t)}finally{r.f()}this.children=[],this.compiled=!1}},{key:"getChildAtPosition",value:function getChildAtPosition(t){return t<this.children.length?this.children[t]:null}},{key:"getPositionOfChild",value:function getPositionOfChild(t){return this.children.indexOf(t)}},{key:"getAllChildren",value:function getAllChildren(){return this.children.concat()}},{key:"getChildOperationType",value:function getChildOperationType(t){return!!this.hasChild(t)&&this.childOperationType[t.id]}},{key:"setChildOperationType",value:function setChildOperationType(t,r){this.hasChild(t)&&r!=this.childOperationType[t.id]&&(this.childOperationType[t.id]=r,this.compiled=!1)}},{key:"hasChild",value:function hasChild(t){return-1!=this.children.indexOf(t)}},{key:"replaceChild",value:function replaceChild(t,r){if(r){var o=this.children.indexOf(t);if(-1!=o){var i=this.childOperationType[t.id];t.removeParentIfCurrent(this),this.children[o]=r,r.parent=this,delete this.childOperationType[t.id],this.childOperationType[r.id]=i}}else this.removeChild(t)}},{key:"compile",value:function compile(t){for(var r=0,o=!1;!o&&r<a.BaseExpressionTreeComponent.MAX_COMPILE_ATTEMPTS;){o=!0;var i,p=_createForOfIteratorHelper(this.children);try{for(p.s();!(i=p.n()).done;)if(!i.value.compile(t)){o=!1;break}}catch(t){p.e(t)}finally{p.f()}r++}if(null==this.parent)return!1;var l=t.parse(this);return this.compiled=l&&this.allChildrenAreCompiled,this.compiled}},{key:"numberOfChildren",get:function get(){return this.children.length}},{key:"sortChildren",value:function sortChildren(t){this.children.sort(t),this.compiled=!1}},{key:"merge",value:function merge(t,r){var o,i=_createForOfIteratorHelper(t.getAllChildren());try{for(i.s();!(o=i.n()).done;){var a=o.value,p=t.getChildOperationType(a)!=r;this.addChild(a,p)}}catch(t){i.e(t)}finally{i.f()}this.compiled=!1}},{key:"invertAllOperatorTypes",value:function invertAllOperatorTypes(){var t,r=_createForOfIteratorHelper(this.children);try{for(r.s();!(t=r.n()).done;){var o=t.value;this.childOperationType[o.id]=!this.childOperationType[o.id]}}catch(t){r.e(t)}finally{r.f()}this.compiled=!1}},{key:"allChildrenAreNumeric",value:function allChildrenAreNumeric(){if(0==this.children.length)return!1;var t,r=_createForOfIteratorHelper(this.children);try{for(r.s();!(t=r.n()).done;)if(!(t.value instanceof h.NumberComponent))return!1}catch(t){r.e(t)}finally{r.f()}return!0}},{key:"normaliseNumericValues",value:function normaliseNumericValues(t){var r,o=[],i=_createForOfIteratorHelper(this.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;a instanceof h.NumberComponent&&o.push(a)}}catch(t){i.e(t)}finally{i.f()}var p,l=!1,u=MultiOperatorComponent.generateDefaultValueForOperation(this.subtype);if(o.length>1){switch(p=u,this.subtype){case MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT:var c,m=_createForOfIteratorHelper(o);try{for(m.s();!(c=m.n()).done;){var T=c.value;1==this.childOperationType[T.id]?p-=T.value:p+=T.value}}catch(t){m.e(t)}finally{m.f()}break;default:var E,y=_createForOfIteratorHelper(o);try{for(y.s();!(E=y.n()).done;){var d=E.value;1==this.childOperationType[d.id]&&0!=d.value?p/=d.value:p*=d.value}}catch(t){y.e(t)}finally{y.f()}}var C,_=_createForOfIteratorHelper(o);try{for(_.s();!(C=_.n()).done;){var O=C.value;this.removeChild(O)}}catch(t){_.e(t)}finally{_.f()}if(0==this.numberOfChildren&&t.numbersAreEqual(p,u))this.addChild(new h.NumberComponent(p),!1);else if(!t.numbersAreEqual(p,u)){if(MultiOperatorComponent.valueWillNullifyAllOtherValuesForOperation(p,this.subtype))return this.removeAllChildren(),void this.addChild(new h.NumberComponent(0),!1);MultiOperatorComponent.valueShouldBeInversedForOperation(p,this.subtype)&&(p=MultiOperatorComponent.generateInvertedValueForOperation(p,this.subtype),l=!0),this.addChild(new h.NumberComponent(p),l)}this.compiled=!1}else if(1==o.length){var g=o[0],v=g.value;t.numbersAreEqual(v,u)?1==this.numberOfChildren?this.setChildOperationType(g,!1):this.removeChild(g):MultiOperatorComponent.valueWillNullifyAllOtherValuesForOperation(v,this.subtype)?(this.removeAllChildren(),this.addChild(new h.NumberComponent(0),!1)):MultiOperatorComponent.valueShouldBeInversedForOperation(v,this.subtype)&&(p=MultiOperatorComponent.generateInvertedValueForOperation(v,this.subtype),l=!this.childOperationType[g.id],this.removeChild(g),this.addChild(new h.NumberComponent(p),l)),this.compiled=!1}}},{key:"allChildrenAreCompiled",get:function get(){var t,r=_createForOfIteratorHelper(this.children);try{for(r.s();!(t=r.n()).done;)if(0==t.value.compiled)return!1}catch(t){r.e(t)}finally{r.f()}return!0}},{key:"numberOfChildrenWithOperatorType",value:function numberOfChildrenWithOperatorType(t){var r,o=0,i=_createForOfIteratorHelper(this.children);try{for(i.s();!(r=i.n()).done;){var a=r.value;this.childOperationType[a.id]==t&&o++}}catch(t){i.e(t)}finally{i.f()}return o}},{key:"clone",value:function clone(){var t=new MultiOperatorComponent;t.type=this.type,t.subtype=this.subtype,t.multiplicationDisplayType=this.multiplicationDisplayType,t.positiveCharacterDisplayString=this.positiveCharacterDisplayString,t.inverseCharacterDisplayString=this.inverseCharacterDisplayString;var r,o=_createForOfIteratorHelper(this.children);try{for(o.s();!(r=o.n()).done;){var i=r.value,a=i.clone();t.addChild(a,this.childOperationType[i.id])}}catch(t){o.e(t)}finally{o.f()}return t.compiled=this.compiled,t}},{key:"outputLatex",value:function outputLatex(t){switch(this.subtype){case MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT:return this.outputLatexAddSubtract(t);case MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE:return this.outputLatexMultiplyDivide(t)}return""}},{key:"outputLatexAddSubtract",value:function outputLatexAddSubtract(t){for(var r="",o=0;o<this.numberOfChildren;o++){var a=this.children[o],p=a.outputLatex(t);this.childOperationType[a.id]?(a instanceof MultiOperatorComponent&&a.subtype==MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT&&!i.LatexUtil.isBoundedByRoundBrackets(p)&&(p=i.LatexUtil.addBracketsAroundLatex(p)),r+="-".concat(p)):(o>0&&(a.type==l.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT&&a.subtype==m.UnaryOperatorComponentSubtypes.PLUS_MINUS||(r+="+")),r+=p)}return r}},{key:"outputLatexMultiplyDivide",value:function outputLatexMultiplyDivide(t){var r=""!=this.positiveCharacterDisplayString&&"*"!=this.positiveCharacterDisplayString&&"×"!=this.positiveCharacterDisplayString,o="";r&&"\\"!=(o=i.LatexUtil.replaceSpecialCharactersWithLatexCodes(this.positiveCharacterDisplayString)).charAt(0)&&(r=!1,o="");var a=""!=this.inverseCharacterDisplayString&&"/"!=this.inverseCharacterDisplayString,T="";a&&"\\"!=(T=i.LatexUtil.replaceSpecialCharactersWithLatexCodes(this.inverseCharacterDisplayString)).charAt(0)&&(a=!1,T="");for(var E,y,d=!1,C=!1,_="",O=!0,g=0;g<this.numberOfChildren;g++){var v=this.children[g],P=v.outputLatex(t);g>0&&(E=this.children[g-1]),y=g<this.numberOfChildren-1?this.children[g+1]:null;var S=this.childOperationType[v.id],M=!1,x=!1;if(E)if(this.multiplicationDisplayType==MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_IMPLICIT)x=!0;else if(this.multiplicationDisplayType==MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_AUTOMATIC){var b=v;v.type==l.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT&&v.subtype==p.ExponentComponentSubtypes.EXPONENT&&(b=v.base),v.type==l.ExpressionTreeTypes.TYPE_SUBSCRIPT_SUPERSCRIPT_COMPONENT&&(b=v.base);var k=E;E.type==l.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT&&(k=E.base),E.type==l.ExpressionTreeTypes.TYPE_SUBSCRIPT_SUPERSCRIPT_COMPONENT&&(k=E.base),E.type==l.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT&&E.subtype==m.UnaryOperatorComponentSubtypes.MINUS&&(k=E.child),(k instanceof h.NumberComponent&&(b instanceof u.MathEntityComponent||b instanceof c.MathFunctionComponent)||k instanceof u.MathEntityComponent&&b instanceof u.MathEntityComponent)&&(x=!0),v.type==l.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&v.subtype==MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT&&d==S&&(E.type==l.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&E.subtype==MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT||k instanceof h.NumberComponent||k instanceof u.MathEntityComponent)&&(x=!0)}v instanceof MultiOperatorComponent?v.subtype==MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT?(E&&this.childOperationType[E.id]==S&&(M=!0),y&&this.childOperationType[y.id]==S&&(M=!0),!S&&d&&(M=!0),x&&(M=!0)):v.subtype==MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE&&this.multiplicationDisplayType!=MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_EXPLICIT&&(E&&this.childOperationType[E.id]==S&&(M=!0),y&&this.childOperationType[y.id]==S&&(M=!0)):v.type==l.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT?E&&this.multiplicationDisplayType!=MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_EXPLICIT&&(M=!0):v.type==l.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT?E&&C&&this.multiplicationDisplayType!=MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_EXPLICIT&&(M=!0):v.type==l.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT&&E&&this.childOperationType[E.id]==S&&this.multiplicationDisplayType!=MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_EXPLICIT&&(M=!0),E&&this.childOperationType[E.id]==S&&C&&null==y&&this.multiplicationDisplayType!=MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_EXPLICIT&&(M=!0),M&&!i.LatexUtil.isBoundedByRoundBrackets(P)&&(P=i.LatexUtil.addBracketsAroundLatex(P)),S?(d?x||(_+=r?o:"\\times "):(O&&(_="1"),a?_+=T:_="\\frac{".concat(_,"}{")),_+=P,d=!0):(d&&!a?_+="}":O||x||(_+=r?o:"\\times "),_+=P,d=!1),O=!1,C=M||i.LatexUtil.isBoundedByRoundBrackets(P)}return d&&!a&&(_+="}"),_}},{key:"getRelativeImportanceOfChildren",value:function getRelativeImportanceOfChildren(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=[],i=this.getAllChildren();if(0==i.length)return o;var a,p=r/i.length,l=_createForOfIteratorHelper(i);try{for(l.s();!(a=l.n()).done;){var u=a.value;o.push({component:u,value:p})}}catch(t){l.e(t)}finally{l.f()}if(t){var c,h=[],m=_createForOfIteratorHelper(i);try{for(m.s();!(c=m.n()).done;){var T=c.value;if(T.implementsInterface("IParentComponent")){var E=T.getRelativeImportanceOfChildren(t,r);E.length>0&&(h=h.concat(E))}}}catch(t){m.e(t)}finally{m.f()}h.length>0&&(o=o.concat(h))}return o}}],[{key:"sortCompare",value:function sortCompare(t,r,o){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!i){if(t==r)return 0;if(null==t)return 1;if(null==r)return-1;if(t.type!=r.type)return 1-2*Number(t.type<r.type);if(t.subtype!=r.subtype)return 1-2*Number(t.subtype<r.subtype)}for(var a=t.getAllChildren(),p=r.getAllChildren(),l=Math.min(a.length,p.length),u=0;u<l;u++){var c=a[u],h=p[u],m=o(c,h);if(0!=m)return m;var T=t.getChildOperationType(c),E=r.getChildOperationType(h);if(T!=E)return 1-2*Number(E)}return a.length!=p.length?1-2*Number(a.length<p.length):0}},{key:"generateDefaultValueForOperation",value:function generateDefaultValueForOperation(t){return t==MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT?0:1}},{key:"generateInvertedValueForOperation",value:function generateInvertedValueForOperation(t,r){return r==MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT?0-t:0==t?0:1/t}},{key:"valueShouldBeInversedForOperation",value:function valueShouldBeInversedForOperation(t,r){return r==MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT?t<0:Math.abs(t)<1}},{key:"valueWillNullifyAllOtherValuesForOperation",value:function valueWillNullifyAllOtherValuesForOperation(t,r){return r!=MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT&&0==t}}]),MultiOperatorComponent}(a.BaseExpressionTreeComponent);r.MultiOperatorComponent=T,T.OPERATION_TYPE_ADD_SUBTRACT=1,T.OPERATION_TYPE_MULTIPLY_DIVIDE=2,T.OPERATION_TYPE_EXPONENT=3,T.MULTIPLICATION_DISPLAY_TYPE_AUTOMATIC=0,T.MULTIPLICATION_DISPLAY_TYPE_IMPLICIT=1,T.MULTIPLICATION_DISPLAY_TYPE_EXPLICIT=2,T.INCLUDE_ONLY_NORMAL_OPERATION_CHILDREN=1,T.INCLUDE_ONLY_INVERSE_OPERATION_CHILDREN=2,T.INCLUDE_ALL_CHILDREN=0},1219:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MultiOperatorComponentHelper=void 0;var i=o(3648),a=o(2178),p=o(340),l=o(9837),u=o(3721),c=function(){function MultiOperatorComponentHelper(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MultiOperatorComponentHelper)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MultiOperatorComponentHelper,null,[{key:"groupIdenticalFactorsInMultiplyDivideComponent",value:function groupIdenticalFactorsInMultiplyDivideComponent(t,r){var o=MultiOperatorComponentHelper.extractAlgebraicChildrenFromMultiplyDivideComponent(t),i=o.length;if(i<2)return!1;for(var p=0;p<i-1;p++)for(var c=o[p],h=p+1;h<i;h++){var m=o[h];if(0==r(c,m)){var T=void 0,E=void 0,y=c;T=c.parent!=t?(y=c.parent).subtype==a.ExponentComponent.OPERATION_TYPE_EXPONENT?y.exponent.value:1/y.exponent.value:1;var d=m;E=m.parent!=t?(d=m.parent).subtype==a.ExponentComponent.OPERATION_TYPE_EXPONENT?d.exponent.value:1/d.exponent.value:1,t.getChildOperationType(y)&&(T*=-1),t.getChildOperationType(d)&&(E*=-1);var C=T+E;if(0==C)t.removeChild(y),t.removeChild(d),0==t.numberOfChildren&&t.addChild(new u.NumberComponent(l.MultiOperatorComponent.generateDefaultValueForOperation(t.subtype)),!1);else if(1==Math.abs(C)){var _=-1==C;t.removeChild(d),t.removeChild(y),t.addChild(c,_)}else{var O=!1;C<0&&(C*=-1,O=!0);var g=new a.ExponentComponent(c,new u.NumberComponent(C),a.ExponentComponent.OPERATION_TYPE_EXPONENT);t.removeChild(y),t.removeChild(d),t.addChild(g,O)}return!0}}return!1}},{key:"algebraicSimplifyPlusMinusComponent",value:function algebraicSimplifyPlusMinusComponent(t,r){for(var o=!1,i=0;i<t.children.length-1;i++){var a=t.children[i],c=MultiOperatorComponentHelper.extractPlusMinusAlgebraicChildrenFromChild(a),h=a.type==p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT;if(c.length>0)for(var m=i+1;m<t.children.length;m++){var T=t.children[m],E=MultiOperatorComponentHelper.extractPlusMinusAlgebraicChildrenFromChild(T),y=T.type==p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT;if(c.length==E.length){for(var d=!0,C=0;C<c.length;C++){var _=c[C],O=E[C],g=!1,v=!1;if(h&&(g=a.getChildOperationType(_)),y&&(v=T.getChildOperationType(O)),g!=v){d=!1;break}if(0!=r(_,O)){d=!1;break}}if(1==d){var P=1==t.getChildOperationType(a)?-1:1,S=1==t.getChildOperationType(T)?-1:1;h&&(P*=MultiOperatorComponentHelper.extractNumericChildsValueFromMultiOperatorComponent(a)),y&&(S*=MultiOperatorComponentHelper.extractNumericChildsValueFromMultiOperatorComponent(T));var M=P+S,x=M<0;x&&(M*=-1);var b=M<1&&0!=M;b&&(M=1/M);var k=new l.MultiOperatorComponent(l.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE);if(k.addChild(new u.NumberComponent(M),b),h){for(var N=0;N<c.length;N++){var A=c[N];k.addChild(A,a.getChildOperationType(A))}a.removeAllChildren()}else k.addChild(c[0],!1);t.removeChild(a),t.removeChild(T),t.addChild(k,x,i),i--,o=!0;break}}}}return o&&(t.compiled=!1),o}},{key:"extractPlusMinusAlgebraicChildrenFromChild",value:function extractPlusMinusAlgebraicChildrenFromChild(t){var r=[];if((t.type==p.ExpressionTreeTypes.TYPE_MATH_ENTITY_COMPONENT||t.type==p.ExpressionTreeTypes.TYPE_MATH_FUNCTION_COMPONENT||t.type==p.ExpressionTreeTypes.TYPE_SUBSCRIPT_SUPERSCRIPT_COMPONENT||t.type==p.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT&&t.base&&t.base.type==p.ExpressionTreeTypes.TYPE_MATH_ENTITY_COMPONENT)&&r.push(t),t.type==p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&t.subtype==l.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE)for(var o=t.getAllChildren(),i=0;i<o.length;i++){var a=o[i];a.type!=p.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT&&r.push(a)}return r}},{key:"extractAlgebraicChildrenFromMultiplyDivideComponent",value:function extractAlgebraicChildrenFromMultiplyDivideComponent(t){for(var r=[],o=t.getAllChildren(),i=0;i<o.length;i++){var a=o[i];if((a.type==p.ExpressionTreeTypes.TYPE_MATH_ENTITY_COMPONENT||a.type==p.ExpressionTreeTypes.TYPE_MATH_FUNCTION_COMPONENT||a.type==p.ExpressionTreeTypes.TYPE_SUBSCRIPT_SUPERSCRIPT_COMPONENT||a.type==p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&a.subtype==l.MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT)&&r.push(a),a.type==p.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT){var u=a.exponent,c=a.base;null!=c&&null!=u&&u.type==p.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT&&(c.type==p.ExpressionTreeTypes.TYPE_MATH_ENTITY_COMPONENT||c.type==p.ExpressionTreeTypes.TYPE_MATH_FUNCTION_COMPONENT||c.type==p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&c.subtype==l.MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT)&&r.push(c)}}return r}},{key:"extractNumericChildFromMultiOperatorComponent",value:function extractNumericChildFromMultiOperatorComponent(t){for(var r=t.getAllChildren(),o=0;o<r.length;o++){var i=r[o];if(i.type==p.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT)return i}return null}},{key:"extractNumericChildsValueFromMultiOperatorComponent",value:function extractNumericChildsValueFromMultiOperatorComponent(t){var r=MultiOperatorComponentHelper.extractNumericChildFromMultiOperatorComponent(t);return null==r?l.MultiOperatorComponent.generateDefaultValueForOperation(t.subtype):1==t.getChildOperationType(r)?l.MultiOperatorComponent.generateInvertedValueForOperation(r.value,t.subtype):r.value}},{key:"identifyNumericDivisionFactorInPlusMinusComponent",value:function identifyNumericDivisionFactorInPlusMinusComponent(t,r){for(var o=[],a=!1,c=0;c<t.children.length;c++){var h=t.children[c];if(h.type==p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&h.subtype==l.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE){var m=MultiOperatorComponentHelper.extractNumericChildFromMultiOperatorComponent(h);if(null!=m&&1==h.getChildOperationType(m)){var T=m.value;1!=T&&(T%1!=0&&(a=!0),o.push(T))}}}if(0==o.length)return 1;for(var E,y=E=a?i.findCommonDecimalFactor(o):i.findHighestCommonWholeNumberFactor(o),d=0;d<o.length;d++)y*=o[d]/E;if(r)for(var C=0;C<t.numberOfChildren;C++){var _=t.children[C],O=new u.NumberComponent(y);if(_.type==p.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT)O.value=_.value*y,t.replaceChild(_,O);else if(_.type==p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&_.subtype==l.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE)_.addChild(O,!1);else{var g=new l.MultiOperatorComponent(l.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE);g.addChild(O,!1),g.addChild(_,!1),t.replaceChild(_,g)}}return y}},{key:"identifyCommonNumericMultiplicationFactorInPlusMinusComponent",value:function identifyCommonNumericMultiplicationFactorInPlusMinusComponent(t,r){for(var o,a=!0,c=[],h=!1,m=0;m<t.children.length;m++){var T=t.children[m],E=void 0;if(T.type==p.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT)E=T.value;else{if(T.type!=p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT||T.subtype!=l.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE){a=!1;break}var y=MultiOperatorComponentHelper.extractNumericChildFromMultiOperatorComponent(T);if(null==y||1==T.getChildOperationType(o)){a=!1;break}E=y.value}if(!(E>1)){a=!1;break}c.push(E),E%1!=0&&(h=!0)}if(0==a)return 1;var d;if(d=h?i.findCommonDecimalFactor(c):i.findHighestCommonWholeNumberFactor(c),r&&1!=d)for(var C=0;C<t.numberOfChildren;C++){var _=t.children[C],O=c[C]/d,g=new u.NumberComponent(O,"");_.type==p.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT?t.replaceChild(_,g):_.type==p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&_.subtype==l.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE&&(o=MultiOperatorComponentHelper.extractNumericChildFromMultiOperatorComponent(_),_.replaceChild(o,g))}return d}},{key:"isolateCommonAlgebraicFactorsInPlusMinusComponent",value:function isolateCommonAlgebraicFactorsInPlusMinusComponent(t,r){for(var o=[],i=[],c=[],h=!0,m=0;m<t.children.length;m++){for(var T=t.children[m],E=[],y=[],d=[],C=MultiOperatorComponentHelper.extractPlusMinusAlgebraicChildrenFromChild(T),_=0;_<C.length;_++){var O=C[_],g=O,v=1,P=!1;if(O.type==p.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT){var S=O;if(!S.hasNumericExponent)continue;g=S.base,v=S.exponent.value,P=S.subtype==a.ExponentComponent.OPERATION_TYPE_ROOT}T.type==p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&1==T.getChildOperationType(O)&&(v=-v),E.push(g),y.push(v),d.push(P)}if(0==E.length)return!1;if(h)o=E,i=y,c=d;else{for(var M=0;M<o.length;M++){for(var x=o[M],b=i[M],k=c[M],N=!1,A=0;A<E.length;A++)if(k==d[A]&&0==r(x,E[A])){var R=y[A];if(b>0&&R>0){i[M]=Math.min(b,R),N=!0;break}if(b<0&&R<0){i[M]=Math.max(b,R),N=!0;break}}N||(o.splice(M,1),i.splice(M,1),c.splice(M,1),M--)}if(0==o.length)return!1}h=!1}for(var I=o.length-1;I>=0;I-=1)for(var w=0;w<I;w+=1)if(i[I]==i[w]&&c[I]==c[w]&&0==r(o[I],o[w])){o.splice(I,1),i.splice(I,1),c.splice(I,1);break}var U,Y=t.parent;U=Y.type==p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&Y.subtype==l.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE?Y:new l.MultiOperatorComponent(l.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE);for(var L=0;L<o.length;L++){var D=o[L],B=i[L],H=B<0,W=Math.abs(B),j=c[L];if(j){var G=new a.ExponentComponent(D.clone(),new u.NumberComponent(W),a.ExponentComponent.OPERATION_TYPE_ROOT);U.addChild(G,H)}else if(W>1){var q=new a.ExponentComponent(D.clone(),new u.NumberComponent(W),a.ExponentComponent.OPERATION_TYPE_EXPONENT);U.addChild(q,H)}else{if(W<1)throw new Error("MOCH.icafipmc@764 Unexpected common power ".concat(B));U.addChild(D.clone(),H)}for(var V=t.getAllChildren(),X=V.length-1;X>=0;X-=1)if(!MultiOperatorComponentHelper.cancelFactorInPlusMinusChildComponent(V[X],D,B,j,r))throw new Error("MOCH.icafipmc@777 Unable to cancel factor in PlusMinus component")}return U!=Y&&(Y.replaceChild(t,U),U.addChild(t,!1)),!0}},{key:"cancelFactorInPlusMinusChildComponent",value:function cancelFactorInPlusMinusChildComponent(t,r,o,i,c){if(t.type==p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&t.subtype==l.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE)for(var h=t,m=h.getAllChildren(),T=0;T<m.length;T+=1){var E=m[T];if(MultiOperatorComponentHelper.cancelFactorInPlusMinusChildComponent(E,r,h.getChildOperationType(E)?-o:o,i,c))return!0}else if(t.type==p.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT){var y=t,d=y.subtype==a.ExponentComponent.OPERATION_TYPE_ROOT;if(y.hasNumericExponent&&d==i&&0==c(y.base,r)){var C=y.exponent,_=C.value-o;if(0==_)MultiOperatorComponentHelper.removeLastFactorFromMultiplyDivideComponent(t);else if(1==_)t.parent.replaceChild(t,y.base);else{var O=new u.NumberComponent(_);y.replaceChild(C,O)}return!0}}else if(1==o&&0==c(t,r))return MultiOperatorComponentHelper.removeLastFactorFromMultiplyDivideComponent(t),!0;return!1}},{key:"removeLastFactorFromMultiplyDivideComponent",value:function removeLastFactorFromMultiplyDivideComponent(t){var r=t.parent;r.type==p.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&r.subtype==l.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE&&r.numberOfChildren>1?r.removeChild(t):r.replaceChild(t,new u.NumberComponent(1))}}]),MultiOperatorComponentHelper}();r.MultiOperatorComponentHelper=c},4712:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.MultiOperatorComponentSubtypes=void 0,function(t){t[t.ADD_SUBTRACT=1]="ADD_SUBTRACT",t[t.MULTIPLY_DIVIDE=2]="MULTIPLY_DIVIDE",t[t.EXPONENT=3]="EXPONENT"}(r.MultiOperatorComponentSubtypes||(r.MultiOperatorComponentSubtypes={}))},3721:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.NumberComponent=void 0;var i=o(4783),a=o(340),p=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(NumberComponent,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(NumberComponent);function NumberComponent(t){var o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return _classCallCheck(this,NumberComponent),(o=r.call(this)).type=a.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT,o.value=t,o.originalString=i,o}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(NumberComponent,[{key:"value",get:function get(){return this._value},set:function set(t){void 0!==this._value&&t==this._value||(this._value=t,this.originalString="",this.compiled=!1)}},{key:"outputLatex",value:function outputLatex(t){return this.formatNumberForDisplay(t)}},{key:"formatNumberForDisplay",value:function formatNumberForDisplay(t){return t?t.useOriginalNumericString&&""!=this.originalString?this.originalString:t.rounding?t.rounding.roundForDisplay(this.value,t.roundingAmount):this.value.toString():this.value.toString()}},{key:"clone",value:function clone(){var t=new NumberComponent(this.value,this.originalString);return t.type=this.type,t.subtype=this.subtype,t.compiled=this.compiled,t}},{key:"compile",value:function compile(t){return this.compiled=!0,!0}}]),NumberComponent}(i.BaseExpressionTreeComponent);r.NumberComponent=p},1118:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.OrComponent=void 0;var i=o(4783),a=o(5099),p=o(340),l=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(OrComponent,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(OrComponent);function OrComponent(){var t;return function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,OrComponent),(t=r.call(this,i.BaseExpressionTreeComponent.SUBTYPE_UNKNOWN,!0)).type=p.ExpressionTreeTypes.TYPE_OR_COMPONENT,t.operatorsExtracted=!0,t}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(OrComponent,[{key:"clone",value:function clone(){var t=new OrComponent;t.type=this.type,t.subtype=this.subtype,t.childrenAreSortable=this.childrenAreSortable,t.operatorsExtracted=this.operatorsExtracted;for(var r=0;r<this.children.length;r++)t.addChild(this.children[r].clone());return t.compiled=this.compiled,t}},{key:"outputLatex",value:function outputLatex(t){var r="";if(this.children.length>0){r=this.children[0].outputLatex(t);for(var o=1;o<this.children.length;o++)r+=" , "+this.children[o].outputLatex(t)}return r}}]),OrComponent}(a.BaseGroupComponent);r.OrComponent=l},4882:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _get(t,r,o){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(t,r,o){var i=function _superPropBase(t,r){for(;!Object.prototype.hasOwnProperty.call(t,r)&&null!==(t=_getPrototypeOf(t)););return t}(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(o):a.value}})(t,r,o||t)}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.SubscriptSuperscriptComponent=void 0;var i=o(5223),a=o(4808),p=o(4783),l=o(340),u=o(7491),c=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(SubscriptSuperscriptComponent,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(SubscriptSuperscriptComponent);function SubscriptSuperscriptComponent(){var t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.BaseExpressionTreeComponent.SUBTYPE_UNKNOWN;return _classCallCheck(this,SubscriptSuperscriptComponent),(t=r.call(this)).addImplementedInterface("IParentComponent"),t.addImplementedInterface("IWrapperComponent"),t.type=l.ExpressionTreeTypes.TYPE_SUBSCRIPT_SUPERSCRIPT_COMPONENT,t.subtype=a,t.base=o,t.script=i,t}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(SubscriptSuperscriptComponent,[{key:"base",get:function get(){return this._base},set:function set(t){void 0!==this._base&&t==this._base||(this._base&&this._base.removeParentIfCurrent(this),this._base=t,this._base&&(this._base.parent=this),this.compiled=!1)}},{key:"script",get:function get(){return this._script},set:function set(t){void 0!==this._script&&t==this._script||(this._script&&this._script.removeParentIfCurrent(this),this._script=t,this._script&&(this._script.parent=this),this.compiled=!1)}},{key:"compile",value:function compile(t){for(var r=0,o=!1;!o&&r<p.BaseExpressionTreeComponent.MAX_COMPILE_ATTEMPTS;)o=!0,this.base&&(this.base.compile(t)||(o=!1)),this.script&&(this.script.compile(t)||(o=!1)),r++;return _get(_getPrototypeOf(SubscriptSuperscriptComponent.prototype),"compile",this).call(this,t)}},{key:"removeChild",value:function removeChild(t){t==this.base?(this.base=null,this.compiled=!1):t==this.script&&(this.parent.replaceChild(this,this.base),this.script=null,this.compiled=!1)}},{key:"replaceChild",value:function replaceChild(t,r){r?(t==this.base&&(this.base=r,this.compiled=!1),t==this.script&&(this.script=r,this.compiled=!1)):this.removeChild(t)}},{key:"allChildrenAreCompiled",get:function get(){return!(this.base&&!this.base.compiled||this.script&&!this.script.compiled)}},{key:"outputLatex",value:function outputLatex(t){var r="";if(!this.base||!this.script)return"";var o=this.base.outputLatex(t),i=this.script.outputLatex(t),p=!1;switch(this.subtype){case SubscriptSuperscriptComponent.NOTATION_TYPE_SUBSCRIPT:this.base.type!=l.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&this.base.type!=l.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT||(p=!0),this.base.type!=l.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT||this.base.subtype!=u.UnaryOperatorComponentSubtypes.MINUS&&this.base.subtype!=u.UnaryOperatorComponentSubtypes.PLUS_MINUS||(p=!0),p&&!a.LatexUtil.isBoundedByRoundBrackets(o)&&(o=a.LatexUtil.addBracketsAroundLatex(o)),r="".concat(o,"_{").concat(i,"}");break;case SubscriptSuperscriptComponent.NOTATION_TYPE_SUPERSCRIPT:this.base.type!=l.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&this.base.type!=l.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT||(p=!0),this.base.type!=l.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT||this.base.subtype!=u.UnaryOperatorComponentSubtypes.MINUS&&this.base.subtype!=u.UnaryOperatorComponentSubtypes.PLUS_MINUS||(p=!0),p&&!a.LatexUtil.isBoundedByRoundBrackets(o)&&(o=a.LatexUtil.addBracketsAroundLatex(o)),r="".concat(o,"^{").concat(i,"}")}return r}},{key:"removeAllChildren",value:function removeAllChildren(){this.base=null,this.script=null}},{key:"numberOfChildren",get:function get(){var t=0;return null!=this.base&&t++,null!=this.script&&t++,t}},{key:"getAllChildren",value:function getAllChildren(){var t=[];return null!=this.base&&t.push(this.base),null!=this.script&&t.push(this.script),t}},{key:"clone",value:function clone(){var t=new SubscriptSuperscriptComponent;return t.type=this.type,t.subtype=this.subtype,null!=this.base&&(t.base=this.base.clone()),null!=this.script&&(t.script=this.script.clone()),t.compiled=this.compiled,t}},{key:"treatAsMathEntity",value:function treatAsMathEntity(){return!0}},{key:"getBaseComponent",value:function getBaseComponent(){return this.base.implementsInterface("IWrapperComponent")?this.base.getBaseComponent():this.base}},{key:"getRelativeImportanceOfChildren",value:function getRelativeImportanceOfChildren(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=[];if(null!=this.base&&o.push({component:this.base,value:.75*r}),null!=this.script&&o.push({component:this.base,value:.25*r}),t&&o.length>0){var i,a=[],p=_createForOfIteratorHelper(o);try{for(p.s();!(i=p.n()).done;){var l=i.value;if(l.component.implementsInterface("IParentComponent")){var u=l.component.getRelativeImportanceOfChildren(t,l.value);u.length>0&&(a=a.concat(u))}}}catch(t){p.e(t)}finally{p.f()}a.length>0&&(o=o.concat(a))}return o}}]),SubscriptSuperscriptComponent}(p.BaseExpressionTreeComponent);r.SubscriptSuperscriptComponent=c,c.NOTATION_TYPE_SUBSCRIPT=i.ExpressionTokenTemplate.SUBTYPE_SUBSCRIPT,c.NOTATION_TYPE_SUPERSCRIPT=i.ExpressionTokenTemplate.SUBTYPE_SUPERSCRIPT},9781:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.TextComponent=void 0;var i=o(4783),a=o(340),p=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(TextComponent,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(TextComponent);function TextComponent(t){var o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return _classCallCheck(this,TextComponent),(o=r.call(this)).type=a.ExpressionTreeTypes.TYPE_TEXT_COMPONENT,o.value=t,o.originalString=i,o}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(TextComponent,[{key:"value",get:function get(){return this._value},set:function set(t){void 0!==this._value&&t==this._value||(this._value=t,this.originalString="",this.compiled=!1)}},{key:"outputLatex",value:function outputLatex(t){return"\\text{".concat(this.value,"}")}},{key:"clone",value:function clone(){var t=new TextComponent(this.value,this.originalString);return t.type=this.type,t.subtype=this.subtype,t.compiled=this.compiled,t}},{key:"compile",value:function compile(t){return this.compiled=!0,!0}}]),TextComponent}(i.BaseExpressionTreeComponent);r.TextComponent=p},1997:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.UnaryOperatorComponent=void 0;var i=o(4808),a=o(3648),p=o(4783),l=o(340),u=o(8818),c=o(9837),h=o(4712),m=o(7491),T=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(UnaryOperatorComponent,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(UnaryOperatorComponent);function UnaryOperatorComponent(){var t,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.BaseExpressionTreeComponent.SUBTYPE_UNKNOWN,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(_classCallCheck(this,UnaryOperatorComponent),(t=r.call(this,o,i.toString())).addImplementedInterface("IUnaryOperatorComponent"),t.type=l.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT,t.rightUnaryOperator=a,t.subtype=i,a)switch(t.subtype){case m.UnaryOperatorComponentSubtypes.MINUS:t.subtype=m.UnaryOperatorComponentSubtypes.TRAILING_MINUS;break;case m.UnaryOperatorComponentSubtypes.PLUS:t.subtype=m.UnaryOperatorComponentSubtypes.TRAILING_PLUS}return t}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(UnaryOperatorComponent,[{key:"outputLatex",value:function outputLatex(t){var r="";if(this.child){r=this.child.outputLatex(t);var o=!1;this.child instanceof c.MultiOperatorComponent&&(this.child.subtype!=h.MultiOperatorComponentSubtypes.MULTIPLY_DIVIDE||0!=this.child.numberOfChildrenWithOperatorType(!0)||this.subtype!=m.UnaryOperatorComponentSubtypes.PLUS_MINUS&&this.subtype!=m.UnaryOperatorComponentSubtypes.PLUS&&this.subtype!=m.UnaryOperatorComponentSubtypes.MINUS)&&(o=!0),o&&!i.LatexUtil.isBoundedByRoundBrackets(r)&&(r=i.LatexUtil.addBracketsAroundLatex(r))}var a="";switch(this.subtype){case m.UnaryOperatorComponentSubtypes.FACTORIAL:a="!";break;case m.UnaryOperatorComponentSubtypes.TRAILING_MINUS:case m.UnaryOperatorComponentSubtypes.MINUS:a="-";break;case m.UnaryOperatorComponentSubtypes.TRAILING_PLUS:case m.UnaryOperatorComponentSubtypes.PLUS:a="+";break;case m.UnaryOperatorComponentSubtypes.PLUS_MINUS:a="\\pm "}return this.rightUnaryOperator?r+a:a+r}},{key:"clone",value:function clone(){var t=new UnaryOperatorComponent;return t.type=this.type,t.subtype=this.subtype,t.child=this.child.clone(),t.compiled=this.compiled,t.rightUnaryOperator=this.rightUnaryOperator,t}},{key:"evaluateIfNumeric",value:function evaluateIfNumeric(){if(this.child.type!=l.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT)return NaN;var t=this.child.value;switch(this.subtype){case m.UnaryOperatorComponentSubtypes.PLUS:return t;case m.UnaryOperatorComponentSubtypes.MINUS:return-1*t;case m.UnaryOperatorComponentSubtypes.FACTORIAL:return a.factorial(t);case m.UnaryOperatorComponentSubtypes.PLUS_MINUS:case m.UnaryOperatorComponentSubtypes.TRAILING_MINUS:case m.UnaryOperatorComponentSubtypes.TRAILING_PLUS:default:return NaN}}},{key:"treatAsMathEntity",value:function treatAsMathEntity(){switch(this.subtype){case m.UnaryOperatorComponentSubtypes.TRAILING_MINUS:case m.UnaryOperatorComponentSubtypes.TRAILING_PLUS:case m.UnaryOperatorComponentSubtypes.PLUS_MINUS:return!1;case m.UnaryOperatorComponentSubtypes.FACTORIAL:case m.UnaryOperatorComponentSubtypes.MINUS:case m.UnaryOperatorComponentSubtypes.PLUS:if(this.child instanceof p.BaseExpressionTreeComponent)return this.child.treatAsMathEntity()}return!1}}]),UnaryOperatorComponent}(u.MathFunctionComponent);r.UnaryOperatorComponent=T},7491:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.UnaryOperatorComponentSubtypes=void 0,function(t){t[t.FACTORIAL=28]="FACTORIAL",t[t.MINUS=2]="MINUS",t[t.PLUS=1]="PLUS",t[t.PLUS_MINUS=32]="PLUS_MINUS",t[t.TRAILING_MINUS=1002]="TRAILING_MINUS",t[t.TRAILING_PLUS=1001]="TRAILING_PLUS"}(r.UnaryOperatorComponentSubtypes||(r.UnaryOperatorComponentSubtypes={}))},7278:(t,r,o)=>{Object.defineProperty(r,"__esModule",{value:!0});var i=o(4780);i.__exportStar(o(2792),r),i.__exportStar(o(9521),r),i.__exportStar(o(3733),r),i.__exportStar(o(7730),r),i.__exportStar(o(7964),r),i.__exportStar(o(3033),r),i.__exportStar(o(4493),r),i.__exportStar(o(2687),r),i.__exportStar(o(3210),r),i.__exportStar(o(6415),r),i.__exportStar(o(8447),r),i.__exportStar(o(7722),r),i.__exportStar(o(8373),r),i.__exportStar(o(907),r),i.__exportStar(o(9536),r),i.__exportStar(o(9336),r),i.__exportStar(o(3892),r),i.__exportStar(o(340),r),i.__exportStar(o(5099),r),i.__exportStar(o(4100),r),i.__exportStar(o(4808),r),i.__exportStar(o(3648),r),i.__exportStar(o(9849),r),i.__exportStar(o(7547),r),i.__exportStar(o(7076),r),i.__exportStar(o(803),r),i.__exportStar(o(7137),r),i.__exportStar(o(1230),r),i.__exportStar(o(4860),r),i.__exportStar(o(3597),r),i.__exportStar(o(8629),r),i.__exportStar(o(9197),r),i.__exportStar(o(1964),r)},3733:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.KatexFacade=void 0;var a=o(4780),p=o(4774),l=a.__importStar(o(974)),u=o(7730),c=function(){function KatexFacade(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,KatexFacade)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(KatexFacade,null,[{key:"requireKatex",value:function requireKatex(){this.katexLoaded||(p.LazyScriptLoader.loadCSS(p.URLUtil.assetDomainRedirect("https://www.educationperfect.com/libs/katex/0.11.0/katex.min.css")).then((function(){var t=i('<span class="katex"><span class="mord mathbf"></span></span>').appendTo(i(document.body));setTimeout((function(){t.remove()}),50)})),this.katexLoaded=!0)}},{key:"typeset",value:function typeset(t,r){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.requireKatex();try{return void l.render(t,r,{displayMode:!0})}catch(t){console.error(t)}if(o){var i=document.createElement("script");i.setAttribute("type","math/tex"),i.textContent=t,r.appendChild(i),u.MathJaxFacade.typeset(i)}}},{key:"typesetToString",value:function typesetToString(t){this.requireKatex();try{return l.renderToString(t)}catch(t){console.error(t)}return""}}]),KatexFacade}();r.KatexFacade=c,c.katexLoaded=!1},6594:(t,r,o)=>{function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.ExpressionToken=void 0;var i=o(3728),a=o(4808),p=function(){function ExpressionToken(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";_classCallCheck(this,ExpressionToken),this.id=i.GuidUtilMath.create(),this.interfaces="|IExpressionToken|IExpressionTreeComponent|",this.parent=null,this.compiled=!1,this.type=t,this.subtype=r,this.originalString=o}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(ExpressionToken,[{key:"setCompiled",value:function setCompiled(t){this.compiled=t}},{key:"isCompiled",value:function isCompiled(){return this.compiled}},{key:"compile",value:function compile(t){return this.compiled=!0,!0}},{key:"removeParentIfCurrent",value:function removeParentIfCurrent(t){this.parent==t&&(this.parent=null)}},{key:"isEquivalent",value:function isEquivalent(t){return t instanceof ExpressionToken&&t.originalString==this.originalString}},{key:"sortCompare",value:function sortCompare(t){return 0}},{key:"allChildrenAreCompiled",get:function get(){return!0}},{key:"outputLatex",value:function outputLatex(t){var r=a.LatexUtil.replaceSpecialCharactersWithLatexCodes(this.originalString);return"\\"==r.charAt(0)||"^"==r.charAt(0)?r:"\\expression{".concat(r,"}")}},{key:"clone",value:function clone(){var t=new ExpressionToken(this.type,this.subtype,this.originalString);return t.compiled=this.compiled,t}},{key:"implementsInterface",value:function implementsInterface(t){return this.interfaces.indexOf(t)>-1}},{key:"addImplementedInterface",value:function addImplementedInterface(t){""==this.interfaces||null==this.interfaces?this.interfaces="|".concat(t,"|"):this.interfaces+="".concat(t,"|")}}]),ExpressionToken}();r.ExpressionToken=p},5223:(t,r)=>{function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.ExpressionTokenTemplate=void 0;var o=function ExpressionTokenTemplate(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ExpressionTokenTemplate.UNDEFINED,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ExpressionTokenTemplate.UNDEFINED,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";return _classCallCheck(t,ExpressionTokenTemplate),t.type=r,t.subtype=o,t.matchExpression=i,t.matchString=a,void(t.firstLetterMatchCharacters=p)};r.ExpressionTokenTemplate=o,o.UNDEFINED=0,o.TYPE_NUMERICAL_VALUE=1,o.TYPE_BINARY_VALUE=2,o.TYPE_OBJECT=3,o.TYPE_TEXT=4,o.TYPE_TEXT_NOS=5,o.TYPE_KEYWORD=6,o.TYPE_FUNCTION=7,o.TYPE_WHITESPACE=9,o.TYPE_END_OF_STATEMENT=10,o.TYPE_DOT=11,o.TYPE_COLON=12,o.TYPE_COMMA=13,o.TYPE_NULL=14,o.TYPE_UNDERSCORE=16,o.TYPE_MATH_ENTITY=21,o.TYPE_COMPARITOR=15,o.TYPE_ARROW=17,o.TYPE_OPERAND=20,o.TYPE_OPERATOR=25,o.TYPE_UNARY_OPERATOR=26,o.TYPE_ASSIGNMENT_OPERATOR=30,o.TYPE_LOGICAL_OPERATOR=32,o.TYPE_NOTATION=33,o.TYPE_BRACE_OPEN=35,o.TYPE_BRACE_CLOSE=40,o.TYPE_BRACE_EMPTY=41,o.TYPE_BRACE_UNKNOWN=42,o.TYPE_LATEX_COMMAND=50,o.BRACE_TYPE_CURLY=1,o.BRACE_TYPE_SQUARE=2,o.BRACE_TYPE_ROUND=3,o.BRACE_TYPE_PIPES=4,o.SUBTYPE_EQUAL_TO=1,o.SUBTYPE_NOT_EQUAL_TO=3,o.SUBTYPE_GREATER_THAN=5,o.SUBTYPE_GREATER_THAN_EQUAL_TO=6,o.SUBTYPE_LESS_THAN=7,o.SUBTYPE_LESS_THAN_EQUAL_TO=8,o.SUBTYPE_RIGHT=1,o.SUBTYPE_LEFT=3,o.SUBTYPE_RIGHT_LEFT=5,o.SUBTYPE_PLUS=1,o.SUBTYPE_MINUS=2,o.SUBTYPE_DIVIDE=3,o.SUBTYPE_MULTIPLY=4,o.SUBTYPE_POWER=5,o.SUBTYPE_MODULO=6,o.SUBTYPE_EQUALS=7,o.SUBTYPE_FACTORIAL=28,o.SUBTYPE_ROOT=30,o.SUBTYPE_PLUS_MINUS=32,o.SUBTYPE_SUBSCRIPT=1,o.SUBTYPE_SUPERSCRIPT=2,o.SUBTYPE_LOGIC_FLOW_OR=1},1891:(t,r,o)=>{function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.LatexLexer=void 0;var i=o(3033),a=o(6815),p=o(6594),l=o(5223),u=o(597),c=o(7193),h=function(){function LatexLexer(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,LatexLexer),this.stringReplacements=[],this.expressionTemplates=[],this.firstCharacterMatchDict={},this.latexOperatorDict={},this.latexExpressionTokenDict={},this.stringReplacements.push(new u.StringReplacement(/(?:\^\\circ ?|\^{\\circ ?}|[\u00B0\u00BA\u02DA\u1D52\u2070\u309C])/g,"°")),this.stringReplacements.push(new u.StringReplacement(/[`‘’′]/g,"'")),this.stringReplacements.push(new u.StringReplacement(/(^|[^A-Za-z])Log(?![A-Za-z])/g,"$1\\log")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_KEYWORD,l.ExpressionTokenTemplate.SUBTYPE_LOGIC_FLOW_OR,/or(?![a-zA-Z_])/,"","o")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_TEXT_NOS,l.ExpressionTokenTemplate.UNDEFINED,/[a-zA-Z][a-zA-Z]*/,"",LatexLexer.Alphabet)),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_WHITESPACE,l.ExpressionTokenTemplate.UNDEFINED,/[\s\r\n]*/im,""," \n\rs")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_NUMERICAL_VALUE,l.ExpressionTokenTemplate.UNDEFINED,/[0-9]*\.?[0-9]+/,"",LatexLexer.Numbers)),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_EQUAL_TO,null,"=","=")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_GREATER_THAN,null,">",">")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_GREATER_THAN_EQUAL_TO,null,">=",">")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_LESS_THAN,null,"<","<")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_LESS_THAN_EQUAL_TO,null,"<=","<")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_NOT_EQUAL_TO,null,"!=","!")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_NOT_EQUAL_TO,null,"≠","≠")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_PLUS,null,"+","+")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_MINUS,null,"-","-")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_MINUS,null,"‒","‒")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_MINUS,null,"–","–")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_MINUS,null,"−","−")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_MINUS,null,"—","—")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_MULTIPLY,null,"*","*")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_MULTIPLY,null,"×","×")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_DIVIDE,null,"/","/")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_DIVIDE,null,"÷","÷")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_POWER,null,"^","^")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_UNARY_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_FACTORIAL,null,"!","!")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_KEYWORD,l.ExpressionTokenTemplate.SUBTYPE_LOGIC_FLOW_OR,null,",",",")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_KEYWORD,l.ExpressionTokenTemplate.SUBTYPE_LOGIC_FLOW_OR,null,"，","，")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_OPEN,l.ExpressionTokenTemplate.BRACE_TYPE_CURLY,null,"{","{")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_OPEN,l.ExpressionTokenTemplate.BRACE_TYPE_CURLY,null,"\\{","\\")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_CLOSE,l.ExpressionTokenTemplate.BRACE_TYPE_CURLY,null,"}","}")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_CLOSE,l.ExpressionTokenTemplate.BRACE_TYPE_CURLY,null,"\\}","\\")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_EMPTY,l.ExpressionTokenTemplate.BRACE_TYPE_CURLY,null,"{}","{")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_OPEN,l.ExpressionTokenTemplate.BRACE_TYPE_SQUARE,null,"[","[")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_OPEN,l.ExpressionTokenTemplate.BRACE_TYPE_SQUARE,null,"\\[","\\")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_CLOSE,l.ExpressionTokenTemplate.BRACE_TYPE_SQUARE,null,"]","]")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_CLOSE,l.ExpressionTokenTemplate.BRACE_TYPE_SQUARE,null,"\\]","\\")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_EMPTY,l.ExpressionTokenTemplate.BRACE_TYPE_SQUARE,null,"[]","[")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_OPEN,l.ExpressionTokenTemplate.BRACE_TYPE_ROUND,null,"(","(")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_OPEN,l.ExpressionTokenTemplate.BRACE_TYPE_ROUND,null,"\\(","\\")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_OPEN,l.ExpressionTokenTemplate.BRACE_TYPE_ROUND,null,"（","（")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_CLOSE,l.ExpressionTokenTemplate.BRACE_TYPE_ROUND,null,")",")")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_CLOSE,l.ExpressionTokenTemplate.BRACE_TYPE_ROUND,null,"\\)","\\")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_CLOSE,l.ExpressionTokenTemplate.BRACE_TYPE_ROUND,null,"）","）")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_EMPTY,l.ExpressionTokenTemplate.BRACE_TYPE_ROUND,null,"()","(")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_EMPTY,l.ExpressionTokenTemplate.BRACE_TYPE_ROUND,null,"（）","（")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_UNKNOWN,l.ExpressionTokenTemplate.BRACE_TYPE_PIPES,null,"|","|")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_BRACE_UNKNOWN,l.ExpressionTokenTemplate.BRACE_TYPE_PIPES,null,"∣","∣")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_NOTATION,l.ExpressionTokenTemplate.SUBTYPE_SUBSCRIPT,null,"_","_")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT,null,"→","→")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_LEFT,null,"←","←")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT_LEFT,null,"⇋","⇋")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT_LEFT,null,"⇌","⇌")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_LATEX_COMMAND,l.ExpressionTokenTemplate.UNDEFINED,null,"∞","∞")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_LATEX_COMMAND,l.ExpressionTokenTemplate.UNDEFINED,null,"∩","∩")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_LATEX_COMMAND,l.ExpressionTokenTemplate.UNDEFINED,null,"∪","∪")),this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_TEXT_NOS,l.ExpressionTokenTemplate.UNDEFINED,null,"°","°"));var t,r=_createForOfIteratorHelper(LatexLexer.GreekCharacters.split(""));try{for(r.s();!(t=r.n()).done;){var o=t.value;this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_TEXT_NOS,l.ExpressionTokenTemplate.UNDEFINED,null,o,o))}}catch(t){r.e(t)}finally{r.f()}var i,c=_createForOfIteratorHelper(LatexLexer.DifferentiationCharacters.split(""));try{for(c.s();!(i=c.n()).done;){var h=i.value;this.expressionTemplates.push(new l.ExpressionTokenTemplate(l.ExpressionTokenTemplate.TYPE_TEXT_NOS,l.ExpressionTokenTemplate.UNDEFINED,null,h,h))}}catch(t){c.e(t)}finally{c.f()}this.buildFirstLetterMatchDict();var m,T=_createForOfIteratorHelper(a.MathFunctionsAndConstants.Instance.DefaultMathConstants);try{for(T.s();!(m=T.n()).done;){var E=m.value;this.latexExpressionTokenDict[E.matchString]=E.templateComponent}}catch(t){T.e(t)}finally{T.f()}this.latexExpressionTokenDict.cdot=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_MULTIPLY,"*"),this.latexExpressionTokenDict.sdot=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_MULTIPLY,"*"),this.latexExpressionTokenDict.times=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_MULTIPLY,"*"),this.latexExpressionTokenDict.div=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_DIVIDE,"÷"),this.latexExpressionTokenDict.leftarrow=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_LEFT,"←"),this.latexExpressionTokenDict.Leftarrow=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_LEFT,"←"),this.latexExpressionTokenDict.longleftarrow=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_LEFT,"←"),this.latexExpressionTokenDict.Longleftarrow=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_LEFT,"←"),this.latexExpressionTokenDict.leftharpoondown=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_LEFT,"←"),this.latexExpressionTokenDict.leftharpoonup=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_LEFT,"←"),this.latexExpressionTokenDict.rightarrow=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT,"→"),this.latexExpressionTokenDict.Rightarrow=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT,"→"),this.latexExpressionTokenDict.longrightarrow=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT,"→"),this.latexExpressionTokenDict.Longrightarrow=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT,"→"),this.latexExpressionTokenDict.to=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT,"→"),this.latexExpressionTokenDict.rightharpoonup=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT,"→"),this.latexExpressionTokenDict.rightharpoondown=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT,"→"),this.latexExpressionTokenDict.rightleftharpoons=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT_LEFT,"⇌"),this.latexExpressionTokenDict.leftrightharpoons=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT_LEFT,"⇌"),this.latexExpressionTokenDict.leftrightarrow=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT_LEFT,"⇌"),this.latexExpressionTokenDict.longleftrightarrow=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_ARROW,l.ExpressionTokenTemplate.SUBTYPE_RIGHT_LEFT,"⇌"),this.latexExpressionTokenDict.geq=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_GREATER_THAN_EQUAL_TO,">="),this.latexExpressionTokenDict.ge=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_GREATER_THAN_EQUAL_TO,">="),this.latexExpressionTokenDict.leq=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_LESS_THAN_EQUAL_TO,"<="),this.latexExpressionTokenDict.le=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_LESS_THAN_EQUAL_TO,"<="),this.latexExpressionTokenDict.neq=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_NOT_EQUAL_TO,"≠"),this.latexExpressionTokenDict.ne=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_COMPARITOR,l.ExpressionTokenTemplate.SUBTYPE_NOT_EQUAL_TO,"≠"),this.latexExpressionTokenDict.pm=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_OPERATOR,l.ExpressionTokenTemplate.SUBTYPE_PLUS_MINUS,"+-"),this.latexExpressionTokenDict.infty=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_LATEX_COMMAND,l.ExpressionTokenTemplate.UNDEFINED,"∞"),this.latexExpressionTokenDict.cap=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_LATEX_COMMAND,l.ExpressionTokenTemplate.UNDEFINED,"∩"),this.latexExpressionTokenDict.cup=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_LATEX_COMMAND,l.ExpressionTokenTemplate.UNDEFINED,"∪"),this.latexExpressionTokenDict.bigcap=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_LATEX_COMMAND,l.ExpressionTokenTemplate.UNDEFINED,"∩"),this.latexExpressionTokenDict.bigcup=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_LATEX_COMMAND,l.ExpressionTokenTemplate.UNDEFINED,"∪"),this.latexExpressionTokenDict["%"]=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_TEXT_NOS,l.ExpressionTokenTemplate.UNDEFINED,"%"),this.latexExpressionTokenDict.$=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_TEXT_NOS,l.ExpressionTokenTemplate.UNDEFINED,"$"),this.latexExpressionTokenDict.degree=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_TEXT_NOS,l.ExpressionTokenTemplate.UNDEFINED,"°"),this.latexExpressionTokenDict.angle=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_TEXT_NOS,l.ExpressionTokenTemplate.UNDEFINED,"∠"),this.latexExpressionTokenDict.pi=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_TEXT_NOS,l.ExpressionTokenTemplate.UNDEFINED,"π"),this.latexExpressionTokenDict.vert=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_BRACE_UNKNOWN,l.ExpressionTokenTemplate.BRACE_TYPE_PIPES,"|"),this.latexExpressionTokenDict.mid=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_BRACE_UNKNOWN,l.ExpressionTokenTemplate.BRACE_TYPE_PIPES,"|")}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(LatexLexer,[{key:"buildFirstLetterMatchDict",value:function buildFirstLetterMatchDict(){this.firstCharacterMatchDict={};var t,r=_createForOfIteratorHelper(this.expressionTemplates);try{for(r.s();!(t=r.n()).done;){var o,i=t.value,a=_createForOfIteratorHelper(i.firstLetterMatchCharacters.split(""));try{for(a.s();!(o=a.n()).done;){var p=o.value;null==this.firstCharacterMatchDict[p]?this.firstCharacterMatchDict[p]=[i]:this.firstCharacterMatchDict[p].push(i)}}catch(t){a.e(t)}finally{a.f()}}}catch(t){r.e(t)}finally{r.f()}}},{key:"scanInput",value:function scanInput(t){var r,o=[],a=_createForOfIteratorHelper(this.stringReplacements);try{for(a.s();!(r=a.n()).done;){var u=r.value;t=t.replace(u.matchExpression,u.replacement)}}catch(t){a.e(t)}finally{a.f()}for(var h=0,m=t.length,T="";h<m;){var E=t.charAt(h),y=t.substring(h);if("^"==T||"_"==T){if(-1!=LatexLexer.Alphabet.indexOf(E)){var d=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_TEXT_NOS,l.ExpressionTokenTemplate.UNDEFINED,E);o.push(d),h++,T=E;continue}if(-1!=LatexLexer.Numbers.indexOf(E)){var C=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_NUMERICAL_VALUE,l.ExpressionTokenTemplate.UNDEFINED,E);o.push(C),h++,T=E;continue}}if("\\"!=E){var _=-1;if(null!=this.firstCharacterMatchDict[E]){var O,g="",v=0,P=null,S=_createForOfIteratorHelper(this.firstCharacterMatchDict[E]);try{for(S.s();!(O=S.n()).done;){var M=O.value,x="",b=0;if(null==M.matchExpression)(b=(x=M.matchString).length)>v&&y.substr(0,b)==M.matchString&&(g=x,v=b,P=M);else{var k=M.matchExpression.exec(y);null!=k&&0==k.index&&(b=(x=k[0]).length)>v&&(g=x,v=b,P=M)}}}catch(t){S.e(t)}finally{S.f()}if(v>0){_=v;var N=P.type;if(N!=l.ExpressionTokenTemplate.TYPE_WHITESPACE){var A=new p.ExpressionToken(N,P.subtype,g);o.push(A),T=g}h+=_;continue}}if(-1==_){var R=null;o.length>0&&((R=o[o.length-1]).type==l.ExpressionTokenTemplate.UNDEFINED?R.originalString+=E:R=null),null==R?(R=new p.ExpressionToken(l.ExpressionTokenTemplate.UNDEFINED,l.ExpressionTokenTemplate.UNDEFINED,E),o.push(R),T=E):T="",h++}}else{if(y.length>1){var I=y.match(/^\\[a-zA-Z][a-zA-Z]*/),w=null!=I?I[0]:y.substr(0,2),U=w.substr(1);if(" "==U);else if("\\"==U);else if(this.latexExpressionTokenDict[U]){var Y=this.latexExpressionTokenDict[U];o.push(Y.clone())}else{var L=new p.ExpressionToken(l.ExpressionTokenTemplate.TYPE_LATEX_COMMAND,l.ExpressionTokenTemplate.UNDEFINED,U);o.push(L)}h+=w.length,T=w;continue}h++}}if(o.length>0){var D=o[o.length-1];D.type==l.ExpressionTokenTemplate.UNDEFINED&&D.implementsInterface("IExpressionToken")&&"."==D.originalString&&o.pop()}return new c.TokenStream(o,i.FormulaFormats.LATEX)}}],[{key:"copyTokenStream",value:function copyTokenStream(t){var r,o=[],i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;o.push(new p.ExpressionToken(a.type,a.subtype,a.originalString))}}catch(t){i.e(t)}finally{i.f()}return o}}]),LatexLexer}();r.LatexLexer=h,h.Alphabet="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",h.GreekCharacters="ΔΘӨΛΞΠΦΨΩαβγδεζηθөικλξπρςστυφχψω∆",h.DifferentiationCharacters="'",h.Numbers="1234567890."},2687:(t,r,o)=>{function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MathLexer=void 0;var i=o(3033),a=o(6594),p=o(5223),l=o(7193),u=function(){function MathLexer(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MathLexer),this.expressionTemplates=[],this.firstCharacterMatchDict={},this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_KEYWORD,p.ExpressionTokenTemplate.SUBTYPE_LOGIC_FLOW_OR,/or(?![a-zA-Z_])/,"","o")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_TEXT_NOS,p.ExpressionTokenTemplate.UNDEFINED,/^(?!(xx|sqrt))[a-zA-Z][a-zA-Z]*/,"",MathLexer.Alphabet)),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_WHITESPACE,p.ExpressionTokenTemplate.UNDEFINED,/[\s\r\n]*/im,""," \n\rs")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_TEXT,p.ExpressionTokenTemplate.TYPE_TEXT,/"/,'"','"')),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_NUMERICAL_VALUE,p.ExpressionTokenTemplate.UNDEFINED,/[0-9]*\.?[0-9]+/,"",MathLexer.Numbers)),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_COMPARITOR,p.ExpressionTokenTemplate.SUBTYPE_EQUAL_TO,null,"=","=")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_COMPARITOR,p.ExpressionTokenTemplate.SUBTYPE_GREATER_THAN,null,">",">")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_COMPARITOR,p.ExpressionTokenTemplate.SUBTYPE_GREATER_THAN_EQUAL_TO,null,">=",">")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_COMPARITOR,p.ExpressionTokenTemplate.SUBTYPE_GREATER_THAN_EQUAL_TO,null,"≥","≥")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_COMPARITOR,p.ExpressionTokenTemplate.SUBTYPE_LESS_THAN,null,"<","<")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_COMPARITOR,p.ExpressionTokenTemplate.SUBTYPE_LESS_THAN_EQUAL_TO,null,"<=","<")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_COMPARITOR,p.ExpressionTokenTemplate.SUBTYPE_LESS_THAN_EQUAL_TO,null,"≤","≤")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_COMPARITOR,p.ExpressionTokenTemplate.SUBTYPE_NOT_EQUAL_TO,null,"!=","!")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_COMPARITOR,p.ExpressionTokenTemplate.SUBTYPE_NOT_EQUAL_TO,null,"≠","≠")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_PLUS_MINUS,null,"+-","+")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_PLUS_MINUS,null,"±","±")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_PLUS,null,"+","+")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_MINUS,null,"-","-")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_MINUS,null,"‒","‒")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_MINUS,null,"–","–")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_MINUS,null,"−","−")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_MINUS,null,"—","—")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_MULTIPLY,null,"*","*")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_MULTIPLY,null,"×","×")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_MULTIPLY,null,"xx","x")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_MULTIPLY,null,"·","·")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_DIVIDE,null,"/","/")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_DIVIDE,null,"÷","÷")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_DIVIDE,null,"-:","-")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_POWER,null,"^","^")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_ROOT,null,"√","√")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_ROOT,null,"sqrt","s")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_UNARY_OPERATOR,p.ExpressionTokenTemplate.SUBTYPE_FACTORIAL,null,"!","!")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_KEYWORD,p.ExpressionTokenTemplate.SUBTYPE_LOGIC_FLOW_OR,null,",",",")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_BRACE_OPEN,p.ExpressionTokenTemplate.BRACE_TYPE_CURLY,null,"{","{")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_BRACE_CLOSE,p.ExpressionTokenTemplate.BRACE_TYPE_CURLY,null,"}","}")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_BRACE_EMPTY,p.ExpressionTokenTemplate.BRACE_TYPE_CURLY,null,"{}","{")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_BRACE_OPEN,p.ExpressionTokenTemplate.BRACE_TYPE_SQUARE,null,"[","[")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_BRACE_CLOSE,p.ExpressionTokenTemplate.BRACE_TYPE_SQUARE,null,"]","]")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_BRACE_EMPTY,p.ExpressionTokenTemplate.BRACE_TYPE_SQUARE,null,"[]","[")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_BRACE_OPEN,p.ExpressionTokenTemplate.BRACE_TYPE_ROUND,null,"(","(")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_BRACE_CLOSE,p.ExpressionTokenTemplate.BRACE_TYPE_ROUND,null,")",")")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_BRACE_EMPTY,p.ExpressionTokenTemplate.BRACE_TYPE_ROUND,null,"()","(")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_BRACE_UNKNOWN,p.ExpressionTokenTemplate.BRACE_TYPE_PIPES,null,"|","|")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_NOTATION,p.ExpressionTokenTemplate.SUBTYPE_SUBSCRIPT,null,"_","_")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_TEXT_NOS,p.ExpressionTokenTemplate.UNDEFINED,null,"%","%")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_TEXT_NOS,p.ExpressionTokenTemplate.UNDEFINED,null,"$","$")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_TEXT_NOS,p.ExpressionTokenTemplate.UNDEFINED,null,"°","°")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_TEXT_NOS,p.ExpressionTokenTemplate.UNDEFINED,null,"∠","∠")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_ARROW,p.ExpressionTokenTemplate.SUBTYPE_RIGHT,null,"→","→")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_ARROW,p.ExpressionTokenTemplate.SUBTYPE_LEFT,null,"←","←")),this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_ARROW,p.ExpressionTokenTemplate.SUBTYPE_RIGHT_LEFT,null,"⇌","⇌"));var t,r=_createForOfIteratorHelper(MathLexer.GreekCharacters.split(""));try{for(r.s();!(t=r.n()).done;){var o=t.value;this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_TEXT_NOS,p.ExpressionTokenTemplate.UNDEFINED,null,o,o))}}catch(t){r.e(t)}finally{r.f()}var i,a=_createForOfIteratorHelper(MathLexer.DifferentiationCharacters.split(""));try{for(a.s();!(i=a.n()).done;){var l=i.value;this.expressionTemplates.push(new p.ExpressionTokenTemplate(p.ExpressionTokenTemplate.TYPE_TEXT_NOS,p.ExpressionTokenTemplate.UNDEFINED,null,l,l))}}catch(t){a.e(t)}finally{a.f()}this.buildFirstLetterMatchDict()}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathLexer,[{key:"buildFirstLetterMatchDict",value:function buildFirstLetterMatchDict(){this.firstCharacterMatchDict={};var t,r=_createForOfIteratorHelper(this.expressionTemplates);try{for(r.s();!(t=r.n()).done;){var o,i=t.value,a=_createForOfIteratorHelper(i.firstLetterMatchCharacters.split(""));try{for(a.s();!(o=a.n()).done;){var p=o.value;null==this.firstCharacterMatchDict[p]?this.firstCharacterMatchDict[p]=[i]:this.firstCharacterMatchDict[p].push(i)}}catch(t){a.e(t)}finally{a.f()}}}catch(t){r.e(t)}finally{r.f()}}},{key:"scanInput",value:function scanInput(t){for(var r=[],o=0,u=t.length;o<u;){var c=t.charAt(o),h=t.substring(o),m=-1;if(null!=this.firstCharacterMatchDict[c]){var T,E="",y=0,d=null,C=_createForOfIteratorHelper(this.firstCharacterMatchDict[c]);try{for(C.s();!(T=C.n()).done;){var _=T.value,O="",g=0;if(null==_.matchExpression)(g=(O=_.matchString).length)>y&&h.substr(0,g)==_.matchString&&(E=O,y=g,d=_);else{var v=_.matchExpression.exec(h);null!=v&&0==v.index&&(g=(O=v[0]).length)>y&&(E=O,y=g,d=_)}}}catch(t){C.e(t)}finally{C.f()}if(y>0){m=y;var P=d.type;if(P!=p.ExpressionTokenTemplate.TYPE_WHITESPACE){var S=new a.ExpressionToken(P,d.subtype,E);r.push(S)}o+=m}}if(-1==m){var M=null;r.length>0&&((M=r[r.length-1]).type==p.ExpressionTokenTemplate.UNDEFINED?M.originalString+=c:M=null),null==M&&(M=new a.ExpressionToken(p.ExpressionTokenTemplate.UNDEFINED,p.ExpressionTokenTemplate.UNDEFINED,c),r.push(M)),o++}}if(r.length>0){var x=r[r.length-1];x.type==p.ExpressionTokenTemplate.UNDEFINED&&"."==x.originalString&&r.pop()}return new l.TokenStream(r,i.FormulaFormats.SHANETEX)}}],[{key:"copyTokenStream",value:function copyTokenStream(t){var r,o=[],i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var p=r.value;o.push(new a.ExpressionToken(p.type,p.subtype,p.originalString))}}catch(t){i.e(t)}finally{i.f()}return o}}]),MathLexer}();r.MathLexer=u,u.Alphabet="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",u.GreekCharacters="ΔΘӨΛΞΠΦΨΩαβγδεζηθөικλξπρςστυφχψω",u.DifferentiationCharacters="'",u.Numbers="1234567890."},597:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.StringReplacement=void 0,r.StringReplacement=function StringReplacement(t,r){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,StringReplacement),this.matchExpression=t,this.replacement=r}},7193:(t,r)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.TokenStream=void 0;var o=function(){function TokenStream(t,r){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,TokenStream),this.stream=t,this.format=r}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(TokenStream,[{key:"clone",value:function clone(){var t=TokenStream.cloneExpressionTreeItems(this.stream);return new TokenStream(t,this.format)}}],[{key:"cloneExpressionTreeItems",value:function cloneExpressionTreeItems(t){for(var r=[],o=0;o<t.length;o++)r.push(t[o].clone());return r}}]),TokenStream}();r.TokenStream=o},7730:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MathJaxFacade=void 0;var i=o(4774),a=function(){function MathJaxFacade(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MathJaxFacade)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathJaxFacade,null,[{key:"requireMathJax",value:function requireMathJax(){MathJaxFacade.status==i.LoadStatus.NOT_LOADED&&(window.MathJax={showMathMenu:!1,menuSettings:{CHTMLpreview:!1},showProcessingMessages:!1,messageStyle:"none",config:["MML_HTMLorMML.js"],jax:["input/AsciiMath","input/MathML","input/TeX","output/HTML-CSS","output/NativeMML"],extensions:["asciimath2jax.js","tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js"],AuthorInit:MathJaxFacade.loadPostHub},i.LazyScriptLoader.loadScript(i.URLUtil.assetDomainRedirect("https://www.educationperfect.com/libs/mathjax/2.5.3/MathJax.js")).then((function(){MathJaxFacade.status=i.LoadStatus.LOADED})).catch((function(){MathJaxFacade.status=i.LoadStatus.NOT_LOADED})))}},{key:"typeset",value:function typeset(t,r){MathJaxFacade.requireMathJax(),MathJaxFacade.applyOrQueueAction((function(){MathJax.Hub.Queue(["Typeset",MathJax.Hub,t]),r&&MathJax.Hub.Queue((function(){return r()}))}))}},{key:"applyOrQueueAction",value:function applyOrQueueAction(t){MathJaxFacade.mathJaxFullyLoaded?t():(void 0===MathJaxFacade.delayedActions&&(MathJaxFacade.delayedActions=[]),MathJaxFacade.delayedActions.push(t))}},{key:"queueDelayedActions",value:function queueDelayedActions(){MathJaxFacade.delayedActions&&MathJaxFacade.delayedActions.length>0&&MathJaxFacade.delayedActions.forEach((function(t){return t()}))}},{key:"loadPostHub",value:function loadPostHub(){MathJax.Hub.Register.StartupHook("Begin",MathJaxFacade.queueDelayedActions)}},{key:"mathJaxFullyLoaded",get:function get(){return MathJaxFacade.status==i.LoadStatus.LOADED&&null!=MathJax.Hub}}]),MathJaxFacade}();r.MathJaxFacade=a,a.status=i.LoadStatus.NOT_LOADED},7964:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MathQuillFacade=void 0;var i=o(4774),a=function(){function MathQuillFacade(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MathQuillFacade)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathQuillFacade,null,[{key:"setPath",value:function setPath(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];MathQuillFacade.libPath=t,MathQuillFacade.production=r}},{key:"requireMathQuill",value:function requireMathQuill(){var t=this;if(!this.deferredMathQuill){this.deferredMathQuill=new i.Deferred,this.deferredMathQuill.then((function(r){return t.configureMathQuill(r),r})),i.LazyScriptLoader.loadCSS(i.URLUtil.assetDomainRedirect("".concat(MathQuillFacade.libPath,"/mathquill.css")));var r=MathQuillFacade.production?"mathquill.min.js":"mathquill.js";i.LazyScriptLoader.loadScript(i.URLUtil.assetDomainRedirect("".concat(MathQuillFacade.libPath,"/").concat(r))),this.loadedDetectionTimerID=setInterval((function(){t.loadingTick()}),200)}return this.deferredMathQuill}},{key:"loadingTick",value:function loadingTick(){this.mathQuillFullyLoaded&&(clearInterval(this.loadedDetectionTimerID),MathQuill=MathQuill.getInterface(2),this.deferredMathQuill.resolve(MathQuill))}},{key:"configureMathQuill",value:function configureMathQuill(t){t.config({spaceBehavesLikeTab:!1,charsThatBreakOutOfSupSub:"=<>)",autoCommands:"alpha beta gamma Delta lambda mu pi sigma theta omega Omega",autoOperatorNames:"sin cos tan sinh cosh tanh cot cosec log lg ln arg deg",supSubsRequireOperand:!0,typingAsteriskWritesTimesSymbol:!0})}},{key:"mathQuillFullyLoaded",get:function get(){return this.deferredMathQuill&&"undefined"!=typeof MathQuill}},{key:"typeset",value:function typeset(t){return this.requireMathQuill().then((function(r){return r.StaticMath(t)}))}},{key:"makeEditable",value:function makeEditable(t,r){return this.requireMathQuill().then((function(o){return o.MathField(t,r)}))}},{key:"makeEditableSynchronous",value:function makeEditableSynchronous(t,r){return"undefined"!=typeof MathQuill?MathQuill.MathField(t,r):null}}]),MathQuillFacade}();r.MathQuillFacade=a},9884:(t,r)=>{function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MathEntityMatchInfo=void 0;var o=function(){function MathEntityMatchInfo(t,r){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,MathEntityMatchInfo),this.matchString=t,this.templateComponent=r,this.caseSensitive=o}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathEntityMatchInfo,[{key:"generateComponent",value:function generateComponent(){return this.templateComponent?this.templateComponent.clone():null}}]),MathEntityMatchInfo}();r.MathEntityMatchInfo=o},902:(t,r,o)=>{function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MathEntityMatcher=void 0;var i=o(9849),a=function(){function MathEntityMatcher(t,r){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MathEntityMatcher),this.indexedMatchOptions={},this.matchType=r;var o=[];if(null!=t&&t.length>0){var a,p=function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}(t);try{for(p.s();!(a=p.n()).done;){var l=a.value,u=l.matchString;if(this.indexedMatchOptions[u])throw new Error("Duplicate match string");this.indexedMatchOptions[u]=l,o.push(u)}}catch(t){p.e(t)}finally{p.f()}}this.stringMatcher=new i.StringMatcher(o)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathEntityMatcher,[{key:"findBestMatch",value:function findBestMatch(t){var r=this.stringMatcher.findBestMatch(t,this.matchType);return this.indexedMatchOptions[r]}}]),MathEntityMatcher}();r.MathEntityMatcher=a},3210:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0})},8987:(t,r,o)=>{function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MathParser=void 0;var i=o(9310),a=o(4783),p=o(5099),l=o(4662),u=o(2178),c=o(9873),h=o(340),m=o(252),T=o(8818),E=o(9837),y=o(1219),d=o(3721),C=o(1118),_=o(4882),O=o(9781),g=o(1997),v=o(7491),P=o(3033),S=o(6594),M=o(5223),x=o(3728),b=o(9849),k=o(7809),N=o(902),A=o(9884),R=o(5797),I=function(){function MathParser(t,r,o,i,a){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MathParser),this.id=x.GuidUtilMath.create(),this.lastCompileHasErrors=!1,this.normaliseEqualsMode=MathParser.NORMALISE_EQUALS_MODE_AUTO,this.anySimplification=!0,this.equalsMovements=!0,this.addSubtractRearrangements=!0,this.multiplyDivideRearrangements=!0,this.numericSimplification=!0,this.allowInvertedSigns=!0,this.expansionOfBrackets=!0,this.groupLikeTerms=!1,this.autoCloseBrackets=!1,this.evaluateFunctions=!1,this.evaluateMathsConstantsAsNumbers=!1,this.simplifyExponents=!0,this._caseSensitive=!1,this.unfilteredMathFunctions=[],this.unfilteredMathConstants=[],this.useResultCache=!1,this.cachedResults={},this.comparer=o,this.atomiseVariables=i,this.useResultCache=a,null!=t&&(this.unfilteredMathFunctions=t.concat()),null!=r&&(this.unfilteredMathConstants=r.concat()),this.updateMathFunctionAndConstantMatchers()}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathParser,[{key:"parseTokenStream",value:function parseTokenStream(t){try{this.lastCompileHasErrors=!1;var r=t.stream;this.currentStreamFormat=t.format;var o="";if(this.useResultCache){o=this.GenerateTokenStreamCacheKey(r,this.currentStreamFormat);var i=this.cachedResults[o];if(null!=i)return i}switch(this.currentStreamFormat){case P.FormulaFormats.LATEX:this.workingExpressionTree=this.parseLatexStreamInternal(r);break;default:this.workingExpressionTree=this.parseShaneTexStreamInternal(r)}for(var a=0;a<10&&!this.workingExpressionTree.compiled;)this.workingExpressionTree.compile(this),a++;return this.useResultCache&&(this.cachedResults[o]=this.workingExpressionTree),this.workingExpressionTree}catch(t){null!=t.text?console.error("Error: ".concat(t.text)):null!=t.message&&console.error("Error: ".concat(t.message)),this.lastCompileHasErrors=!0}return null}},{key:"parseShaneTexStreamInternal",value:function parseShaneTexStreamInternal(t){return this.identifyReferenceTokenTypes(t),this.workingExpressionTree=this.createDepthTree(t),this.linkFunctionsWithChildGroups(this.workingExpressionTree),this.flattenAnyGroupNodesWithSingleChild(this.workingExpressionTree),this.workingExpressionTree=this.searchForEqualsSign(this.workingExpressionTree),this.workingExpressionTree=this.searchForArrows(this.workingExpressionTree),this.workingExpressionTree}},{key:"parseLatexStreamInternal",value:function parseLatexStreamInternal(t){return this.workingExpressionTree=this.createDepthTree(t),this.handleLatexSpecificFunctionsAndVariables(this.workingExpressionTree),this.identifyReferenceTokenTypesInNestedGroups([this.workingExpressionTree]),this.linkFunctionsWithChildGroups(this.workingExpressionTree),this.flattenAnyGroupNodesWithSingleChild(this.workingExpressionTree),this.workingExpressionTree=this.searchForEqualsSign(this.workingExpressionTree),this.workingExpressionTree=this.searchForArrows(this.workingExpressionTree),this.workingExpressionTree}},{key:"GenerateTokenStreamCacheKey",value:function GenerateTokenStreamCacheKey(t,r){var o,i={rounding:null,roundingAmount:0,useOriginalNumericString:!1},a="~".concat(r.toString(),"~"),p=_createForOfIteratorHelper(t);try{for(p.s();!(o=p.n()).done;){var l=o.value;null!=l&&(a+=l.outputLatex(i))}}catch(t){p.e(t)}finally{p.f()}return a}},{key:"updateMathFunctionAndConstantMatchers",value:function updateMathFunctionAndConstantMatchers(){var t=this.getDistinctMathEntityMatchInfoSet(this.unfilteredMathFunctions,this._caseSensitive),r=this.getDistinctMathEntityMatchInfoSet(this.unfilteredMathConstants,this._caseSensitive);this.functionMatcher=new N.MathEntityMatcher(t,b.StringMatcher.MATCH_TYPE_END),this.constantMatcher=new N.MathEntityMatcher(r,b.StringMatcher.MATCH_TYPE_PARTIAL)}},{key:"getDistinctMathEntityMatchInfoSet",value:function getDistinctMathEntityMatchInfoSet(t,r){var o,i=[],a={},p=_createForOfIteratorHelper(t);try{for(p.s();!(o=p.n()).done;){var l=o.value;r||l.caseSensitive||(l=new A.MathEntityMatchInfo(l.matchString.toLowerCase(),l.templateComponent)),1!=a[l.matchString]&&(i.push(l),a[l.matchString]=!0)}}catch(t){p.e(t)}finally{p.f()}return i}},{key:"caseSensitive",get:function get(){return this._caseSensitive},set:function set(t){t!=this._caseSensitive&&(this._caseSensitive=t,this.updateMathFunctionAndConstantMatchers())}},{key:"identifyReferenceTokenTypes",value:function identifyReferenceTokenTypes(t){for(var r=null,o=null,i=null,a=null,p=!1,l=0;l<t.length;l++)if((r=t[l])instanceof S.ExpressionToken){var u=r;if(u.type==M.ExpressionTokenTemplate.TYPE_TEXT){(p=!p)||(t.splice(l,1),l--);continue}if(p){var c=t[l-1];c instanceof S.ExpressionToken&&('"'===c.originalString?c.originalString=u.originalString:c.originalString+=" ".concat(u.originalString),t.splice(l,1),l--);continue}if(u.type==M.ExpressionTokenTemplate.TYPE_TEXT_NOS){var E=u.originalString;if(this.anySimplification&&!this.caseSensitive&&(E=E.toLowerCase()),null!=(o=l<t.length-1?t[l+1]:null)&&((o.type==M.ExpressionTokenTemplate.TYPE_BRACE_OPEN||o.type==M.ExpressionTokenTemplate.TYPE_BRACE_EMPTY)&&o.subtype==M.ExpressionTokenTemplate.BRACE_TYPE_ROUND||o.type==h.ExpressionTreeTypes.TYPE_GROUP_COMPONENT&&o.subtype==M.ExpressionTokenTemplate.BRACE_TYPE_ROUND)){var y=this.functionMatcher.findBestMatch(E);if(y){var C=y.generateComponent(),_=E.length-y.matchString.length;t[l]=C,_>0&&(u.originalString=E.substr(0,_),t.splice(l,0,u),l--);continue}if(!this.anySimplification){t[l]=new T.MathFunctionComponent(null,E);continue}}var O=this.constantMatcher.findBestMatch(E);if(O){var g=O.matchString,v=E.length-g.length,P=E.indexOf(g),x=v-P,b=!0;if(0==P||0==x||g.length/E.length>=.5||g.length>3){var k=O.generateComponent();if(this.anySimplification&&this.evaluateMathsConstantsAsNumbers&&k instanceof m.MathEntityComponent){var N=k.evaluateIfMathConstant();isNaN(N)||(k=new d.NumberComponent(N))}if("[omit]"==k.entityName?i&&a==g?b=!1:(i=k,a=g,t.splice(l,1),l-=1):t[l]=k,a=(i=i!=k?null:i)?a:null,v>0){if(x>0){var A=new S.ExpressionToken(u.type,u.subtype,E.substr(P+g.length));t.splice(l+1,0,A)}P>0&&(u.originalString=E.substr(0,P),t.splice(l,0,u),l--)}if(b)continue}}if(this.atomiseVariables&&E.length>1){var R=E.split("");t.splice(l,1);for(var I=0;I<R.length;I++)t.splice(l+I,0,new m.MathEntityComponent(R[I]));l+=R.length-1}else t[l]=new m.MathEntityComponent(E)}else u.type==M.ExpressionTokenTemplate.TYPE_NUMERICAL_VALUE&&(t[l]=new d.NumberComponent(Number(u.originalString),u.originalString));i=null}}},{key:"identifyReferenceTokenTypesInNestedGroups",value:function identifyReferenceTokenTypesInNestedGroups(t){var r,o=[],i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(!(a instanceof S.ExpressionToken)&&(a instanceof p.BaseGroupComponent&&o.push(a),a.implementsInterface("IParentComponent"))){var l,u=_createForOfIteratorHelper(this.getAllChildGroupNodesInParentComponent(a));try{for(u.s();!(l=u.n()).done;){var c=l.value;o.push(c)}}catch(t){u.e(t)}finally{u.f()}}}}catch(t){i.e(t)}finally{i.f()}for(var h=0,m=o;h<m.length;h++){var T=m[h],E=T.children.concat();this.identifyReferenceTokenTypes(E),T.removeAllChildren();var y,d=_createForOfIteratorHelper(E);try{for(d.s();!(y=d.n()).done;){var C=y.value;T.addChild(C)}}catch(t){d.e(t)}finally{d.f()}}}},{key:"createDepthTree",value:function createDepthTree(t){for(var r=new p.BaseGroupComponent(p.BaseGroupComponent.GROUP_TYPE_UNDEFINED),o=r,i=0;i<t.length;i++){var a=t[i];if(a.implementsInterface("IExpressionToken")){var l=a;switch(l.type){case M.ExpressionTokenTemplate.TYPE_TEXT:var u=new O.TextComponent(l.originalString,l.originalString);o.addChild(u);break;case M.ExpressionTokenTemplate.TYPE_BRACE_OPEN:var c=new p.BaseGroupComponent(l.subtype);o.addChild(c),o=c;break;case M.ExpressionTokenTemplate.TYPE_BRACE_CLOSE:if(o.subtype!=l.subtype){if(o.subtype==M.ExpressionTokenTemplate.BRACE_TYPE_PIPES&&null!=o.parent&&o.parent instanceof p.BaseGroupComponent){var h=o.parent;h.replaceChild(o,new S.ExpressionToken(M.ExpressionTokenTemplate.TYPE_TEXT_NOS,M.ExpressionTokenTemplate.UNDEFINED,"|"));var m,T=_createForOfIteratorHelper(o.getAllChildren());try{for(T.s();!(m=T.n()).done;){var E=m.value;h.addChild(E)}}catch(t){T.e(t)}finally{T.f()}o=h,i--;continue}throw new Error("Bracket not matched")}o=o.parent;break;case M.ExpressionTokenTemplate.TYPE_BRACE_EMPTY:var y=new p.BaseGroupComponent(l.subtype);o.addChild(y);break;case M.ExpressionTokenTemplate.TYPE_BRACE_UNKNOWN:if(o.subtype==l.subtype)o=o.parent;else{var d=new p.BaseGroupComponent(l.subtype);o.addChild(d),o=d}break;default:o.addChild(a)}}else o.addChild(a)}if(o!=r&&null!=o.parent&&o.parent instanceof p.BaseGroupComponent){var C=o.parent;if(o.subtype==M.ExpressionTokenTemplate.BRACE_TYPE_PIPES){C.replaceChild(o,new S.ExpressionToken(M.ExpressionTokenTemplate.TYPE_TEXT_NOS,M.ExpressionTokenTemplate.UNDEFINED,"|"));var _,g=_createForOfIteratorHelper(o.getAllChildren());try{for(g.s();!(_=g.n()).done;){var v=_.value;C.addChild(v)}}catch(t){g.e(t)}finally{g.f()}o=C}}if(o!=r)if(this.anySimplification&&this.autoCloseBrackets);else for(this.lastCompileHasErrors=!0;o!=r;)o.bracketIsUnmatched=!0,o=o.parent;return r}},{key:"getAllChildGroupNodesInParentComponent",value:function getAllChildGroupNodesInParentComponent(t){for(var r=[],o=t.getAllChildren(),i=o.length,a=0;a<i;a++){var l=o[a];if(l instanceof p.BaseGroupComponent){r.push(l);var u,c=_createForOfIteratorHelper(this.getAllChildGroupNodesInParentComponent(l));try{for(c.s();!(u=c.n()).done;){var h=u.value;r.push(h)}}catch(t){c.e(t)}finally{c.f()}}else if(l.implementsInterface("IParentComponent")){var m,T=_createForOfIteratorHelper(l.getAllChildren());try{for(T.s();!(m=T.n()).done;){var E=m.value;null!=E&&(o.push(E),i++)}}catch(t){T.e(t)}finally{T.f()}}}return r}},{key:"makeImplicitMultiplicationExplicitForStream",value:function makeImplicitMultiplicationExplicitForStream(t){var r,o=MathParser.createComponentTypeRepresentationString(h.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT,a.BaseExpressionTreeComponent.SUBTYPE_UNKNOWN),i=MathParser.createComponentTypeRepresentationString(h.ExpressionTreeTypes.TYPE_MATH_ENTITY_COMPONENT,a.BaseExpressionTreeComponent.SUBTYPE_UNKNOWN),l=MathParser.createComponentTypeRepresentationString(h.ExpressionTreeTypes.TYPE_GROUP_COMPONENT,p.BaseGroupComponent.GROUP_TYPE_ROUND_BRACKETS),u=MathParser.createComponentTypeRepresentationString(h.ExpressionTreeTypes.TYPE_GROUP_COMPONENT,p.BaseGroupComponent.GROUP_TYPE_SQUARE_BRACKETS),c=MathParser.createComponentTypeRepresentationString(h.ExpressionTreeTypes.TYPE_MATH_FUNCTION_COMPONENT,MathParser.MATCH_ANY_SUBTYPE),m=MathParser.createComponentTypeRepresentationString(h.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT,MathParser.MATCH_ANY_SUBTYPE),T=MathParser.createComponentTypeRepresentationString(h.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT,MathParser.MATCH_ANY_SUBTYPE),y=MathParser.createComponentTypeRepresentationString(h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT,MathParser.MATCH_ANY_SUBTYPE),C=MathParser.createComponentTypeRepresentationString(h.ExpressionTreeTypes.TYPE_SUBSCRIPT_SUPERSCRIPT_COMPONENT,MathParser.MATCH_ANY_SUBTYPE),_="(".concat([o,i,l,u,m,T,y,C,c].join(")|("),")");r=this.currentStreamFormat!=P.FormulaFormats.SHANETEX||this.anySimplification?"(".concat([o,i,l,u,m,T,y,C,c].join(")|("),")"):"(".concat([i,l,u,m,T,y,C,c].join(")|("),")");var O=new RegExp("(".concat(_,"):(?=").concat(r,")"),"g");O.lastIndex=0;for(var g,v=MathParser.createStringFromExpressionTreeComponents(t),x=[];null!=(g=O.exec(v));)x.push(this.findComponentIndexFromComponentsStringIndex(g.index));for(var b=x.length,k=0,N=0;N<b;N++){for(var A=x[N],R=A,I=!0;I;)I=!1,N<b-1&&x[N+1]==R+1&&(R++,N++,I=!0);if(k+A>1&&t[k+A]instanceof d.NumberComponent&&t[k+A-2]instanceof d.NumberComponent&&t[k+A-1]instanceof S.ExpressionToken&&t[k+A-1].type==M.ExpressionTokenTemplate.TYPE_OPERATOR&&t[k+A-1].subtype==M.ExpressionTokenTemplate.SUBTYPE_DIVIDE){var w=t[k+A-1],U=new E.MultiOperatorComponent(E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE,E.MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_AUTOMATIC,"",w.originalString);U.addChild(t[k+A-2],!1),U.addChild(t[k+A],!0),t.splice(k+A-2,3,U),k-=2}for(var Y=new E.MultiOperatorComponent(E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE,E.MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_IMPLICIT),L=A;L<=R+1;L++){var D=t[k+L];Y.addChild(D,!1)}t.splice(k+A,R-A+2,Y),k-=R-A+1}}},{key:"makeMixedFractionsExplicitForStream",value:function makeMixedFractionsExplicitForStream(t){var r=MathParser.createComponentTypeRepresentationString(h.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT,a.BaseExpressionTreeComponent.SUBTYPE_UNKNOWN),o=MathParser.createComponentTypeRepresentationString(M.ExpressionTokenTemplate.TYPE_OPERATOR,M.ExpressionTokenTemplate.SUBTYPE_DIVIDE),i=MathParser.createComponentTypeRepresentationString(h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT,E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE),p="(".concat(r,"):(").concat(r,"):(").concat(o,"):(").concat(r,")"),l="(".concat(r,"):(").concat(i,")"),u=new RegExp("(".concat(p,")|(").concat(l,")"),"g");u.lastIndex=0;for(var c,m=MathParser.createStringFromExpressionTreeComponents(t),T=[];null!=(c=u.exec(m));)T.push(this.findComponentIndexFromComponentsStringIndex(c.index));for(var y=T.length,d=0,C=0;C<y;C++){var _=T[C],O=t[_+1];if(O.type!=h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT||2==O.numberOfChildren&&O.allChildrenAreNumeric()){var g=new S.ExpressionToken(M.ExpressionTokenTemplate.TYPE_OPERATOR,M.ExpressionTokenTemplate.SUBTYPE_PLUS);t.splice(d+_+1,0,g),d++}}}},{key:"linkFunctionsWithChildGroups",value:function linkFunctionsWithChildGroups(t){var r=null,o=null,i=this.getAllChildGroupNodesInParentComponent(t);i.push(t);var a,l=_createForOfIteratorHelper(i);try{for(l.s();!(a=l.n()).done;)for(var u=a.value,c=u.numberOfChildren,m=0;m<c-1;m++)(r=u.getChildAtPosition(m)).type==h.ExpressionTreeTypes.TYPE_MATH_FUNCTION_COMPONENT&&(o=u.getChildAtPosition(m+1))instanceof p.BaseGroupComponent&&o.subtype==p.BaseGroupComponent.GROUP_TYPE_ROUND_BRACKETS&&(u.removeChild(o),r.setChild(o),c--)}catch(t){l.e(t)}finally{l.f()}}},{key:"handleLatexSpecificFunctionsAndVariables",value:function handleLatexSpecificFunctionsAndVariables(t){for(var r=t.getAllChildren(),o=!0,i=0;o&&i<10;i+=1){o=!1;for(var a=0;a<r.length;a++){var l=r[a];if(l.type==M.ExpressionTokenTemplate.TYPE_LATEX_COMMAND){var c=l.originalString,h=a<r.length-1?r[a+1]:null,m=h instanceof p.BaseGroupComponent?h:null;if(R.MathParserHelper.mergeExplicitBrackets(a,r,t)){a-=1;continue}switch(c){case"sqrt":var y=new u.ExponentComponent(null,null,u.ExponentComponent.OPERATION_TYPE_ROOT);null!=m&&m.subtype==p.BaseGroupComponent.GROUP_TYPE_SQUARE_BRACKETS?(m.subtype=p.BaseGroupComponent.GROUP_TYPE_ROUND_BRACKETS,m.explicitBrackets=!1,t.removeChild(m),y.exponent=m,r.splice(a+1,1),m=(h=a<r.length-1?r[a+1]:null)instanceof p.BaseGroupComponent?h:null):y.exponent=new d.NumberComponent(2,"2"),null!=m&&m.subtype==p.BaseGroupComponent.GROUP_TYPE_CURLY_BRACKETS?(m.subtype=p.BaseGroupComponent.GROUP_TYPE_ROUND_BRACKETS,m.explicitBrackets=!1,t.removeChild(h),y.base=h,r.splice(a+1,1)):null!=h&&(t.removeChild(h),y.base=h,r.splice(a+1,1)),t.replaceChild(l,y),r[a]=y,a--;break;case"frac":case"dfrac":case"tfrac":var C=new E.MultiOperatorComponent(E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE);null!=m&&m.subtype==p.BaseGroupComponent.GROUP_TYPE_CURLY_BRACKETS&&(m.subtype=p.BaseGroupComponent.GROUP_TYPE_ROUND_BRACKETS,m.explicitBrackets=!1,t.removeChild(h),C.addChild(h,!1),r.splice(a+1,1),m=(h=a<r.length-1?r[a+1]:null)instanceof p.BaseGroupComponent?h:null),null!=m&&m.subtype==p.BaseGroupComponent.GROUP_TYPE_CURLY_BRACKETS&&(m.subtype=p.BaseGroupComponent.GROUP_TYPE_ROUND_BRACKETS,m.explicitBrackets=!1,t.removeChild(h),C.addChild(m,!0),r.splice(a+1,1)),t.replaceChild(l,C),r[a]=C,a--;break;case"text":if(null!=m&&m.subtype==p.BaseGroupComponent.GROUP_TYPE_CURLY_BRACKETS){t.removeChild(m),r.splice(a+1,1);var _=m.children;if(1==_.length)t.replaceChild(l,_[0]),r[a]=_[0];else if(_.length>1){var O,g=new p.BaseGroupComponent(p.BaseGroupComponent.GROUP_TYPE_UNDEFINED,!1),v=_createForOfIteratorHelper(_);try{for(v.s();!(O=v.n()).done;){var P=O.value;g.addChild(P)}}catch(t){v.e(t)}finally{v.f()}t.replaceChild(l,g),r[a]=g}else t.removeChild(l),r.splice(a,1),a--}else t.removeChild(l),r.splice(a,1),a--;break;case"operatorname":if(null!=m&&m.subtype==p.BaseGroupComponent.GROUP_TYPE_CURLY_BRACKETS&&1==m.numberOfChildren){var x=m.children[0];t.replaceChild(l,x),t.removeChild(h),r.splice(a,2,x);break}break;case"sin":case"cos":case"tan":case"sinh":case"cosh":case"tanh":case"coth":case"cot":case"sec":case"csc":case"cosec":case"arcsin":case"arccos":case"arctan":case"log":case"ln":case"Pr":if(h instanceof S.ExpressionToken&&h.type==M.ExpressionTokenTemplate.TYPE_LATEX_COMMAND)o=!0;else{var b=new T.MathFunctionComponent(null,c);if(t.replaceChild(l,b),r[a]=b,h){if(R.MathParserHelper.rearrangedFunctionNumericExponent(a,r,t)&&(m=(h=a<r.length-1?r[a+1]:null)instanceof p.BaseGroupComponent?h:null),null!=m&&m.subtype==p.BaseGroupComponent.GROUP_TYPE_CURLY_BRACKETS)m.subtype=p.BaseGroupComponent.GROUP_TYPE_ROUND_BRACKETS,m.explicitBrackets=!1,t.removeChild(h),b.setChild(h);else{var k=new p.BaseGroupComponent(p.BaseGroupComponent.GROUP_TYPE_ROUND_BRACKETS);t.removeChild(h),k.addChild(h),b.setChild(k)}r.splice(a+1,1)}a--}}}else!o&&l.implementsInterface("IParentComponent")&&this.handleLatexSpecificFunctionsAndVariables(l)}}}},{key:"flattenAnyGroupNodesWithSingleChild",value:function flattenAnyGroupNodesWithSingleChild(t){var r=this.getAllChildGroupNodesInParentComponent(t);r.reverse();var o,i=_createForOfIteratorHelper(r);try{for(i.s();!(o=i.n()).done;){var a=o.value;if(1==a.numberOfChildren&&a.subtype==p.BaseGroupComponent.GROUP_TYPE_ROUND_BRACKETS&&null!=a.parent&&(this.anySimplification||!a.bracketIsUnmatched)){var l=a.getChildAtPosition(0);a.parent.replaceChild(a,l),a.removeChild(l)}}}catch(t){i.e(t)}finally{i.f()}}},{key:"searchForEqualsSign",value:function searchForEqualsSign(t){var r,o,i,a,u=t.getAllChildren(),c=u.length,h=[],T=[],E=[],y=[],d=[];for(i=0;i<c;i++){var _=u[i];_.type==M.ExpressionTokenTemplate.TYPE_COMPARITOR?(E.push(_),h.push(_),y.push(d),d=[]):_.type==M.ExpressionTokenTemplate.TYPE_KEYWORD&&_.subtype==M.ExpressionTokenTemplate.SUBTYPE_LOGIC_FLOW_OR?(E.push(_),T.push(_),y.push(d),d=[]):d.push(_)}if(y.push(d),0==E.length)return t;if(t.removeAllChildren(),1==E.length){var O=1==T.length?new C.OrComponent:new l.EqualsComponent(h[0].subtype);for(i=0;i<2;i++){for(r=new p.BaseGroupComponent,o=y[i],a=0;a<o.length;a++)r.addChild(o[a]);O.addChild(r)}return O}if(h.length>0)for(i=0;i<h.length;i++){var g=h[i],v=E.indexOf(g),P=new l.EqualsComponent(g.subtype);for(a=0;a<2;a++){r=new p.BaseGroupComponent;var S,x=_createForOfIteratorHelper(o=y[v+a]);try{for(x.s();!(S=x.n()).done;){var b=S.value;r.addChild(b)}}catch(t){x.e(t)}finally{x.f()}P.addChild(r)}var k=[P];y.splice(v,2,k),E.splice(v,1)}if(T.length>0){var N=new C.OrComponent;if(1==h.length&&y[0][0]instanceof l.EqualsComponent&&1==this.anySimplification){var A=y[0][0];for(N.addChild(A),i=1;i<y.length;i++){r=new p.BaseGroupComponent;var R,I=_createForOfIteratorHelper(o=y[i]);try{for(I.s();!(R=I.n()).done;){var w=R.value;r.addChild(w)}}catch(t){I.e(t)}finally{I.f()}var U=A.clone();U.removeChild(U.getChildAtPosition(1)),U.addChild(r),N.addChild(U)}}else for(i=0;i<y.length;i++){r=new p.BaseGroupComponent;var Y,L=_createForOfIteratorHelper(o=y[i]);try{for(L.s();!(Y=L.n()).done;){var D=Y.value;r.addChild(D)}}catch(t){L.e(t)}finally{L.f()}r.numberOfChildren>0?N.addChild(r):N.addChild(m.MathEntityComponent.generatePlaceholderComponent())}return N}for(var B=0,H=y;B<H.length;B++){var W,j=_createForOfIteratorHelper(H[B]);try{for(j.s();!(W=j.n()).done;){var G=W.value;t.addChild(G)}}catch(t){j.e(t)}finally{j.f()}}return t}},{key:"searchForArrows",value:function searchForArrows(t){for(var r=t.getAllChildren(),o=r.length,a=[],l=[],u=[],c=0;c<o;c++){var h=r[c];h.type==M.ExpressionTokenTemplate.TYPE_ARROW?(a.push(h),l.push(u),u=[]):u.push(h)}if(l.push(u),0==a.length)return t;for(var m=!0,T=a[0].subtype,E=1;E<a.length;E++)if(a[E].subtype!=T){m=!1;break}if(m){t.removeAllChildren();for(var y=new i.ArrowComponent(a[0].subtype),d=0;d<2;d++){var C,_=new p.BaseGroupComponent,O=_createForOfIteratorHelper(l[d]);try{for(O.s();!(C=O.n()).done;){var g=C.value;_.addChild(g)}}catch(t){O.e(t)}finally{O.f()}y.addChild(_)}return y}return t}},{key:"createOperatorComponents",value:function createOperatorComponents(t){for(var r=[],o=0;o<11;o++)r[o]=[];for(var i,a,l,c=null,T=null,y=null,C=null,O=0,v=0,x=t.length,b=0;b<t.length;b++)switch((c=t[b]).type){case M.ExpressionTokenTemplate.TYPE_KEYWORD:c.subtype==M.ExpressionTokenTemplate.SUBTYPE_LOGIC_FLOW_OR&&r[9].push(c);break;case M.ExpressionTokenTemplate.TYPE_NOTATION:r[2].push(c);break;case M.ExpressionTokenTemplate.TYPE_UNARY_OPERATOR:r[4].push(c);break;case M.ExpressionTokenTemplate.TYPE_OPERATOR:if((O=c.subtype)==M.ExpressionTokenTemplate.SUBTYPE_PLUS||O==M.ExpressionTokenTemplate.SUBTYPE_MINUS||O==M.ExpressionTokenTemplate.SUBTYPE_PLUS_MINUS){var k=!1,N=!1;if(0==b)k=!0;else if(b>0&&(T=t[b-1]).implementsInterface("IExpressionToken"))if((v=T.type)==M.ExpressionTokenTemplate.TYPE_COMPARITOR||v==M.ExpressionTokenTemplate.TYPE_OPERATOR){if(v==M.ExpressionTokenTemplate.TYPE_OPERATOR&&T.subtype==M.ExpressionTokenTemplate.SUBTYPE_POWER)break;if(b>1){var A=t[b-2];A.type==M.ExpressionTokenTemplate.TYPE_OPERATOR&&A.subtype==M.ExpressionTokenTemplate.SUBTYPE_POWER||(k=!0)}else k=!0}else b==x-1&&(N=!0);if(k)r[5].push(c);else if(N)r[4].push(c);else if(O!=M.ExpressionTokenTemplate.SUBTYPE_PLUS_MINUS)r[7].push(c);else{var R=new S.ExpressionToken(M.ExpressionTokenTemplate.TYPE_OPERATOR,M.ExpressionTokenTemplate.SUBTYPE_PLUS);t.splice(b,0,R),r[7].push(R),r[5].push(c),b++}}else O==M.ExpressionTokenTemplate.SUBTYPE_DIVIDE||O==M.ExpressionTokenTemplate.SUBTYPE_MULTIPLY?r[6].push(c):O!=M.ExpressionTokenTemplate.SUBTYPE_POWER&&O!=M.ExpressionTokenTemplate.SUBTYPE_ROOT||r[3].push(c);break;case M.ExpressionTokenTemplate.TYPE_COMPARITOR:r[8].push(c)}var I=!1;if((i=r[2]).length>0){var w,U=_createForOfIteratorHelper(i=i.reverse());try{for(U.s();!(w=U.n()).done;){a=w.value,l=t.indexOf(a);var Y=!1,L=!1;if(l+1<t.length){var D=y=t[l+1];D.type==h.ExpressionTreeTypes.TYPE_GROUP_COMPONENT&&0==D.numberOfChildren&&D.bracketIsUnmatched&&D.addChild(m.MathEntityComponent.generatePlaceholderComponent())}else y=m.MathEntityComponent.generatePlaceholderComponent(),Y=!0;if(l>0){var B=T=t[l-1];B.type==h.ExpressionTreeTypes.TYPE_GROUP_COMPONENT&&0==B.numberOfChildren&&B.bracketIsUnmatched&&B.addChild(m.MathEntityComponent.generatePlaceholderComponent())}var H=new _.SubscriptSuperscriptComponent(null,null,a.subtype),W=void 0,j=void 0;a.subtype==M.ExpressionTokenTemplate.SUBTYPE_SUBSCRIPT&&(null==T&&(T=m.MathEntityComponent.generatePlaceholderComponent(),L=!0),H.base=T,W=l-1+Number(L),y.type!=M.ExpressionTokenTemplate.TYPE_OPERATOR||y.subtype!=M.ExpressionTokenTemplate.SUBTYPE_MINUS&&y.subtype!=M.ExpressionTokenTemplate.SUBTYPE_PLUS&&y.subtype!=M.ExpressionTokenTemplate.SUBTYPE_PLUS_MINUS?(H.script=y,j=3-Number(L)-Number(Y),t.splice(W,j,H)):(t.length>l+1?C=t[l+2]:(C=m.MathEntityComponent.generatePlaceholderComponent(),Y=!0),H.script=new g.UnaryOperatorComponent(C,y.subtype),j=4-Number(L)-Number(Y),t.splice(W,j,H))),(L||Y)&&(this.lastCompileHasErrors=!0)}}catch(t){U.e(t)}finally{U.f()}}if((i=r[3]).length>0){var G,q=_createForOfIteratorHelper(i=i.reverse());try{for(q.s();!(G=q.n()).done;){a=G.value,l=t.indexOf(a);var V=!1,X=!1,Q=!1;l+1<t.length?(y=t[l+1]).type==h.ExpressionTreeTypes.TYPE_GROUP_COMPONENT&&0==y.numberOfChildren?(y.addChild(m.MathEntityComponent.generatePlaceholderComponent()),X=!0):y.type==M.ExpressionTokenTemplate.TYPE_MATH_ENTITY&&y.isPlaceholder&&(X=!0):(y=m.MathEntityComponent.generatePlaceholderComponent(),V=!0),l>0&&(T=t[l-1]).type==h.ExpressionTreeTypes.TYPE_GROUP_COMPONENT&&0==T.numberOfChildren&&T.bracketIsUnmatched&&T.addChild(m.MathEntityComponent.generatePlaceholderComponent());var K=new u.ExponentComponent(null,null,a.subtype),J=void 0,z=void 0;if(a.subtype==M.ExpressionTokenTemplate.SUBTYPE_POWER){null==T&&(T=m.MathEntityComponent.generatePlaceholderComponent(),Q=!0),K.base=T,J=l-1+Number(Q);var $=!1;this.currentStreamFormat==P.FormulaFormats.SHANETEX&&y.type==M.ExpressionTokenTemplate.TYPE_OPERATOR&&y.subtype==M.ExpressionTokenTemplate.SUBTYPE_MINUS&&t.length>l+2&&((C=t[l+2])instanceof d.NumberComponent||C instanceof m.MathEntityComponent)&&($=!0),$?(K.exponent=new g.UnaryOperatorComponent(t[l+2],y.subtype),z=4-Number(Q)-Number(V),t.splice(J,z,K)):this.anySimplification&&(X||V)?(z=3-Number(Q)-Number(V),t.splice(J,z,K.base)):(K.exponent=y,z=3-Number(Q)-Number(V),t.splice(J,z,K))}else{K.base=y;var Z=!0;if(l>0&&T.type==h.ExpressionTreeTypes.TYPE_GROUP_COMPONENT&&T.subtype==p.BaseGroupComponent.GROUP_TYPE_SQUARE_BRACKETS){Z=!1;var ee=T;1==ee.numberOfChildren?(K.exponent=ee.getChildAtPosition(0),ee.removeAllChildren()):(K.exponent=m.MathEntityComponent.generatePlaceholderComponent(),Q=!0)}Z&&(K.exponent=new d.NumberComponent(2)),J=l-1+Number(Z)+Number(Q),z=3-Number(Z)-Number(Q)-Number(V),t.splice(J,z,K)}(Q||V)&&(this.lastCompileHasErrors=!0)}}catch(t){q.e(t)}finally{q.f()}}if((i=r[4]).length>0){var te,ne=_createForOfIteratorHelper(i);try{for(ne.s();!(te=ne.n()).done;){a=te.value,I=!1,(l=t.indexOf(a))>0?T=t[l-1]:(T=m.MathEntityComponent.generatePlaceholderComponent(),I=!0),T.type<h.ExpressionTreeTypes.TYPE_UNKNOWN?(T=m.MathEntityComponent.generatePlaceholderComponent(),I=!0):T.type==h.ExpressionTreeTypes.TYPE_GROUP_COMPONENT&&0==T.numberOfChildren&&T.bracketIsUnmatched&&T.addChild(m.MathEntityComponent.generatePlaceholderComponent());var re=new g.UnaryOperatorComponent(T,a.subtype,!0);t.splice(l-Number(!I),1+Number(!I),re),I&&(this.lastCompileHasErrors=!0)}}catch(t){ne.e(t)}finally{ne.f()}}if((i=r[5]).length>0){var oe,ie=_createForOfIteratorHelper(i=i.reverse());try{for(ie.s();!(oe=ie.n()).done;)if(a=oe.value,-1!=(l=t.indexOf(a))){if(I=!1,l<t.length-1){var ae=y=t[l+1];ae.type==h.ExpressionTreeTypes.TYPE_GROUP_COMPONENT&&0==ae.numberOfChildren&&ae.bracketIsUnmatched&&ae.addChild(m.MathEntityComponent.generatePlaceholderComponent())}else y=m.MathEntityComponent.generatePlaceholderComponent(),I=!0;var se=new g.UnaryOperatorComponent(y,a.subtype);t.splice(l,1+(!1===I?1:0),se),I&&(this.lastCompileHasErrors=!0)}}catch(t){ie.e(t)}finally{ie.f()}}return this.makeImplicitMultiplicationExplicitForStream(t),i=r[6],this.isolateBinaryOperatorChains(t,i,E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE,M.ExpressionTokenTemplate.TYPE_OPERATOR,M.ExpressionTokenTemplate.SUBTYPE_MULTIPLY,M.ExpressionTokenTemplate.SUBTYPE_DIVIDE),i=r[7],this.isolateBinaryOperatorChains(t,i,E.MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT,M.ExpressionTokenTemplate.TYPE_OPERATOR,M.ExpressionTokenTemplate.SUBTYPE_PLUS,M.ExpressionTokenTemplate.SUBTYPE_MINUS),t}},{key:"isolateBinaryOperatorChains",value:function isolateBinaryOperatorChains(t,r,o,i,p,l){var u=r.length;if(u>0)for(var c=0;c<u;c++){var T=r[c],y=t.indexOf(T);if(-1!=y){var d=y,C=0,_=new E.MultiOperatorComponent(o);o==E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE&&(_.multiplicationDisplayType=E.MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_EXPLICIT);for(var O=0;c+C<u&&d<t.length&&r[c+C]==t[d];){var g=0,v=void 0;if((T=t[d]).type==i)if(T.subtype==p)v=!1,""==_.positiveCharacterDisplayString&&(_.positiveCharacterDisplayString=T.originalString);else{if(T.subtype!=l)throw new Error("Unable to identify operator");v=!0,""==_.inverseCharacterDisplayString&&(_.inverseCharacterDisplayString=T.originalString)}var P=void 0;if(d+1<t.length?P=t[d+1]:(P=m.MathEntityComponent.generatePlaceholderComponent(),g++),P.type<=a.BaseExpressionTreeComponent.SUBTYPE_UNKNOWN?(P=m.MathEntityComponent.generatePlaceholderComponent(),g++):P.type==h.ExpressionTreeTypes.TYPE_GROUP_COMPONENT&&0==P.numberOfChildren&&P.bracketIsUnmatched&&P.addChild(m.MathEntityComponent.generatePlaceholderComponent()),0==C){var S=void 0;d>0?S=t[d-1]:(S=m.MathEntityComponent.generatePlaceholderComponent(),g++),S.type<=a.BaseExpressionTreeComponent.SUBTYPE_UNKNOWN&&(S=m.MathEntityComponent.generatePlaceholderComponent(),g++),_.addChild(S,!1)}_.addChild(P,v),C++,d+=2-g,O+=g}if(!(C>0))throw new Error("Operator Chain length is zero");t.splice(y-1,1+2*C-O,_),c+=C-1,O>0&&(this.lastCompileHasErrors=!0)}}}},{key:"findComponentIndexFromComponentsStringIndex",value:function findComponentIndexFromComponentsStringIndex(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,p=r+a+o+i;return(t-1)/p}},{key:"parse",value:function parse(t){if(null==t.parent&&t!=this.workingExpressionTree)return!0;switch(t.type){case h.ExpressionTreeTypes.TYPE_MATH_FUNCTION_COMPONENT:return this.parseMathFunctionComponent(t);case h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT:return this.parseMultiOperatorComponent(t);case h.ExpressionTreeTypes.TYPE_EXPONENT_COMPONENT:return this.parseExponentComponent(t);case h.ExpressionTreeTypes.TYPE_GROUP_COMPONENT:return this.parseBaseGroupComponent(t);case h.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT:return this.parseUnaryOperatorComponent(t);case h.ExpressionTreeTypes.TYPE_EQUALS_COMPONENT:return this.parseEqualsComponent(t);case h.ExpressionTreeTypes.TYPE_ARROW_COMPONENT:return this.parseArrowComponent(t);case h.ExpressionTreeTypes.TYPE_OR_COMPONENT:return this.parseBaseGroupComponent(t)}return!0}},{key:"parseMathFunctionComponent",value:function parseMathFunctionComponent(t){var r=t.child;if(r instanceof p.BaseGroupComponent){var o=r;if(0==o.numberOfChildren)return o.addChild(m.MathEntityComponent.generatePlaceholderComponent()),!1}if(this.anySimplification&&this.evaluateFunctions&&null!=r&&null!=t.parent){var i=t.evaluateIfNumeric();if(!isNaN(i))return t.parent.replaceChild(t,new d.NumberComponent(i)),!1}return!0}},{key:"applyAddSubtractOperatorComponentActions",value:function applyAddSubtractOperatorComponentActions(t){var r,o,i,a=this,p=!1,l=t.parent;if(1==t.numberOfChildren){if(r=t.getChildAtPosition(0),!t.getChildOperationType(r))return t.removeChild(r),l&&l.replaceChild(t,r),!0;if(l instanceof E.MultiOperatorComponent&&l.subtype==E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE)return t.removeChild(r),l&&l.replaceChild(t,r),o=new g.UnaryOperatorComponent(null,v.UnaryOperatorComponentSubtypes.MINUS),l.parent.implementsInterface("IParentComponent")&&l.parent.replaceChild(l,o),o.setChild(l),o.compile(this),!0}if(this.numericSimplification&&null!=l){var u=y.MultiOperatorComponentHelper.identifyNumericDivisionFactorInPlusMinusComponent(t,!0);if(1!=u)return(i=new E.MultiOperatorComponent(E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE)).addChild(new d.NumberComponent(u),!0),i.addChild(t,!1),l.replaceChild(t,i),!0;var c=y.MultiOperatorComponentHelper.identifyCommonNumericMultiplicationFactorInPlusMinusComponent(t,!0);if(1!=c)return(i=new E.MultiOperatorComponent(E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE)).addChild(new d.NumberComponent(c),!1),i.addChild(t,!1),l.replaceChild(t,i),!0}if(this.groupLikeTerms){if(y.MultiOperatorComponentHelper.algebraicSimplifyPlusMinusComponent(t,(function(t,r){return a.comparer.compare(t,r)})))return!0;if(y.MultiOperatorComponentHelper.isolateCommonAlgebraicFactorsInPlusMinusComponent(t,(function(t,r){return a.comparer.compare(t,r)})))return!0}return t.sortChildren((function(t,r){return a.comparer.compare(t,r)})),this.makeMultiOperatorComponentMostPositive(t)&&(o=new g.UnaryOperatorComponent(null,v.UnaryOperatorComponentSubtypes.MINUS),l&&l.replaceChild(t,o),o.setChild(t),p=!0),p}},{key:"applyMultiplyDivideOperatorComponentActions",value:function applyMultiplyDivideOperatorComponentActions(t){var r=this,o=t.parent;if(1==t.numberOfChildren&&null!=o){var i=t.getChildAtPosition(0);if(!t.getChildOperationType(i))return t.removeChild(i),o.replaceChild(t,i),!0;if(i instanceof d.NumberComponent){var a=new d.NumberComponent(1/i.value);return o.replaceChild(t,a),!0}}return!(!this.groupLikeTerms||null==o||!y.MultiOperatorComponentHelper.groupIdenticalFactorsInMultiplyDivideComponent(t,(function(t,o){return r.comparer.compare(t,o)})))||(t.sortChildren((function(t,o){return r.comparer.compare(t,o)})),!1)}},{key:"parseMultiOperatorComponent",value:function parseMultiOperatorComponent(t){var r,o=!1,i=t.parent,a=t.subtype==E.MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT?this.addSubtractRearrangements:this.multiplyDivideRearrangements;if(this.anySimplification){if(this.numericSimplification&&t.normaliseNumericValues(this.comparer),0==t.numberOfChildren&&null!=i)return i.removeChild(t),!0;if(a){if(i instanceof E.MultiOperatorComponent&&(r=i,t.subtype==r.subtype)){var p=r.getChildOperationType(t),l=r.getPositionOfChild(t);r.removeChild(t);var u,c=_createForOfIteratorHelper(t.getAllChildren());try{for(c.s();!(u=c.n()).done;){var h=u.value,m=p!=t.getChildOperationType(h);t.removeChild(h),r.addChild(h,m,l),l++}}catch(t){c.e(t)}finally{c.f()}return t.subtype==E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE&&r.multiplicationDisplayType!=t.multiplicationDisplayType&&(r.multiplicationDisplayType=E.MultiOperatorComponent.MULTIPLICATION_DISPLAY_TYPE_AUTOMATIC),!0}switch(t.subtype){case E.MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT:o=o||this.applyAddSubtractOperatorComponentActions(t);break;case E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE:o=o||this.applyMultiplyDivideOperatorComponentActions(t)}}}return!o}},{key:"parseExponentComponent",value:function parseExponentComponent(t){var r=!1,o=t.parent;if(this.anySimplification){if(null==t.exponent&&null!=o)return o.replaceChild(t,t.base),t.base=null,!1;if(this.simplifyExponents&&null!=o){if(t.exponent instanceof d.NumberComponent&&0==t.exponent.value&&this.numericSimplification)return o.replaceChild(t,new d.NumberComponent(1)),!1;if(t.exponent instanceof d.NumberComponent&&1==t.exponent.value)return o.replaceChild(t,t.base),!1}if(null!=o&&(this.numericSimplification||this.simplifyExponents)&&(r=r||t.normaliseNumericExponent()),this.numericSimplification&&null!=o){if(this.tryToEvaluateNumericExponentComponent(t))return!1;if(t.exponent instanceof d.NumberComponent){var i=t.exponent.value;if(t.base instanceof g.UnaryOperatorComponent&&t.base.subtype==v.UnaryOperatorComponentSubtypes.MINUS&&t.subtype==u.ExponentComponent.OPERATION_TYPE_EXPONENT){var a=t.base;return t.base=a.child,i%2!=0?(a.setChild(t),o.replaceChild(t,a)):a.setChild(null),!1}if(t.base instanceof E.MultiOperatorComponent&&t.base.subtype==E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE){var p=t.base,l=y.MultiOperatorComponentHelper.extractNumericChildFromMultiOperatorComponent(p);if(null!=l){var h=t.subtype==u.ExponentComponent.OPERATION_TYPE_EXPONENT?Math.pow(l.value,i):Math.pow(l.value,1/i);p.removeChild(l);var m=new E.MultiOperatorComponent(E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE);return m.addChild(new d.NumberComponent(h),!1),m.addChild(t,!1),o.replaceChild(t,m),!1}}}}if(this.simplifyExponents&&null!=o){if(t.exponent instanceof g.UnaryOperatorComponent&&t.exponent.subtype==v.UnaryOperatorComponentSubtypes.MINUS){var T=t.exponent;if(!(T.child instanceof u.ExponentComponent)){var C=new E.MultiOperatorComponent(E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE);return o.replaceChild(t,C),C.addChild(t,!0),t.exponent=T.child,T.setChild(null),!1}}if(c.ExponentComponentHelper.mergeWithParentIfAlsoExponent(t))return!1;if(c.ExponentComponentHelper.splitOutMultiplyDivide(t))return!1}}return!r}},{key:"tryToEvaluateNumericExponentComponent",value:function tryToEvaluateNumericExponentComponent(t){var r=t.base,o=t.exponent,i=t.parent;if(!(r instanceof d.NumberComponent)||null==i)return!1;var a,p=r.value,l=!1;if(o instanceof d.NumberComponent)a=o.value;else{if(!(o.type==h.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT&&o.subtype==v.UnaryOperatorComponentSubtypes.MINUS&&o.child instanceof d.NumberComponent))return!1;l=!0,a=o.child.value}t.subtype==u.ExponentComponent.OPERATION_TYPE_ROOT&&(a=1/a);var c=Math.pow(p,a);return l&&(c=1/c),i.replaceChild(t,new d.NumberComponent(c)),!0}},{key:"parseBaseGroupComponent",value:function parseBaseGroupComponent(t){var r,o=this,i=t.parent;if(!t.operatorsExtracted){if((r=t.getAllChildren()).length>1&&(this.anySimplification&&this.makeMixedFractionsExplicitForStream(r),this.createOperatorComponents(r)),t.removeAllChildren(),t.subtype==p.BaseGroupComponent.GROUP_TYPE_SQUARE_BRACKETS||1!=r.length||null==i||!this.anySimplification&&t.bracketIsUnmatched){var a,l=_createForOfIteratorHelper(r);try{for(l.s();!(a=l.n()).done;){var u=a.value;t.addChild(u),u.compiled=!1}}catch(t){l.e(t)}finally{l.f()}}else i.replaceChild(t,r[0]),r[0].compiled=!1;return 0==t.numberOfChildren&&t.subtype==p.BaseGroupComponent.GROUP_TYPE_ROUND_BRACKETS&&t.addChild(m.MathEntityComponent.generatePlaceholderComponent()),!1}if(R.MathParserHelper.removeEmptyGroupsFromTree(t),this.anySimplification){var c=t.numberOfChildren;if(c<=1&&null!=i&&t.subtype!=p.BaseGroupComponent.GROUP_TYPE_SQUARE_BRACKETS){if(0==c&&i.removeChild(t),1==c){var h=t.getChildAtPosition(0);t.removeChild(h),i.replaceChild(t,h)}return!0}t.sortChildren((function(t,r){return o.comparer.compare(t,r)}))}return!0}},{key:"parseUnaryOperatorComponent",value:function parseUnaryOperatorComponent(t){var r,o,i=t.parent,a=t.child;if(t.subtype==v.UnaryOperatorComponentSubtypes.PLUS_MINUS&&i instanceof E.MultiOperatorComponent&&(r=i).subtype==E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE&&null!=i.parent)return r.replaceChild(t,a),t.setChild(null),i.parent.replaceChild(i,t),t.setChild(i),!1;if(this.anySimplification)if(t.subtype==v.UnaryOperatorComponentSubtypes.PLUS&&i.replaceChild(t,t.child),t.subtype==v.UnaryOperatorComponentSubtypes.MINUS){if(i instanceof g.UnaryOperatorComponent&&i.subtype==v.UnaryOperatorComponentSubtypes.MINUS&&null!=i.parent)return t.setChild(null),i.setChild(null),i.parent.replaceChild(i,a),!0;if(i instanceof E.MultiOperatorComponent){if((r=i).subtype==E.MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT)return o=r.getChildOperationType(t),t.setChild(null),r.removeChild(t),r.addChild(a,!o),!0;if(r.subtype==E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE&&null!=i.parent)return r.replaceChild(t,a),t.setChild(null),i.parent.replaceChild(i,t),t.setChild(i),!1}}else if(t.subtype==v.UnaryOperatorComponentSubtypes.PLUS_MINUS){if(i instanceof g.UnaryOperatorComponent&&i.subtype==v.UnaryOperatorComponentSubtypes.MINUS&&null!=i.parent)return i.parent.replaceChild(i,t),i.setChild(null),!0;if(i instanceof E.MultiOperatorComponent&&(r=i).subtype==E.MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT&&(o=r.getChildOperationType(t)))return r.setChildOperationType(t,!1),!1}return!0}},{key:"parseEqualsComponent",value:function parseEqualsComponent(t){var r=this;if(R.MathParserHelper.removeEmptyGroupsFromTree(t),this.anySimplification){t.sortChildren((function(t,o){return r.comparer.compare(t,o)}));var o=t.getAllChildren();if(o.length<2)return!0;var i,a,p,l=o[0],u=o[1];if(null!=l&&null!=u){if(l.type==u.type&&l.subtype==u.subtype)switch(l.type){case h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT:if(this.equalsMovements&&(l.subtype==E.MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT&&this.addSubtractRearrangements||l.subtype==E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE&&this.multiplyDivideRearrangements)){l.merge(u,!0);var c=l.subtype==E.MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT?0:1;return t.replaceChild(u,new d.NumberComponent(c)),!1}break;case h.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT:if(l.subtype==v.UnaryOperatorComponentSubtypes.MINUS&&(this.allowInvertedSigns||this.numericSimplification))return t.replaceChild(l,l.child),l.setChild(null),t.replaceChild(u,u.child),u.setChild(null),t.invertEqualsSign(),!1}if(l.type==h.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT){var m=l.value;if(0==m){if(this.allowInvertedSigns||this.numericSimplification){if(u.type==h.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT&&u.subtype==v.UnaryOperatorComponentSubtypes.MINUS)return t.replaceChild(u,u.child),t.invertEqualsSign(),!1;u.type==h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&u.subtype==E.MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT&&this.makeMultiOperatorComponentMostPositive(u)&&t.invertEqualsSign()}return!0}if(1==m){if(u.type==h.ExpressionTreeTypes.TYPE_NUMBER_COMPONENT||u.type==h.ExpressionTreeTypes.TYPE_MATH_ENTITY_COMPONENT||u.type==h.ExpressionTreeTypes.TYPE_MATH_FUNCTION_COMPONENT)return!0;if(u.type==h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&u.subtype==E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE)return!this.makeMultiOperatorComponentMostPositive(u);if(u.type==h.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT&&u.subtype==v.UnaryOperatorComponentSubtypes.MINUS){var T=u;if(T.child&&T.child.type==h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&T.child.subtype==E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE)return!this.makeMultiOperatorComponentMostPositive(T.child)}}}if(this.equalsMovements)switch(this.normaliseEqualsMode){case MathParser.NORMALISE_EQUALS_MODE_AUTO:if(l.type==h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT||u.type==h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT){var y,C=o[y=l.type==h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&u.type==h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT?Number(u.subtype==E.MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT):Number(u.type==h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT)];a=o[1-y],C.addChild(a,!0);var _=E.MultiOperatorComponent.generateDefaultValueForOperation(C.subtype);return t.replaceChild(a,new d.NumberComponent(_)),!1}break;case MathParser.NORMALISE_EQUALS_MODE_ADDITION:case MathParser.NORMALISE_EQUALS_MODE_MULTIPLICATION:var O;if(this.normaliseEqualsMode==MathParser.NORMALISE_EQUALS_MODE_ADDITION){if(O=E.MultiOperatorComponent.OPERATION_TYPE_ADD_SUBTRACT,!this.addSubtractRearrangements)break}else if(O=E.MultiOperatorComponent.OPERATION_TYPE_MULTIPLY_DIVIDE,!this.multiplyDivideRearrangements)break;var g=-1;for(p=0;p<2;p++)if(o[p].type==h.ExpressionTreeTypes.TYPE_MULTI_OPERATOR_COMPONENT&&o[p].subtype==O){g=p;break}if(-1!=g)return i=o[g],a=o[1-g],t.replaceChild(a,new d.NumberComponent(E.MultiOperatorComponent.generateDefaultValueForOperation(O))),i.addChild(a,!0),this.normaliseEqualsMode==MathParser.NORMALISE_EQUALS_MODE_MULTIPLICATION&&a.type==h.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT&&a.subtype==v.UnaryOperatorComponentSubtypes.MINUS&&t.invertEqualsSign(),!1;var P=new E.MultiOperatorComponent(O);return t.replaceChild(l,new d.NumberComponent(E.MultiOperatorComponent.generateDefaultValueForOperation(O))),t.replaceChild(u,P),P.addChild(u,!1),P.addChild(l,!0),this.normaliseEqualsMode==MathParser.NORMALISE_EQUALS_MODE_MULTIPLICATION&&l.type==h.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT&&l.subtype==v.UnaryOperatorComponentSubtypes.MINUS&&t.invertEqualsSign(),!1}if(this.allowInvertedSigns||this.numericSimplification){var S=-1;for(p=0;p<2;p++)o[p].type==h.ExpressionTreeTypes.TYPE_UNARY_OPERATOR_COMPONENT&&o[p].subtype==v.UnaryOperatorComponentSubtypes.MINUS&&(S=p);if(-1!=S){var M=o[S];if(a=o[1-S],this.comparer.compare(M.child,a)>=0){var x=M.child;return t.replaceChild(a,x),M.replaceChild(x,a),!1}}}}}return!0}},{key:"parseArrowComponent",value:function parseArrowComponent(t){var r=this;return R.MathParserHelper.removeEmptyGroupsFromTree(t),this.anySimplification&&t.sortChildren((function(t,o){return r.comparer.compare(t,o)})),!0}},{key:"makeMultiOperatorComponentMostPositive",value:function makeMultiOperatorComponentMostPositive(t){var r,o=t.getAllChildren(),i=0,a=_createForOfIteratorHelper(o);try{for(a.s();!(r=a.n()).done;){var p=r.value;1==t.getChildOperationType(p)&&i++}}catch(t){a.e(t)}finally{a.f()}var l=!1;if(i==Number(o.length)/2){var u=t.getChildAtPosition(0);u instanceof d.NumberComponent&&o.length>1&&!(t.getChildAtPosition(1)instanceof d.NumberComponent)&&(u=t.getChildAtPosition(1)),1==t.getChildOperationType(u)&&(l=!0)}else i>Number(o.length)/2&&(l=!0);return l&&t.invertAllOperatorTypes(),l}},{key:"toJSON",value:function toJSON(){var t=this,r=["NORMALISE_EQUALS_MODE_NONE","NORMALISE_EQUALS_MODE_ADDITION","NORMALISE_EQUALS_MODE_MULTIPLICATION","NORMALISE_EQUALS_MODE_AUTO"];return["_caseSensitive","addSubtractRearrangements","allowInvertedSigns","anySimplification","atomiseVariables","autoCloseBrackets","evaluateFunctions","evaluateMathsConstantsAsNumbers","expansionOfBrackets","groupLikeTerms","lastCompileHasErrors","multiplyDivideRearrangements","numericSimplification","simplifyExponents","unfilteredMathConstants","unfilteredMathFunctions","workingExpressionTree","equalsMovements"].map((function(o){return"normaliseEqualsMode"===o?[o,r[t[o]]]:"boolean"==typeof t[o]?t[o]?[o,t[o]]:void 0:[o,t[o]]}))}}],[{key:"createStringFromExpressionTreeComponents",value:function createStringFromExpressionTreeComponents(t){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:":",p=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"_",l=a,u=_createForOfIteratorHelper(t);try{for(u.s();!(r=u.n()).done;){var c=r.value;l+=MathParser.createComponentTypeRepresentationString(c.type,c.subtype,o,i,p)+a}}catch(t){u.e(t)}finally{u.f()}return l}},{key:"createComponentTypeRepresentationString",value:function createComponentTypeRepresentationString(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"_",p=k.StringUtilMath.padStartOfStringWithZeros(t.toString(),o),l=r==MathParser.MATCH_ANY_SUBTYPE?"......................".substr(0,i):k.StringUtilMath.padStartOfStringWithZeros(r.toString(),i);return p+a+l}},{key:"cloneExpressionTreeItems",value:function cloneExpressionTreeItems(t){var r,o=[],i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;o.push(a.clone())}}catch(t){i.e(t)}finally{i.f()}return o}}]),MathParser}();r.MathParser=I,I.zerosString="00000000000",I.MATCH_ANY_SUBTYPE=98765,I.NORMALISE_EQUALS_MODE_NONE=0,I.NORMALISE_EQUALS_MODE_ADDITION=1,I.NORMALISE_EQUALS_MODE_MULTIPLICATION=2,I.NORMALISE_EQUALS_MODE_AUTO=3},6415:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MathParserConfigurationHelper=void 0;var i=o(252),a=o(8818),p=o(7076),l=o(3597),u=o(9884),c=function(){function MathParserConfigurationHelper(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MathParserConfigurationHelper)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathParserConfigurationHelper,null,[{key:"configureParser",value:function configureParser(t,r){t.autoCloseBrackets=!isNaN(r.AutoCloseBrackets)&&Boolean(r.AutoCloseBrackets),t.addSubtractRearrangements=!!isNaN(r.AddSubtractRearrangements)||Boolean(r.AddSubtractRearrangements),t.multiplyDivideRearrangements=!!isNaN(r.MultiplyDivideRearrangements)||Boolean(r.MultiplyDivideRearrangements),t.equalsMovements=!!isNaN(r.EqualsMovements)||Boolean(r.EqualsMovements),t.numericSimplification=!!isNaN(r.NumericSimplification)||Boolean(r.NumericSimplification),t.allowInvertedSigns=!!isNaN(r.AllowInvertedSigns)||Boolean(r.AllowInvertedSigns),t.groupLikeTerms=!isNaN(r.GroupLikeTerms)&&Boolean(r.GroupLikeTerms),t.expansionOfBrackets=!isNaN(r.ExpansionOfBrackets)&&Boolean(r.ExpansionOfBrackets),t.caseSensitive=!isNaN(r.CaseSensitive)&&Boolean(r.CaseSensitive)}},{key:"getDefaultUnmarkedStepFormulaMarkingParameters",value:function getDefaultUnmarkedStepFormulaMarkingParameters(){return{AnySimplification:1,AutoCloseBrackets:0,AddSubtractRearrangements:1,MultiplyDivideRearrangements:1,EqualsMovements:1,NumericSimplification:1,GroupLikeTerms:0,ExpansionOfBrackets:0,SimplifyExponents:1,CaseSensitive:0,Synonyms:[],CustomFunctions:[],ShowImmediateFeedback:1,ShowHints:1,MaxHints:0,AutoGenerateLHSVariants:1,AllowInvertedSigns:1,StringMatchMode:0}}},{key:"getDefaultMarkedStepFormulaMarkingParameters",value:function getDefaultMarkedStepFormulaMarkingParameters(){return{AnySimplification:1,AutoCloseBrackets:0,AddSubtractRearrangements:1,MultiplyDivideRearrangements:1,EqualsMovements:1,NumericSimplification:1,GroupLikeTerms:0,ExpansionOfBrackets:0,SimplifyExponents:1,CaseSensitive:0,Synonyms:[],CustomFunctions:[],ShowImmediateFeedback:1,ShowHints:1,MaxHints:0,AutoGenerateLHSVariants:1,AllowInvertedSigns:0,StringMatchMode:0}}},{key:"transferConfigurationParameters",value:function transferConfigurationParameters(t,r){isNaN(t.AutoCloseBrackets)||null==t.AutoCloseBrackets||(r.AutoCloseBrackets=t.AutoCloseBrackets),isNaN(t.AddSubtractRearrangements)||null==t.AutoCloseBrackets||(r.AddSubtractRearrangements=t.AddSubtractRearrangements),isNaN(t.MultiplyDivideRearrangements)||null==t.MultiplyDivideRearrangements||(r.MultiplyDivideRearrangements=t.MultiplyDivideRearrangements),isNaN(t.EqualsMovements)||null==t.EqualsMovements||(r.EqualsMovements=t.EqualsMovements),isNaN(t.NumericSimplification)||null==t.NumericSimplification||(r.NumericSimplification=t.NumericSimplification),isNaN(t.GroupLikeTerms)||null==t.GroupLikeTerms||(r.GroupLikeTerms=t.GroupLikeTerms),isNaN(t.ExpansionOfBrackets)||null==t.ExpansionOfBrackets||(r.ExpansionOfBrackets=t.ExpansionOfBrackets),isNaN(t.CaseSensitive)||null==t.CaseSensitive||(r.CaseSensitive=t.CaseSensitive),null!=t.Synonyms&&(r.Synonyms=t.Synonyms.concat()),null!=t.CustomFunctions&&(r.CustomFunctions=t.CustomFunctions.concat()),isNaN(t.ShowImmediateFeedback)||null==t.ShowImmediateFeedback||(r.ShowImmediateFeedback=t.ShowImmediateFeedback),isNaN(t.ShowHints)||null==t.ShowHints||(r.ShowHints=t.ShowHints),isNaN(t.MaxHints)||null==t.MaxHints||(r.MaxHints=t.MaxHints),isNaN(t.AutoGenerateLHSVariants)||null==t.AutoGenerateLHSVariants||(r.AutoGenerateLHSVariants=t.AutoGenerateLHSVariants),!isNaN(t.AllowInvertedSigns)&&t.AllowInvertedSigns>=0&&(r.AllowInvertedSigns=t.AllowInvertedSigns),!isNaN(t.StringMatchMode)&&t.StringMatchMode>=0&&(r.StringMatchMode=t.StringMatchMode)}},{key:"configureExpressionTreeComparer",value:function configureExpressionTreeComparer(t,r){r?(t.applyAcceptableError=!0,t.roundingType=p.AnswerRoundingHelper.getByTypeCode(r.RoundingTypeCode),t.roundingAmount=r.RoundingAmount,t.acceptableErrorType=l.MarginErrorHelper.getByTypeCode(r.AcceptableErrorTypeCode),t.acceptableMarginValue=r.AcceptableErrorValue,t.autoRoundUsersAnswer=r.RoundUsersAnswer):t.applyAcceptableError=!1}},{key:"getDefaultComparisonParameters",value:function getDefaultComparisonParameters(){return{RoundingAmount:0,RoundingTypeCode:"",AcceptableErrorValue:0,AcceptableErrorTypeCode:"",RoundUsersAnswer:!1}}},{key:"transferComparisonParameters",value:function transferComparisonParameters(t,r){null!=t&&null!=r&&(isNaN(t.RoundingAmount)||null==t.RoundingAmount||(r.RoundingAmount=t.RoundingAmount),null!=t.RoundingTypeCode&&(r.RoundingTypeCode=t.RoundingTypeCode),isNaN(t.AcceptableErrorValue)||null==t.AcceptableErrorValue||(r.AcceptableErrorValue=t.AcceptableErrorValue),null!=t.AcceptableErrorTypeCode&&(r.AcceptableErrorTypeCode=t.AcceptableErrorTypeCode),null!=t.RoundUsersAnswer&&(r.RoundUsersAnswer=t.RoundUsersAnswer))}},{key:"generateCustomFunctionItemsFromParameters",value:function generateCustomFunctionItemsFromParameters(t){var r=[];return null==t.CustomFunctions||t.CustomFunctions.forEach((function(t){return r.push(new u.MathEntityMatchInfo(t,new a.MathFunctionComponent(null,t)))})),r}},{key:"generateSynonymItemsForComparisonFromParameters",value:function generateSynonymItemsForComparisonFromParameters(t){var r=[];if(null==t.Synonyms)return r;for(var o=0;o<t.Synonyms.length;o++){var a=t.Synonyms[o],p=a.DefaultRepresentation;r.push(new u.MathEntityMatchInfo(p,new i.MathEntityComponent(p)));for(var l=0;l<a.AlternateRepresentations.length;l++){var c=a.AlternateRepresentations[l];r.push(new u.MathEntityMatchInfo(c,new i.MathEntityComponent(p)))}}return r}},{key:"generateSynonymItemsForDisplayFromParameters",value:function generateSynonymItemsForDisplayFromParameters(t){var r=[];if(null==t.Synonyms)return r;for(var o=0;o<t.Synonyms.length;o++){var a=t.Synonyms[o],p=a.DefaultRepresentation;r.push(new u.MathEntityMatchInfo(p,new i.MathEntityComponent(p)));for(var l=0;l<a.AlternateRepresentations.length;l++){var c=a.AlternateRepresentations[l];r.push(new u.MathEntityMatchInfo(c,new i.MathEntityComponent(c)))}}return r}}]),MathParserConfigurationHelper}();r.MathParserConfigurationHelper=c},5797:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MathParserHelper=void 0;var i=o(5099),a=o(2178),p=o(252),l=o(8818),u=o(9837),c=o(3721),h=o(4882),m=o(5223),T=function(){function MathParserHelper(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MathParserHelper)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MathParserHelper,null,[{key:"mergeExplicitBrackets",value:function mergeExplicitBrackets(t,r,o){var a=r[t],p=t+1<r.length?r[t+1]:null;switch(a&&a.originalString){case"left":p&&p instanceof i.BaseGroupComponent&&(p.explicitBrackets=!0);break;case"right":break;default:return!1}return o.removeChild(r.splice(t,1)[0]),!0}},{key:"rearrangedFunctionNumericExponent",value:function rearrangedFunctionNumericExponent(t,r,o){var p=r[t]instanceof l.MathFunctionComponent?r[t]:null;if(p&&t+2<r.length&&r[t+1].type==m.ExpressionTokenTemplate.TYPE_OPERATOR&&r[t+1].subtype==m.ExpressionTokenTemplate.SUBTYPE_POWER){var u=(r[t+2],i.BaseGroupComponent,r[t+2]);if(u instanceof i.BaseGroupComponent&&2==u.children.length&&u.children[0].type==m.ExpressionTokenTemplate.TYPE_OPERATOR&&u.children[0].subtype==m.ExpressionTokenTemplate.SUBTYPE_MINUS&&u.children[1].type==m.ExpressionTokenTemplate.TYPE_NUMERICAL_VALUE&&"1"==u.children[1].originalString&&p.canInvertFunction)return p.invertFunction(),r.splice(t+1,2).forEach((function(t){return o.removeChild(t)})),!0;if(u.type==m.ExpressionTokenTemplate.TYPE_NUMERICAL_VALUE){MathParserHelper.mergeExplicitBrackets(t+3,r,o);var h=u,T=new c.NumberComponent(+h.originalString,h.originalString),E=new a.ExponentComponent(p,T,a.ExponentComponent.OPERATION_TYPE_EXPONENT);return o.replaceChild(p,E),r[t]=E,r.splice(t+1,2).forEach((function(t){return o.removeChild(t)})),!0}}return!1}},{key:"matchTokenStream",value:function matchTokenStream(t,r,o){for(var i=0;i<o.length;i+=1){var a=o[i],p=t+i<r.length?r[t+i]:null;if(!p||a.type!=p.type||null!=a.subtype&&a.subtype!=p.subtype)return!1}return!0}},{key:"removeEmptyGroupsFromTree",value:function removeEmptyGroupsFromTree(t){var r=!1;if(!t.parent)for(var o=MathParserHelper.getAllDescendantsOfParentComponent(t),l=o.length-1;l>=0;l-=1){var c=o[l];if(c.parent instanceof h.SubscriptSuperscriptComponent||c.parent instanceof a.ExponentComponent||c.parent instanceof u.MultiOperatorComponent){var m=c instanceof i.BaseGroupComponent?c:null,T=c instanceof p.MathEntityComponent?c:null,E=m&&0==m.numberOfChildren,y=m&&1==m.numberOfChildren&&m.children[0]instanceof p.MathEntityComponent&&m.children[0].isPlaceholder,d=T&&T.isPlaceholder;(E||y||d)&&(c.parent.removeChild(c),r=!0)}if(c.parent&&c.parent.parent){var C=c.parent,_=C.parent,O=C instanceof a.ExponentComponent||C instanceof h.SubscriptSuperscriptComponent?C:null,g=_ instanceof a.ExponentComponent||_ instanceof h.SubscriptSuperscriptComponent?_:null;O&&g&&(!O.base||O.base instanceof p.MathEntityComponent&&O.base.isPlaceholder)&&(_.replaceChild(C,c),r=!0),C instanceof u.MultiOperatorComponent&&1==C.children.length&&0==C.getChildOperationType(C.children[0])&&_.implementsInterface("IParentComponent")&&_.replaceChild(C,c)}}return r}},{key:"getAllDescendantsOfParentComponent",value:function getAllDescendantsOfParentComponent(t){for(var r=[],o=t.getAllChildren(),i=o.length,a=0;a<i;a+=1){var p=o[a];r.push(p),p.implementsInterface("IParentComponent")&&(r=r.concat(MathParserHelper.getAllDescendantsOfParentComponent(p)))}return r}}]),MathParserHelper}();r.MathParserHelper=T},3728:(t,r)=>{function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}Object.defineProperty(r,"__esModule",{value:!0}),r.GuidUtilMath=void 0,function(t){t.create=function create(){return"".concat(s4()+s4(),"-").concat(s4(),"-").concat(s4(),"-").concat(s4(),"-").concat(s4()).concat(s4()).concat(s4())},t.createNoHyphens=function createNoHyphens(){return s4()+s4()+s4()+s4()+s4()+s4()+s4()+s4()}}(r.GuidUtilMath||(r.GuidUtilMath={}))},4808:(t,r)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.LatexUtil=void 0;var o=function(){function LatexUtil(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,LatexUtil)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(LatexUtil,null,[{key:"isBoundedByRoundBrackets",value:function isBoundedByRoundBrackets(t){if(null==t||""==t)return!1;var r=t.trim();return""!=r&&("("==r.charAt(0)||"\\left("==r.substr(0,6))}},{key:"addBracketsAroundLatex",value:function addBracketsAroundLatex(t){return"\\left(".concat(t,"\\right)")}},{key:"latexIsKnownFunction",value:function latexIsKnownFunction(t){return-1!=this.latexFunctions.indexOf(t)}},{key:"replaceSpecialCharactersWithLatexCodes",value:function replaceSpecialCharactersWithLatexCodes(t){var r=this.latexCharacterLookups[t];return null!=r?"".concat(r," "):t}}]),LatexUtil}();r.LatexUtil=o,o.latexFunctions=["sin","cos","tan","sec","cosec","cot","arcsin","arccos","arctan","sinh","cosh","tanh","log","ln"],o.latexCharacterLookups={"α":"\\alpha","β":"\\beta","γ":"\\gamma","δ":"\\delta","ε":"\\epsilon","ζ":"\\zeta","η":"\\eta","θ":"\\theta","ι":"\\iota","κ":"\\kappa","λ":"\\lambda","μ":"\\mu","ν":"\\nu","ξ":"\\xi","π":"\\pi","ρ":"\\rho","σ":"\\sigma","τ":"\\tau","υ":"\\upsilon","φ":"\\phi","χ":"\\chi","ψ":"\\psi","ω":"\\omega","Γ":"\\Gamma","∆":"\\Delta","Δ":"\\Delta","Θ":"\\Theta","Λ":"\\Lambda","Ξ":"\\Xi","Π":"\\Pi","Σ":"\\Sigma","Υ":"\\Upsilon","Φ":"\\Phi","Ψ":"\\Psi","Ω":"\\Omega",$:"\\$","°":"\\degree","∠":"\\angle","%":"\\%","÷":"\\div","-:":"\\div","∈":"\\in","≡":"\\equiv","≈":"\\approx","≠":"\\neq","≅":"\\cong","∑":"\\sum","∞":"\\infty","∩":"\\cap","∪":"\\cup","⊥":"\\perp","∫":"\\int","∅":"\\emptyset","△":"\\triangle"}},3648:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.round=r.factorial=r.findCommonDecimalFactor=r.findHighestFactor=r.findHighestCommonWholeNumberFactor=void 0;var o=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101].reverse();r.findHighestCommonWholeNumberFactor=function findHighestCommonWholeNumberFactor(t){var r=t.length;if(r<=1)return 1;for(var i=o,a=0;a<i.length;a++){for(var p=i[a],l=!0,u=0;u<r;u++)if(t[u]%p!=0){l=!1;break}if(l&&p>1){for(var c=new Array(t.length),h=0;h<r;h++)c[h]=t[h]/p;return p*findHighestCommonWholeNumberFactor(c)}}return 1},r.findHighestFactor=function findHighestFactor(t){for(var r=o,i=0;i<r.length;i++)if(t%r[i]==0)return findHighestFactor(t/r[i]);return 1},r.findCommonDecimalFactor=function findCommonDecimalFactor(t){var r=t.length;if(r<=1)return 1;var o=t.concat();o.sort((function(t,r){return t-r}));for(var i=o[0],a=1;a<r;a++)if(o[a]%i!=0)return 1;return i},r.factorial=function factorial(t){for(var r=0,o=1;o<=t;o++)r+=o;return r},r.round=function round(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return+t.toFixed(r)}},9849:(t,r)=>{function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.StringMatcher=void 0;var o=function(){function StringMatcher(t){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,StringMatcher),this.indexedStrings=[],this.stringLengths=[];var r,o=function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}(t);try{for(o.s();!(r=o.n()).done;){var i=r.value,a=i.length,p=this.indexedStrings[a];null==p&&(p=[],this.indexedStrings[a]=p,this.stringLengths.push(a)),p.push(i)}}catch(t){o.e(t)}finally{o.f()}this.stringLengths.sort((function(t,r){return r-t}))}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(StringMatcher,[{key:"findBestMatch",value:function findBestMatch(t,r){switch(r){case StringMatcher.MATCH_TYPE_PARTIAL:return this.partialMatch(t);case StringMatcher.MATCH_TYPE_START:return this.fullMatchPartOfString(t,!1);case StringMatcher.MATCH_TYPE_END:return this.fullMatchPartOfString(t,!0);case StringMatcher.MATCH_TYPE_FULL:default:return this.fullMatch(t)}}},{key:"fullMatchPartOfString",value:function fullMatchPartOfString(t,r){for(var o=t.length,i=0;i<this.stringLengths.length;i++){var a=this.stringLengths[i];if(o>=a){var p,l=this.indexedStrings[a];p=r?t.substr(o-a,a):t.substr(0,a);var u=l.indexOf(p);if(-1!=u)return l[u]}}return""}},{key:"fullMatch",value:function fullMatch(t){var r=this.allStrings.indexOf(t);return-1!=r?this.allStrings[r]:""}},{key:"partialMatch",value:function partialMatch(t){for(var r=t.length,o=0;o<this.stringLengths.length;o++){var i=this.stringLengths[o];if(r>=i)for(var a=this.indexedStrings[i],p=0;p<a.length;p++){var l=a[p];if(-1!=t.indexOf(l))return l}}return""}}]),StringMatcher}();r.StringMatcher=o,o.MATCH_TYPE_FULL=1,o.MATCH_TYPE_START=2,o.MATCH_TYPE_END=4,o.MATCH_TYPE_PARTIAL=8},7809:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.StringUtilMath=void 0,function(t){t.ZEROES="00000000000",t.isNullOrEmpty=function isNullOrEmpty(t){return null==t||""==t},t.isNullOrWhitespace=function isNullOrWhitespace(r){return t.isNullOrEmpty(t.trim(r))},t.trim=function trim(t){return null==t?"":t.trim()},t.numberOfInstancesOfStringMatch=function numberOfInstancesOfStringMatch(t,r){for(var o=0,i=0,a=!1;!a;){var p=t.indexOf(r,i);if(-1==p){a=!0;break}o++,i=p+r.length}return o},t.padStartOfStringWithZeros=function padStartOfStringWithZeros(r,o){return t.padStringToLength(r,o,t.ZEROES,!0)},t.padStringToLength=function padStringToLength(t,r,o,i){var a=r-t.length;return a<=0?t.substr(0,r):i?o.substr(0,a)+t:t+o.substr(0,a)}}(r.StringUtilMath||(r.StringUtilMath={}))},7547:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.AbsoluteMarginErrorType=void 0;var i=o(8629),a=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(AbsoluteMarginErrorType,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(AbsoluteMarginErrorType);function AbsoluteMarginErrorType(){return function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,AbsoluteMarginErrorType),r.call(this,"Absolute",i.MarginErrorType.TYPE_ABSOLUTE)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(AbsoluteMarginErrorType,[{key:"getMinMaxRange",value:function getMinMaxRange(t,r){return{start:t-r,end:t+r}}}]),AbsoluteMarginErrorType}(i.MarginErrorType);r.AbsoluteMarginErrorType=a},7076:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.AnswerRoundingHelper=void 0;var i=o(803),a=o(7137),p=o(1964),l=function(){function AnswerRoundingHelper(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,AnswerRoundingHelper)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(AnswerRoundingHelper,null,[{key:"check",value:function check(t,r,o){if(null!=o&&o.code!=this.CODE_NONE){var i=AnswerRoundingHelper.cleanNumericString(t);return o.check(i,r)}return!0}},{key:"cleanNumericString",value:function cleanNumericString(t){return t.replace(/[-, ]/g,"")}},{key:"apply",value:function apply(t,r,o){if(null!=o&&o.code!=this.CODE_NONE){var i=t<0?-1:1;return t*=i,o.round(t,r)*i}return t}},{key:"getByTypeCode",value:function getByTypeCode(t){return t==this.CODE_NONE?AnswerRoundingHelper.NONE:t==this.CODE_DP?AnswerRoundingHelper.DEC_PLACES:t==this.CODE_SF?AnswerRoundingHelper.SIG_FIGURES:null}}]),AnswerRoundingHelper}();r.AnswerRoundingHelper=l,l.CODE_NONE="NONE",l.CODE_DP="DP",l.CODE_SF="SF",l.NONE=new i.AnswerRoundingType,l.DEC_PLACES=new a.DecimalPlacesAnswerRoundingType,l.SIG_FIGURES=new p.SignificantFiguresAnswerRoundingType},803:(t,r)=>{function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.AnswerRoundingType=void 0;var o=function(){function AnswerRoundingType(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"NONE",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NONE",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;_classCallCheck(this,AnswerRoundingType),this.code=t,this.description=r,this.offsetInaccurate=o,this.offsetAccurate=i}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(AnswerRoundingType,[{key:"check",value:function check(t,r){return!0}},{key:"round",value:function round(t,r){return t}},{key:"getRoundingErrorRange",value:function getRoundingErrorRange(t){var r=t-this.offsetInaccurate;r<0&&(r=0);var o=t+this.offsetAccurate;return o>15&&(o=0),{start:r,end:o}}},{key:"findDecimalPoint",value:function findDecimalPoint(t){var r=t.indexOf(".");return{found:-1!=r,index:r}}}]),AnswerRoundingType}();r.AnswerRoundingType=o},7137:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.DecimalPlacesAnswerRoundingType=void 0;var i=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(DecimalPlacesAnswerRoundingType,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(DecimalPlacesAnswerRoundingType);function DecimalPlacesAnswerRoundingType(){return function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,DecimalPlacesAnswerRoundingType),r.call(this,"DP","Decimal Places")}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(DecimalPlacesAnswerRoundingType,[{key:"check",value:function check(t,r){var o=this.findDecimalPoint(t);return 0==r?!o.found:-1!=o.index&&r==t.length-(o.index+1)}},{key:"round",value:function round(t,r){var o=t<0?-1:1;t*=o;var i=Math.pow(10,r);return Math.round(t*i)/i*o}}]),DecimalPlacesAnswerRoundingType}(o(803).AnswerRoundingType);r.DecimalPlacesAnswerRoundingType=i},1230:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0})},4860:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0})},3597:(t,r,o)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MarginErrorHelper=void 0;var i=o(7547),a=o(7076),p=o(9197),l=function(){function MarginErrorHelper(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MarginErrorHelper)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MarginErrorHelper,null,[{key:"withinMarginOfError",value:function withinMarginOfError(t,r,o,i,p,l,u){var c=t.getMinMaxRange(r,i),h=a.AnswerRoundingHelper.apply(c.start,p,l),m=a.AnswerRoundingHelper.apply(c.end,p,l);return u&&(o=a.AnswerRoundingHelper.apply(o,p,l)),h<=o&&o<=m}},{key:"getByTypeCode",value:function getByTypeCode(t){return t==MarginErrorHelper.ABSOLUTE.code?MarginErrorHelper.ABSOLUTE:t==MarginErrorHelper.PERCENT.code?MarginErrorHelper.PERCENT:null}}]),MarginErrorHelper}();r.MarginErrorHelper=l,l.ABSOLUTE=new i.AbsoluteMarginErrorType,l.PERCENT=new p.PercentMarginErrorType},8629:(t,r)=>{function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.MarginErrorType=void 0;var o=function(){function MarginErrorType(t,r){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,MarginErrorType),this.description=t,this.code=r}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(MarginErrorType,[{key:"getMinMaxRange",value:function getMinMaxRange(t,r){return{start:t,end:t}}}]),MarginErrorType}();r.MarginErrorType=o,o.TYPE_PERCENT="%",o.TYPE_ABSOLUTE="ABS"},9197:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.PercentMarginErrorType=void 0;var i=o(8629),a=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(PercentMarginErrorType,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(PercentMarginErrorType);function PercentMarginErrorType(){return function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,PercentMarginErrorType),r.call(this,"Percent",i.MarginErrorType.TYPE_PERCENT)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(PercentMarginErrorType,[{key:"getMinMaxRange",value:function getMinMaxRange(t,r){return{start:t*(1-r/100),end:t*(1+r/100)}}}]),PercentMarginErrorType}(i.MarginErrorType);r.PercentMarginErrorType=a},1964:(t,r,o)=>{function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(t){return typeof t}:function _typeof(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _setPrototypeOf(t,r){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(t,r){return t.__proto__=r,t})(t,r)}function _possibleConstructorReturn(t,r){return!r||"object"!==_typeof(r)&&"function"!=typeof r?function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):r}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.SignificantFiguresAnswerRoundingType=void 0;var i=function(t){!function _inherits(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&_setPrototypeOf(t,r)}(SignificantFiguresAnswerRoundingType,t);var r=function _createSuper(t){var r=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}(SignificantFiguresAnswerRoundingType);function SignificantFiguresAnswerRoundingType(){var t;return function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,SignificantFiguresAnswerRoundingType),(t=r.call(this)).code="SF",t.description="Significant Figures",t}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(SignificantFiguresAnswerRoundingType,[{key:"check",value:function check(t,r){var o,i=this.findDecimalPoint(t);if(r>0)if(i.found){var a=Number(t),p=t.substring(0,i.index),l=t.substring(i.index+1,t.length);o=(a<1?l.length+Math.floor(Math.LOG10E*Math.log(a))+1:p.length+l.length)==r}else if(t.length<r)o=!1;else{var u=".".concat(t.split("").reverse().join("")),c=parseFloat(u);o=u.length-1+Math.floor(Math.LOG10E*Math.log(c))+1<=r}else o=0==t.length;return o}},{key:"round",value:function round(t,r){if(0==t)return 0;var o=Math.pow(10,r-Math.floor(Math.LOG10E*Math.log(t))-1);return Math.round(t*o)/o}}]),SignificantFiguresAnswerRoundingType}(o(803).AnswerRoundingType);r.SignificantFiguresAnswerRoundingType=i},8181:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.ParserStrictnessScoringInfo=void 0,r.ParserStrictnessScoringInfo=function ParserStrictnessScoringInfo(t,r,o){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,ParserStrictnessScoringInfo),this.parser=t,this.score=r,this.correctness=o}},8351:(t,r,o)=>{function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.StringComparer=void 0;var i=o(8125),a=o(7722),p=function(){function StringComparer(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,StringComparer)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(StringComparer,[{key:"preCompileStaticSteps",value:function preCompileStaticSteps(){return this.workingStepCompiledTrees}},{key:"compareSteps",value:function compareSteps(t,r,o){var i=this,p=[];this.workingStepCorrectness={},this.workingStepComparisonScores={},t.reduce((function(t,r){return t.concat(r)}),[]).forEach((function(t){i.workingStepCorrectness[t.id]=a.WorkingStepComparison.CORRECTNESS_INCORRECT}));var l=0,u=!0;return t.forEach((function(t,o){r.forEach((function(r){var o={},p=0,l=a.WorkingStepComparison.CORRECTNESS_INCORRECT;t.forEach((function(t){var u=t.getFormulas(),c=a.WorkingStepComparison.CORRECTNESS_INCORRECT,h=0;u.some((function(u){return u.replace(/ /g,"")===r.formula.replace(/ /g,"")&&((h=1)>p&&(p=h),l=a.WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT,o[t.id]=h,i.workingStepCorrectness[t.id]=a.WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT,!0)}))||(o[t.id]=h,c>i.workingStepCorrectness[t.id]&&(i.workingStepCorrectness[t.id]=c))})),i.workingStepCorrectness[r.id]=l,i.workingStepComparisonScores[r.id]=o}));var c=i.compareResultsByScore(o,t,r),h=c.optionsTotalScore,m=c.optionOutput;(u||h>l)&&(p=m,l=h),u=!1})),p}},{key:"compareResultsByScore",value:function compareResultsByScore(t,r,o){var p=this,l=[],u=0,c=i.VectorComparer.FindBestOffsetSetForPairOfVectors(r,o,(function(t,r){return p.lookupWorkingStepComparisonScore(t,r)}),10,0,0);if(c.length>0){var h,m=function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}(c);try{for(m.s();!(h=m.n()).done;){var T=h.value,E=void 0;T.comparisonItem?(E=this.workingStepCorrectness[T.comparisonItem.id],u+=T.weightingScore):E=a.WorkingStepComparison.CORRECTNESS_UNKNOWN;var y=T.staticItem?this.workingStepCorrectness[T.staticItem.id]:a.WorkingStepComparison.CORRECTNESS_UNKNOWN;l.push(new a.WorkingStepComparison(T.comparisonItem,T.staticItem,E,y))}}catch(t){m.e(t)}finally{m.f()}}else{for(var d=r[t],C=o[t],_=Math.min(o.length,r.length),O=0;O<_;O++)l.push(new a.WorkingStepComparison(C,d,this.workingStepCorrectness[o[O].id]));if(o.length>_)for(var g=_;g<o.length;g++)l.push(new a.WorkingStepComparison(C,null,this.workingStepCorrectness[o[g].id]));else if(r.length>_)for(var v=_;v<r.length;v++)l.push(new a.WorkingStepComparison(null,d,a.WorkingStepComparison.CORRECTNESS_UNKNOWN))}return{optionOutput:l,optionsTotalScore:u}}},{key:"lookupWorkingStepComparisonScore",value:function lookupWorkingStepComparisonScore(t,r){var o=this.workingStepComparisonScores[t.id][r.id];return!o||Number.isNaN(o)||o<.25?-1:o}}]),StringComparer}();r.StringComparer=p},907:(t,r,o)=>{function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.WorkingComparer=void 0;var i=o(1269),a=o(9726),p=o(8125),l=o(3033),u=o(1891),c=o(2687),h=o(6815),m=o(8987),T=o(7809),E=o(7076),y=o(8181),d=o(8447),C=o(7722),_=/(?:!=|>=|<=|,|，|\sor\s|\\\sor\\\s)/,O=function(){function WorkingComparer(t,r,o,a,p,l,T,E,d){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,WorkingComparer),this.shaneTexLexer=new c.MathLexer,this.latexLexer=new u.LatexLexer,this.parsers=[],this.markedStepTreeComparer=new i.ExpressionTreeComparer,this.unmarkedStepTreeComparer=new i.ExpressionTreeComparer,this.visualTreeComparer=new i.ExpressionTreeComparer,this.questionSpecificMarkedStepParsers=[],this.questionSpecificUnmarkedStepParsers=[],this.questionSpecificParserScore=.75,this.autoGenerateMarkedStepLHSVariants=!1,this.autoGenerateUnmarkedStepLHSVariants=!1,this.ignoreThousandsSeparators=!1,this.isAdmin=!1;var _=h.MathFunctionsAndConstants.Instance.DefaultMathFunctions;null!=t&&t.length>0&&(_=_.concat(t));var O=h.MathFunctionsAndConstants.Instance.DefaultMathConstants;null!=r&&r.length>0&&(O=O.concat(r)),this.autoGenerateMarkedStepLHSVariants=T,this.autoGenerateUnmarkedStepLHSVariants=E,this.ignoreThousandsSeparators=d,this.markedStepTreeComparer=o,this.unmarkedStepTreeComparer=a,this.questionSpecificMarkedStepParsers=p,this.questionSpecificUnmarkedStepParsers=l,this.visualTreeComparer.applyAcceptableError=!1,this.parserVisual=new m.MathParser(_,O,this.visualTreeComparer,!0,!0),this.parserVisual.normaliseEqualsMode=m.MathParser.NORMALISE_EQUALS_MODE_NONE,this.parserVisual.anySimplification=!1,this.parserPermissiveAddSubtractComparison=new m.MathParser(_,O,this.unmarkedStepTreeComparer,!0,!0),this.parserPermissiveAddSubtractComparison.normaliseEqualsMode=m.MathParser.NORMALISE_EQUALS_MODE_ADDITION,this.parserPermissiveAddSubtractComparison.anySimplification=!0,this.parserPermissiveAddSubtractComparison.equalsMovements=!0,this.parserPermissiveAddSubtractComparison.numericSimplification=!0,this.parserPermissiveAddSubtractComparison.allowInvertedSigns=!0,this.parserPermissiveAddSubtractComparison.simplifyExponents=!0,this.parserPermissiveAddSubtractComparison.groupLikeTerms=!0,this.parserPermissiveAddSubtractComparison.addSubtractRearrangements=!0,this.parserPermissiveAddSubtractComparison.multiplyDivideRearrangements=!0,this.parserPermissiveAddSubtractComparison.expansionOfBrackets=!0,this.parserPermissiveAddSubtractComparison.autoCloseBrackets=!0,this.parserPermissiveMultiplyDivideComparison=new m.MathParser(_,O,this.unmarkedStepTreeComparer,!0,!0),this.parserPermissiveMultiplyDivideComparison.normaliseEqualsMode=m.MathParser.NORMALISE_EQUALS_MODE_MULTIPLICATION,this.parserPermissiveMultiplyDivideComparison.anySimplification=!0,this.parserPermissiveMultiplyDivideComparison.equalsMovements=!0,this.parserPermissiveMultiplyDivideComparison.numericSimplification=!0,this.parserPermissiveMultiplyDivideComparison.allowInvertedSigns=!0,this.parserPermissiveMultiplyDivideComparison.simplifyExponents=!0,this.parserPermissiveMultiplyDivideComparison.groupLikeTerms=!0,this.parserPermissiveMultiplyDivideComparison.addSubtractRearrangements=!0,this.parserPermissiveMultiplyDivideComparison.multiplyDivideRearrangements=!0,this.parserPermissiveMultiplyDivideComparison.expansionOfBrackets=!0,this.parserPermissiveMultiplyDivideComparison.autoCloseBrackets=!0,this.parserNumericSimplification=new m.MathParser(_,O,this.unmarkedStepTreeComparer,!0,!0),this.parserNumericSimplification.anySimplification=!0,this.parserNumericSimplification.autoCloseBrackets=!0,this.parserNumericSimplification.addSubtractRearrangements=!0,this.parserNumericSimplification.multiplyDivideRearrangements=!0,this.parserNumericSimplification.numericSimplification=!0,this.parserNumericSimplification.allowInvertedSigns=!0,this.parserNumericSimplification.groupLikeTerms=!1,this.parserNumericSimplification.equalsMovements=!1,this.parserNumericSimplification.expansionOfBrackets=!1,this.parserNumericSimplification.simplifyExponents=!1,this.parserGroupLikeTerms=new m.MathParser(_,O,this.unmarkedStepTreeComparer,!0,!0),this.parserGroupLikeTerms.anySimplification=!0,this.parserGroupLikeTerms.autoCloseBrackets=!0,this.parserGroupLikeTerms.addSubtractRearrangements=!0,this.parserGroupLikeTerms.multiplyDivideRearrangements=!0,this.parserGroupLikeTerms.numericSimplification=!0,this.parserGroupLikeTerms.allowInvertedSigns=!0,this.parserGroupLikeTerms.groupLikeTerms=!0,this.parserGroupLikeTerms.expansionOfBrackets=!0,this.parserGroupLikeTerms.simplifyExponents=!0,this.parserGroupLikeTerms.equalsMovements=!1,this.parsers=[new y.ParserStrictnessScoringInfo(this.parserVisual,1,C.WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT),new y.ParserStrictnessScoringInfo(this.parserNumericSimplification,.6,C.WorkingStepComparison.CORRECTNESS_MAYBE_CORRECT),new y.ParserStrictnessScoringInfo(this.parserGroupLikeTerms,.4,C.WorkingStepComparison.CORRECTNESS_MAYBE_CORRECT),new y.ParserStrictnessScoringInfo(this.parserPermissiveAddSubtractComparison,.25,C.WorkingStepComparison.CORRECTNESS_MAYBE_CORRECT),new y.ParserStrictnessScoringInfo(this.parserPermissiveMultiplyDivideComparison,.25,C.WorkingStepComparison.CORRECTNESS_MAYBE_CORRECT)]}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(WorkingComparer,[{key:"updateQuestionSpecificParserScore",value:function updateQuestionSpecificParserScore(){this.questionSpecificParserScore=.8}},{key:"lookupWorkingStepComparisonScore",value:function lookupWorkingStepComparisonScore(t,r){var o=this.workingStepComparisonScores[t.id][r.id];return isNaN(o)||o<.05?0:o<.25&&this.workingStepCorrectness[t.id]!=C.WorkingStepComparison.CORRECTNESS_INCORRECT?-1:1==r.marked&&o>=this.questionSpecificParserScore?1.5*o:o}},{key:"buildAllExpressionTrees",value:function buildAllExpressionTrees(t){var r=this.parsers.concat(this.questionSpecificMarkedStepParsers,this.questionSpecificUnmarkedStepParsers);this.workingStepCompiledTrees={};var o,i=_createForOfIteratorHelper(t);try{for(i.s();!(o=i.n()).done;){var a=o.value;if(!this.workingStepCompiledTrees[a.id]){var p=this.buildExpressionTreesForStep(a,r);this.workingStepCompiledTrees[a.id]=p}}}catch(t){i.e(t)}finally{i.f()}}},{key:"precompileExpressionTreesWithDelays",value:function precompileExpressionTreesWithDelays(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0==r){if(0==t.length)return;o=this.parsers.concat(this.questionSpecificMarkedStepParsers,this.questionSpecificUnmarkedStepParsers),this.workingStepCompiledTrees={}}var i=t[r];if(!this.workingStepCompiledTrees[i.id]){var a=this.buildExpressionTreesForStep(i,o);this.workingStepCompiledTrees[i.id]=a}r+1<t.length&&this.precompileExpressionTreesWithDelays(t,r+1,o)}},{key:"buildExpressionTreesForStep",value:function buildExpressionTreesForStep(t,r){for(var o=this.getStepFormulas(t),i=[],a=0;a<o.length;a++){var p=o[a];if(!T.StringUtilMath.isNullOrWhitespace(p)){p=this.preprocessFormula(p);var u=void 0;switch(t.formulaFormat){case l.FormulaFormats.LATEX:u=this.latexLexer.scanInput(p);break;case l.FormulaFormats.SHANETEX:default:u=this.shaneTexLexer.scanInput(p)}var c,h={},m=_createForOfIteratorHelper(r);try{for(m.s();!(c=m.n()).done;){var E=c.value.parser;if(null==h[E.id])if(h[E.id]=E.parseTokenStream(u.clone()),null!=h[E.id]);else{var y="Error occured parsing tree for specific strictness";if(this.isAdmin)throw new Error(y);console.error(y)}}}catch(t){m.e(t)}finally{m.f()}i[a]=h}}return i}},{key:"preprocessFormula",value:function preprocessFormula(t){return this.ignoreThousandsSeparators&&(t=t.replace(WorkingComparer.reThousandsSeparator,"$1")),t}},{key:"cleanWorkingStepVector",value:function cleanWorkingStepVector(t){for(var r=0;r<t.length;r++)t[r].isEmpty&&(t.splice(r,1),r--)}},{key:"preCompileStaticSteps",value:function preCompileStaticSteps(t){var r,o=[],i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,p=this.splitMultipleCombinedSteps(a);(this.autoGenerateMarkedStepLHSVariants||this.autoGenerateUnmarkedStepLHSVariants)&&(p=this.generateLHSVariants(p));var l,u=_createForOfIteratorHelper(p);try{for(u.s();!(l=u.n()).done;){var c=l.value;o.push(c)}}catch(t){u.e(t)}finally{u.f()}}}catch(t){i.e(t)}finally{i.f()}return this.precompileExpressionTreesWithDelays(o),this.workingStepCompiledTrees}},{key:"compareSteps",value:function compareSteps(t,r,o){var i=this,a=[];this.workingStepComparisonScores={},this.workingStepCorrectness={},this.workingStepHashes={},this.isAdmin=o,this.updateQuestionSpecificParserScore();var l,u=this.splitMultipleCombinedSteps(r),c=[],h=_createForOfIteratorHelper(t);try{for(h.s();!(l=h.n()).done;){var m=l.value,T=this.splitMultipleCombinedSteps(m);(this.autoGenerateMarkedStepLHSVariants||this.autoGenerateUnmarkedStepLHSVariants)&&(T=this.generateLHSVariants(T)),c.push(T)}}catch(t){h.e(t)}finally{h.f()}for(var E=[],y=0,d=c;y<d.length;y++){var _,O=_createForOfIteratorHelper(d[y]);try{for(O.s();!(_=O.n()).done;){var g=_.value;E.push(g),this.workingStepCorrectness[g.id]=C.WorkingStepComparison.CORRECTNESS_INCORRECT}}catch(t){O.e(t)}finally{O.f()}}var v,P=_createForOfIteratorHelper(u);try{for(P.s();!(v=P.n()).done;){var S=v.value;E.push(S),this.workingStepCorrectness[S.id]=C.WorkingStepComparison.CORRECTNESS_INCORRECT}}catch(t){P.e(t)}finally{P.f()}if(this.buildAllExpressionTrees(E),this.isAdmin)for(var M=0,x=Object.values(this.workingStepCompiledTrees);M<x.length;M++)for(var b=x[M],k=0,N=Object.values(b[0]);k<N.length;k++)N[k];for(var A=0,R=!0,I=0;I<c.length;I++){var w,U=c[I],Y=_createForOfIteratorHelper(u);try{for(Y.s();!(w=Y.n()).done;){var L,D=w.value,B={},H=0,W=C.WorkingStepComparison.CORRECTNESS_INCORRECT,j=_createForOfIteratorHelper(U);try{for(j.s();!(L=j.n()).done;){var G=L.value,q=0,V=C.WorkingStepComparison.CORRECTNESS_INCORRECT;if(G.formula!=D.formula){var X,Q=G.marked?this.questionSpecificMarkedStepParsers:this.questionSpecificUnmarkedStepParsers,K=_createForOfIteratorHelper(Q);try{for(K.s();!(X=K.n()).done;){var J=X.value;if(1==this.compareWorkingStepCompiledTrees(G,D,J.parser,!1)){var z=this.validateWorkingStepRounding(D,J.parser,J.parser.comparer);(q=z?J.score:q=J.score-.1)>H&&(H=q),z?(W=C.WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT,V=C.WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT):(W=C.WorkingStepComparison.CORRECTNESS_MAYBE_CORRECT,V=C.WorkingStepComparison.CORRECTNESS_MAYBE_CORRECT);break}}}catch(t){K.e(t)}finally{K.f()}var $,Z=_createForOfIteratorHelper(this.parsers);try{for(Z.s();!($=Z.n()).done;){var ee=$.value,te=ee.score,ne=ee.correctness;if(te>q&&1==this.compareWorkingStepCompiledTrees(G,D,ee.parser,!1)){if(ee.parser==this.parserVisual&&Q.length>0){var re=Q[0].parser;if(!this.validateWorkingStepRounding(D,re,re.comparer))continue}te>q&&(q=te,te>H&&(H=te)),ne>W&&(W=ne),ne>V&&(V=ne);break}}}catch(t){Z.e(t)}finally{Z.f()}if(0==q){var oe=this.compareWorkingStepCompiledTrees(G,D,this.parserVisual,!0);oe>0&&(q=.25*oe)}B[G.id]=q,V>this.workingStepCorrectness[G.id]&&(this.workingStepCorrectness[G.id]=V)}else(q=1)>H&&(H=q),W=C.WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT,B[G.id]=q,this.workingStepCorrectness[G.id]=C.WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT}}catch(t){j.e(t)}finally{j.f()}this.workingStepCorrectness[D.id]=W,this.workingStepComparisonScores[D.id]=B}}catch(t){Y.e(t)}finally{Y.f()}var ie=[],ae=0,se=p.VectorComparer.FindBestOffsetSetForPairOfVectors(U,u,(function(t,r){return i.lookupWorkingStepComparisonScore(t,r)}),10,0,0);if(se.length>0){var pe,le=_createForOfIteratorHelper(se);try{for(le.s();!(pe=le.n()).done;){var ue=pe.value,ce=void 0;ue.comparisonItem?(ce=this.workingStepCorrectness[ue.comparisonItem.id],ae+=ue.weightingScore):ce=C.WorkingStepComparison.CORRECTNESS_UNKNOWN;var he=ue.staticItem?this.workingStepCorrectness[ue.staticItem.id]:C.WorkingStepComparison.CORRECTNESS_UNKNOWN;ie.push(new C.WorkingStepComparison(ue.comparisonItem,ue.staticItem,ce,he))}}catch(t){le.e(t)}finally{le.f()}}else{for(var fe=Math.min(u.length,U.length),me=0;me<fe;me++)ie.push(new C.WorkingStepComparison(u[I],U[I],this.workingStepCorrectness[u[me].id]));if(u.length>fe)for(var Te=fe;Te<u.length;Te++)ie.push(new C.WorkingStepComparison(u[I],null,this.workingStepCorrectness[u[Te].id]));else if(U.length>fe)for(var Ee=fe;Ee<U.length;Ee++)ie.push(new C.WorkingStepComparison(null,U[I],C.WorkingStepComparison.CORRECTNESS_UNKNOWN))}(R||ae>A)&&(a=ie,A=ae),R=!1}return this.markedStepTreeComparer.flushComparisonDictionaries(),this.unmarkedStepTreeComparer.flushComparisonDictionaries(),this.visualTreeComparer.flushComparisonDictionaries(),a}},{key:"getStepFormulas",value:function getStepFormulas(t){return t.getFormulas().map((function(t){return t.replace(WorkingComparer.replaceEqualsCharacters,"=")}))}},{key:"splitMultipleCombinedSteps",value:function splitMultipleCombinedSteps(t){var r,o=[],i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;a.sourceID=a.id;var p,l=this.getStepFormulas(a),u=!1,c=_createForOfIteratorHelper(l);try{for(c.s();!(p=c.n()).done;){var h=p.value;T.StringUtilMath.numberOfInstancesOfStringMatch(h,"=")>1&&(u=!0)}}catch(t){c.e(t)}finally{c.f()}if(u){var m,E=[],y=[],C=_createForOfIteratorHelper(l);try{for(C.s();!(m=C.n()).done;){var _=m.value,O=_.split("=");if(this.validateThatFormulaContainsSimpleEqualsSign(_,!0,O)){var g="".concat(O[0],"=").concat(O[1]);E.push(g);for(var v=2;v<O.length;v++){var P=v-2;y.length<=P&&(y[P]=[]),y[P].push("".concat(O[0]," = ").concat(O[v]))}}else E.push(_)}}catch(t){C.e(t)}finally{C.f()}if(y.length>0){var S=new d.WorkingStep("",a.formulaFormat,a.commentPreFormula,"",a.marked);S.setFormulas(E),S.sourceID=a.id,o.push(S);for(var M=0;M<y.length;M++){var x=new d.WorkingStep("",a.formulaFormat,"","",a.marked);x.setFormulas(y[M]),x.sourceID=a.id,M==y.length-1&&(x.commentPostFormula=a.commentPostFormula),o.push(x)}}else o.push(a)}else o.push(a)}}catch(t){i.e(t)}finally{i.f()}return o}},{key:"generateLHSVariants",value:function generateLHSVariants(t){var r,o=[],i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.marked&&!this.autoGenerateMarkedStepLHSVariants||!a.marked&&!this.autoGenerateUnmarkedStepLHSVariants)o.push(a);else{var p,l=this.getStepFormulas(a),u=!1,c=_createForOfIteratorHelper(l);try{for(c.s();!(p=c.n()).done;){var h=p.value;1==T.StringUtilMath.numberOfInstancesOfStringMatch(h,"=")&&(u=!0)}}catch(t){c.e(t)}finally{c.f()}if(u){var m,E=[],y=_createForOfIteratorHelper(l);try{for(y.s();!(m=y.n()).done;){var C=m.value,_=C.split("=");if(this.validateThatFormulaContainsSimpleEqualsSign(C,!1,_)){var O=_[0];if(!T.StringUtilMath.isNullOrWhitespace(O)){var g=_[1];-1==l.indexOf("=".concat(g))&&-1==l.indexOf("= ".concat(g))&&E.push("=".concat(g)),-1==l.indexOf(g)&&E.push(g)}}}}catch(t){y.e(t)}finally{y.f()}if(E.length>0){var v=l.concat(E),P=new d.WorkingStep("",a.formulaFormat,a.commentPreFormula,a.commentPostFormula,a.marked);P.setFormulas(v),P.sourceID=a.id,o.push(P)}else o.push(a)}else o.push(a)}}}catch(t){i.e(t)}finally{i.f()}return o}},{key:"validateThatFormulaContainsSimpleEqualsSign",value:function validateThatFormulaContainsSimpleEqualsSign(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=null!=o?o:t.split("=");if(i.length<2)return!1;if(i.length>2&&!r)return!1;var a=_.test(t);if(a)return!1;var p,l=_createForOfIteratorHelper(i);try{for(l.s();!(p=l.n()).done;){var u=p.value,c=T.StringUtilMath.numberOfInstancesOfStringMatch(u,"("),h=T.StringUtilMath.numberOfInstancesOfStringMatch(u,")");if(c!=h)return!1;if(c>0){var m=u.indexOf("("),E=u.indexOf(")");if(m>E)return!1}}}catch(t){l.e(t)}finally{l.f()}return!0}},{key:"compareWorkingStepCompiledTrees",value:function compareWorkingStepCompiledTrees(t,r,o,i){var a,p=this.workingStepCompiledTrees[t.id],l=this.workingStepCompiledTrees[r.id],u=0,c=_createForOfIteratorHelper(p);try{for(c.s();!(a=c.n()).done;){var h=a.value;if(null!=h){var m,T=h[o.id],E=_createForOfIteratorHelper(l);try{for(E.s();!(m=E.n()).done;){var y=m.value[o.id],d=o.comparer.generateSimilarityScore(T,y,i);if(d>u){if(1==d||!i)return 1;u=d}}}catch(t){E.e(t)}finally{E.f()}}}}catch(t){c.e(t)}finally{c.f()}return u}},{key:"validateWorkingStepRounding",value:function validateWorkingStepRounding(t,r,o){if(o.autoRoundUsersAnswer||null==o.roundingType||o.roundingType.code==E.AnswerRoundingHelper.CODE_NONE)return!0;var i=this.workingStepCompiledTrees[t.id];if(null==i||i.length<1)return!0;var p=i[0][r.id];return a.ExpressionTreeRoundingValidator.validateRounding(p,o.roundingType,o.roundingAmount)}}]),WorkingComparer}();r.WorkingComparer=O,O.QUESTION_SPECIFIC_PARSER_INDEX=0,O.replaceEqualsCharacters=/＝/g,O.reThousandsSeparator=/(\d+)(?:,|，|\\? )(?=\d{3})/g},8447:(t,r,o)=>{function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.WorkingStep=void 0;var i=o(9745),a=o(3033),p=o(3728),l=o(7809),u=function(){function WorkingStep(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.FormulaFormats.LATEX,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",u=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5&&void 0!==arguments[5]&&arguments[5];_classCallCheck(this,WorkingStep),this.formulas=[],this.formulaFormat=a.FormulaFormats.LATEX,this.id=p.GuidUtilMath.create(),this.format=i.EquationInputType.Text,this.sourceID=this.id,this.formulas[0]=t,this.formulaFormat=r,this.commentPreFormula=o,this.commentPostFormula=l,this.marked=u,this.validHint=c}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(WorkingStep,[{key:"isEmpty",get:function get(){return!!(l.StringUtilMath.isNullOrWhitespace(this.formula)&&l.StringUtilMath.isNullOrWhitespace(this.commentPreFormula)&&l.StringUtilMath.isNullOrWhitespace(this.commentPostFormula))}},{key:"formula",get:function get(){return this.formulas.length>0?this.formulas[0]:""},set:function set(t){this.formulas=[],this.formulas[0]=t}},{key:"hasMultipleFormulas",value:function hasMultipleFormulas(){return this.formulas.length>1}},{key:"getFormulas",value:function getFormulas(){return this.formulas.concat()}},{key:"setFormulas",value:function setFormulas(t){this.formulas!=t&&(this.formulas=t)}},{key:"addFormula",value:function addFormula(t){0==this.formulas.length?this.formula=t:this.formulas.push(t)}}],[{key:"fromServerStep",value:function fromServerStep(t){return new WorkingStep(t.Formula,t.FormulaFormat,t.CommentPreFormula,t.CommentPostFormula,t.Marked,t.ValidHint)}},{key:"fromWorkingStep",value:function fromWorkingStep(t){var r=new WorkingStep("",t.formulaFormat,t.commentPreFormula,t.commentPostFormula,t.marked,t.validHint);return r.id=t.id,r.sourceID=t.sourceID,r.formulas=t.formulas,r}},{key:"toServerStep",value:function toServerStep(t){return{Formula:t.formula,FormulaFormat:t.formulaFormat,CommentPostFormula:t.commentPostFormula,CommentPreFormula:t.commentPreFormula,HideIfNotMatched:!1,Marked:!1,ValidHint:!1}}}]),WorkingStep}();r.WorkingStep=u},7722:(t,r)=>{function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.WorkingStepComparison=void 0;var o=function(){function WorkingStepComparison(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:WorkingStepComparison.CORRECTNESS_UNKNOWN,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:WorkingStepComparison.CORRECTNESS_UNKNOWN;_classCallCheck(this,WorkingStepComparison),this.userStep=t,this.correctStep=r,this.comparisonCorrectness=o,this.correctStepBestCorrectness=i}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(WorkingStepComparison,[{key:"wasAttemptedByUser",get:function get(){return null!=this.userStep&&!this.userStep.isEmpty}},{key:"isMarked",get:function get(){return!!this.correctStep&&this.correctStep.marked}},{key:"isCorrect",get:function get(){return this.comparisonCorrectness==WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT}},{key:"isMarkedCompletelyCorrect",get:function get(){return this.isMarked&&this.correctStepBestCorrectness==WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT}},{key:"isMaybeCorrect",get:function get(){return this.comparisonCorrectness==WorkingStepComparison.CORRECTNESS_MAYBE_CORRECT}},{key:"isIncorrect",get:function get(){return this.comparisonCorrectness==WorkingStepComparison.CORRECTNESS_INCORRECT}},{key:"correctStepIsMatched",get:function get(){return this.correctStepBestCorrectness==WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT}}],[{key:"fromWorker",value:function fromWorker(t){return new WorkingStepComparison(t.userStep,t.correctStep,t.comparisonCorrectness,t.correctStepBestCorrectness)}},{key:"correct",value:function correct(t){var r,correct=!0,o=function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}(t);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(i.isMarked&&i.correctStepBestCorrectness!=WorkingStepComparison.CORRECTNESS_COMPLETELY_CORRECT){correct=!1;break}}}catch(t){o.e(t)}finally{o.f()}return correct}}]),WorkingStepComparison}();r.WorkingStepComparison=o,o.CORRECTNESS_UNKNOWN=0,o.CORRECTNESS_INCORRECT=1,o.CORRECTNESS_MAYBE_CORRECT=2,o.CORRECTNESS_COMPLETELY_CORRECT=3},9536:(t,r,o)=>{function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Object.defineProperty(r,"__esModule",{value:!0}),r.WorkingStorageFormatHelper=void 0;var i=o(9745),a=o(3033),p=o(8447),l=o(9778),u=function(){function WorkingStorageFormatHelper(){!function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,WorkingStorageFormatHelper)}return function _createClass(t,r,o){r&&_defineProperties(t.prototype,r),o&&_defineProperties(t,o)}(WorkingStorageFormatHelper,null,[{key:"determineStorageFormat",value:function determineStorageFormat(t){if("string"==typeof t||t instanceof String){var r=t;return-1!=r.indexOf(WorkingStorageFormatHelper.CUSTOM_DELIMITER_STRING)?l.WorkingStorageFormats.CustomDelimited:-1!=r.indexOf("`")?l.WorkingStorageFormats.NewLineDelimited:l.WorkingStorageFormats.NoDelimiter}return this.isStructuredUserAnswer(t)?l.WorkingStorageFormats.JSONObjects:l.WorkingStorageFormats.Unknown}},{key:"determineInputType",value:function determineInputType(t){return i.EquationInputType.Text}},{key:"determineFormulaFormat",value:function determineFormulaFormat(t,r){return-1!=t.indexOf("\\")?a.FormulaFormats.LATEX:r==a.FormulaFormats.LATEX||r==a.FormulaFormats.SHANETEX?r:a.FormulaFormats.SHANETEX}},{key:"isStructuredUserAnswer",value:function isStructuredUserAnswer(t){return"Steps"in t&&Array.isArray(t.Steps)}},{key:"deserialiseWorkingSteps",value:function deserialiseWorkingSteps(t){switch(WorkingStorageFormatHelper.determineStorageFormat(t)){case l.WorkingStorageFormats.CustomDelimited:return WorkingStorageFormatHelper.deserialiseCustomDelimitedSteps(t);case l.WorkingStorageFormats.NewLineDelimited:return WorkingStorageFormatHelper.deserialiseNewlineDelimitedSteps(t);case l.WorkingStorageFormats.JSONObjects:return WorkingStorageFormatHelper.deserialiseFormulaUserAnswer(t);case l.WorkingStorageFormats.NoDelimiter:return[WorkingStorageFormatHelper.deserialiseSingleStep(t)];case l.WorkingStorageFormats.Unknown:default:return console.error("Unrecognised WorkingFormulaComponent answer",t.toString()),[WorkingStorageFormatHelper.deserialiseSingleStep(t.toString())]}}},{key:"deserialiseSingleStep",value:function deserialiseSingleStep(t){var r=this.determineFormulaFormat(t),o=new p.WorkingStep(t,r);return o.format=WorkingStorageFormatHelper.determineInputType(t),o}},{key:"deserialiseFormulaUserAnswer",value:function deserialiseFormulaUserAnswer(t){var r=[];if(t&&t.Steps){var o,i=function _createForOfIteratorHelper(t,r){var o;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(o=function _unsupportedIterableToArray(t,r){if(t){if("string"==typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var i=0,a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p,l=!0,u=!1;return{s:function s(){o=t[Symbol.iterator]()},n:function n(){var t=o.next();return l=t.done,t},e:function e(t){u=!0,p=t},f:function f(){try{l||null==o.return||o.return()}finally{if(u)throw p}}}}(t.Steps);try{for(i.s();!(o=i.n()).done;){var a=o.value,l=this.determineFormulaFormat(a.Formula,a.FormulaFormat),u=new p.WorkingStep(a.Formula,l,a.CommentPreFormula,a.CommentPostFormula,a.Marked,a.ValidHint);r.push(u)}}catch(t){i.e(t)}finally{i.f()}}return r}},{key:"deserialiseCustomDelimitedSteps",value:function deserialiseCustomDelimitedSteps(t){for(var r=[],o=t.split(WorkingStorageFormatHelper.CUSTOM_DELIMITER_STRING),i=0;i<o.length;i++){var a=o[i].trim();if(""!=a){var l=this.determineFormulaFormat(a),u=new p.WorkingStep(a,l,"","",!1);u.format=WorkingStorageFormatHelper.determineInputType(a),r.push(u)}}return r}},{key:"deserialiseNewlineDelimitedSteps",value:function deserialiseNewlineDelimitedSteps(t){for(var r=[],o=t.split("\n"),i=0;i<o.length;i++){var l=o[i].trim();if(""!=l){var u=new p.WorkingStep("",a.FormulaFormats.SHANETEX,"","",!1),c=l.indexOf("`"),h=l.lastIndexOf("`");-1==c?u.commentPostFormula=l:(c>0&&(u.commentPreFormula=l.substring(0,c)),u.formula=l.substring(c+1,h),h<l.length-1&&(u.commentPostFormula=l.substring(h+1,l.length))),u.format=WorkingStorageFormatHelper.determineInputType(u.formula),r.push(u)}}return r}},{key:"serialiseWorkingSteps",value:function serialiseWorkingSteps(t,r){var o=[];switch(r){case l.WorkingStorageFormats.NewLineDelimited:for(var i=0;i<t.length;i++){var a=t[i];o.push("".concat(a.commentPreFormula,"`").concat(a.formula,"`").concat(a.commentPostFormula))}return o.join("\n");case l.WorkingStorageFormats.CustomDelimited:for(var p=0;p<t.length;p++){var u=t[p];""!=u.formula.trim()&&o.push(u.formula.trim())}return o.join(WorkingStorageFormatHelper.CUSTOM_DELIMITER_STRING);case l.WorkingStorageFormats.NoDelimiter:return t.length>0?t[0].formula:"";default:return null}}}]),WorkingStorageFormatHelper}();r.WorkingStorageFormatHelper=u,u.CUSTOM_DELIMITER_STRING=" ||-|| "},9778:(t,r)=>{Object.defineProperty(r,"__esModule",{value:!0}),r.WorkingStorageFormats=void 0,function(t){t[t.Unknown=-1]="Unknown",t[t.JSONObjects=0]="JSONObjects",t[t.CustomDelimited=1]="CustomDelimited",t[t.NewLineDelimited=2]="NewLineDelimited",t[t.NoDelimiter=3]="NoDelimiter"}(r.WorkingStorageFormats||(r.WorkingStorageFormats={}))},2395:r=>{r.exports=t},4774:t=>{t.exports=r},974:t=>{t.exports=o},4780:t=>{t.exports=a}},l={};return function __webpack_require__(t){var r=l[t];if(void 0!==r)return r.exports;var o=l[t]={exports:{}};return p[t](o,o.exports,__webpack_require__),o.exports}(7278)})()}))}}]);