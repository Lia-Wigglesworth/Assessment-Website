(self.webpackChunkep_web=self.webpackChunkep_web||[]).push([["../libs/wp/prosemirror-dropcursor/prosemirror-dropcursor"],{"./node_modules/prosemirror-dropcursor/dist/index.es.js":function(t,e,o){"use strict";o.d(e,{q:function(){return dropCursor}});var i=o("./node_modules/prosemirror-state/dist/index.es.js"),r=o("./node_modules/prosemirror-transform/dist/index.es.js");function dropCursor(t){return void 0===t&&(t={}),new i.Plugin({view:function view(e){return new s(e,t)}})}var s=function DropCursorView(t,e){var o=this;this.editorView=t,this.width=e.width||1,this.color=e.color||"black",this.class=e.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map((function(e){var handler=function(t){return o[e](t)};return t.dom.addEventListener(e,handler),{name:e,handler:handler}}))};s.prototype.destroy=function destroy(){var t=this;this.handlers.forEach((function(e){var o=e.name,i=e.handler;return t.editorView.dom.removeEventListener(o,i)}))},s.prototype.update=function update(t,e){null!=this.cursorPos&&e.doc!=t.state.doc&&this.updateOverlay()},s.prototype.setCursor=function setCursor(t){t!=this.cursorPos&&(this.cursorPos=t,null==t?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},s.prototype.updateOverlay=function updateOverlay(){var t,e=this.editorView.state.doc.resolve(this.cursorPos);if(!e.parent.inlineContent){var o=e.nodeBefore,i=e.nodeAfter;if(o||i){var r=this.editorView.nodeDOM(this.cursorPos-(o?o.nodeSize:0)).getBoundingClientRect(),s=o?r.bottom:r.top;o&&i&&(s=(s+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),t={left:r.left,right:r.right,top:s-this.width/2,bottom:s+this.width/2}}}if(!t){var n=this.editorView.coordsAtPos(this.cursorPos);t={left:n.left-this.width/2,right:n.left+this.width/2,top:n.top,bottom:n.bottom}}var d=this.editorView.dom.offsetParent;this.element||(this.element=d.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color);var l=!d||d==document.body&&"static"==getComputedStyle(d).position?{left:-pageXOffset,top:-pageYOffset}:d.getBoundingClientRect();this.element.style.left=t.left-l.left+"px",this.element.style.top=t.top-l.top+"px",this.element.style.width=t.right-t.left+"px",this.element.style.height=t.bottom-t.top+"px"},s.prototype.scheduleRemoval=function scheduleRemoval(t){var e=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return e.setCursor(null)}),t)},s.prototype.dragover=function dragover(t){if(this.editorView.editable){var e=this.editorView.posAtCoords({left:t.clientX,top:t.clientY});if(e){var o=e.pos;this.editorView.dragging&&this.editorView.dragging.slice&&null==(o=(0,r.dropPoint)(this.editorView.state.doc,o,this.editorView.dragging.slice))&&(o=e.pos),this.setCursor(o),this.scheduleRemoval(5e3)}}},s.prototype.dragend=function dragend(){this.scheduleRemoval(20)},s.prototype.drop=function drop(){this.scheduleRemoval(20)},s.prototype.dragleave=function dragleave(t){t.target!=this.editorView.dom&&this.editorView.dom.contains(t.relatedTarget)||this.setCursor(null)}}}]);