/*! For license information please see tiptap.5b4ccd91f030ec9418f6.js.LICENSE.txt */
(self.webpackChunkep_web=self.webpackChunkep_web||[]).push([["../libs/wp/@educationperfect/tiptap/tiptap"],{"./node_modules/@educationperfect/tiptap/dist/tiptap.esm.js":function(e,t,n){"use strict";n.r(t),n.d(t,{NodeSelection:function(){return i.NodeSelection},Plugin:function(){return i.Plugin},PluginKey:function(){return i.PluginKey},TextSelection:function(){return i.TextSelection},Doc:function(){return k},Editor:function(){return C},EditorContent:function(){return P},EditorFloatingMenu:function(){return j},EditorMenuBar:function(){return M},EditorMenuBubble:function(){return O},Extension:function(){return v},Mark:function(){return g},Node:function(){return b},Paragraph:function(){return w},Text:function(){return _}});var i=n("./node_modules/prosemirror-state/dist/index.es.js"),r=n("./node_modules/prosemirror-view/dist/index.es.js"),o=n("./node_modules/prosemirror-model/dist/index.es.js"),s=n("./node_modules/prosemirror-dropcursor/dist/index.es.js"),a=n("./node_modules/prosemirror-gapcursor/dist/index.es.js"),u=n("./node_modules/prosemirror-keymap/dist/index.es.js"),c=n("./node_modules/prosemirror-commands/dist/index.es.js"),l=n("./node_modules/prosemirror-inputrules/dist/index.es.js"),d=n("./node_modules/@educationperfect/tiptap-utils/dist/utils.esm.js"),h=n("./node_modules/vue/dist/vue.esm.js"),p=n("./node_modules/@educationperfect/tiptap-commands/dist/commands.esm.js");function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _createSuper(e){return function(){var t,n=_getPrototypeOf(e);if(_isNativeReflectConstruct()){var i=_getPrototypeOf(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==a.return||a.return()}finally{if(r)throw o}}return n}(e,t)||_unsupportedIterableToArray(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||_unsupportedIterableToArray(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function camelCase(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"")}var f=function(){function ComponentView(e,t){var n=t.editor,i=t.extension,r=t.parent,o=t.node,s=t.view,a=t.decorations,u=t.getPos;_classCallCheck(this,ComponentView),this.component=e,this.editor=n,this.extension=i,this.parent=r,this.node=o,this.view=s,this.decorations=a,this.isNode=!!this.node.marks,this.isMark=!this.isNode,this.getPos=this.isMark?this.getMarkPos:u,this.captureEvents=!0,this.dom=this.createDOM(),this.contentDOM=this.vm.$refs.content}return _createClass(ComponentView,[{key:"createDOM",value:function createDOM(){var e=this,t=h.default.extend(this.component),n={editor:this.editor,node:this.node,view:this.view,getPos:function getPos(){return e.getPos()},decorations:this.decorations,selected:!1,options:this.extension.options,updateAttrs:function updateAttrs(t){return e.updateAttrs(t)}};return"function"==typeof this.extension.setSelection&&(this.setSelection=this.extension.setSelection),"function"==typeof this.extension.update&&(this.update=this.extension.update),this.vm=new t({parent:this.parent,propsData:n}).$mount(),this.vm.$el}},{key:"update",value:function update(e,t){return e.type===this.node.type&&(e===this.node&&this.decorations===t||(this.node=e,this.decorations=t,this.updateComponentProps({node:e,decorations:t})),!0)}},{key:"updateComponentProps",value:function updateComponentProps(e){var t=this;if(this.vm._props){var n=h.default.config.silent;h.default.config.silent=!0,Object.entries(e).forEach((function(e){var n=_slicedToArray(e,2),i=n[0],r=n[1];t.vm._props[i]=r})),h.default.config.silent=n}}},{key:"updateAttrs",value:function updateAttrs(e){if(this.view.editable){var t=this.view.state,n=this.node.type,i=this.getPos(),r=_objectSpread2({},this.node.attrs,{},e),o=this.isMark?t.tr.removeMark(i.from,i.to,n).addMark(i.from,i.to,n.create(r)):t.tr.setNodeMarkup(i,null,r);this.view.dispatch(o)}}},{key:"ignoreMutation",value:function ignoreMutation(e){return"selection"!==e.type&&(!this.contentDOM||!this.contentDOM.contains(e.target))}},{key:"stopEvent",value:function stopEvent(e){var t=this;if("function"==typeof this.extension.stopEvent)return this.extension.stopEvent(e);var n=!!this.extension.schema.draggable;if(n&&"mousedown"===e.type){var i=e.target.closest&&e.target.closest("[data-drag-handle]");i&&(this.dom===i||this.dom.contains(i))&&(this.captureEvents=!1,document.addEventListener("dragend",(function(){t.captureEvents=!0}),{once:!0}))}var r="copy"===e.type,o="paste"===e.type,s="cut"===e.type,a=e.type.startsWith("drag")||"drop"===e.type;return!(n&&a||r||o||s)&&this.captureEvents}},{key:"selectNode",value:function selectNode(){this.updateComponentProps({selected:!0})}},{key:"deselectNode",value:function deselectNode(){this.updateComponentProps({selected:!1})}},{key:"getMarkPos",value:function getMarkPos(){var e=this.view.posAtDOM(this.dom),t=this.view.state.doc.resolve(e);return(0,d.getMarkRange)(t,this.node.type)}},{key:"destroy",value:function destroy(){this.vm.$destroy()}}]),ComponentView}(),m=function(){function Emitter(){_classCallCheck(this,Emitter)}return _createClass(Emitter,[{key:"on",value:function on(e,t){return this._callbacks=this._callbacks||{},this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),this}},{key:"emit",value:function emit(e){for(var t=this,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this._callbacks=this._callbacks||{};var o=this._callbacks[e];return o&&o.forEach((function(e){return e.apply(t,i)})),this}},{key:"off",value:function off(e,t){if(arguments.length){var n=this._callbacks?this._callbacks[e]:null;n&&(t?this._callbacks[e]=n.filter((function(e){return e!==t})):delete this._callbacks[e])}else this._callbacks={};return this}}]),Emitter}(),v=function(){function Extension(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,Extension),this.options=_objectSpread2({},this.defaultOptions,{},e)}return _createClass(Extension,[{key:"init",value:function init(){return null}},{key:"bindEditor",value:function bindEditor(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.editor=e}},{key:"inputRules",value:function inputRules(){return[]}},{key:"pasteRules",value:function pasteRules(){return[]}},{key:"keys",value:function keys(){return{}}},{key:"name",get:function get(){return null}},{key:"type",get:function get(){return"extension"}},{key:"defaultOptions",get:function get(){return{}}},{key:"plugins",get:function get(){return[]}}]),Extension}(),y=function(){function ExtensionManager(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;_classCallCheck(this,ExtensionManager),e.forEach((function(e){e.bindEditor(t),e.init()})),this.extensions=e}return _createClass(ExtensionManager,[{key:"keymaps",value:function keymaps(e){var t=e.schema,n=this.extensions.filter((function(e){return["extension"].includes(e.type)})).filter((function(e){return e.keys})).map((function(e){return e.keys({schema:t})})),i=this.extensions.filter((function(e){return["node","mark"].includes(e.type)})).filter((function(e){return e.keys})).map((function(e){return e.keys({type:t["".concat(e.type,"s")][e.name],schema:t})}));return[].concat(_toConsumableArray(n),_toConsumableArray(i)).map((function(e){return(0,u.h)(e)}))}},{key:"inputRules",value:function inputRules(e){var t=e.schema,n=e.excludedExtensions;if(!(n instanceof Array)&&n)return[];var i=n instanceof Array?this.extensions.filter((function(e){return!n.includes(e.name)})):this.extensions,r=i.filter((function(e){return["extension"].includes(e.type)})).filter((function(e){return e.inputRules})).map((function(e){return e.inputRules({schema:t})})),o=i.filter((function(e){return["node","mark"].includes(e.type)})).filter((function(e){return e.inputRules})).map((function(e){return e.inputRules({type:t["".concat(e.type,"s")][e.name],schema:t})}));return[].concat(_toConsumableArray(r),_toConsumableArray(o)).reduce((function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(t))}),[])}},{key:"pasteRules",value:function pasteRules(e){var t=e.schema,n=e.excludedExtensions;if(!(n instanceof Array)&&n)return[];var i=n instanceof Array?this.extensions.filter((function(e){return!n.includes(e.name)})):this.extensions,r=i.filter((function(e){return["extension"].includes(e.type)})).filter((function(e){return e.pasteRules})).map((function(e){return e.pasteRules({schema:t})})),o=i.filter((function(e){return["node","mark"].includes(e.type)})).filter((function(e){return e.pasteRules})).map((function(e){return e.pasteRules({type:t["".concat(e.type,"s")][e.name],schema:t})}));return[].concat(_toConsumableArray(r),_toConsumableArray(o)).reduce((function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(t))}),[])}},{key:"commands",value:function commands(e){var t=e.schema,n=e.view;return this.extensions.filter((function(e){return e.commands})).reduce((function(e,i){var r=i.name,o=i.type,s={},a=i.commands(_objectSpread2({schema:t},["node","mark"].includes(o)?{type:t["".concat(o,"s")][r]}:{})),u=function apply(e,t){return!!n.editable&&(n.focus(),e(t)(n.state,n.dispatch,n))},c=function handle(e,t){Array.isArray(t)?s[e]=function(e){return t.forEach((function(t){return u(t,e)}))}:"function"==typeof t&&(s[e]=function(e){return u(t,e)})};return"object"===_typeof(a)?Object.entries(a).forEach((function(e){var t=_slicedToArray(e,2),n=t[0],i=t[1];c(n,i)})):c(r,a),_objectSpread2({},e,{},s)}),{})}},{key:"nodes",get:function get(){return this.extensions.filter((function(e){return"node"===e.type})).reduce((function(e,t){return _objectSpread2({},e,_defineProperty({},t.name,t.schema))}),{})}},{key:"options",get:function get(){var e=this.view;return this.extensions.reduce((function(t,n){return _objectSpread2({},t,_defineProperty({},n.name,new Proxy(n.options,{set:function set(t,n,i){var r=t[n]!==i;return Object.assign(t,_defineProperty({},n,i)),r&&e.updateState(e.state),!0}})))}),{})}},{key:"marks",get:function get(){return this.extensions.filter((function(e){return"mark"===e.type})).reduce((function(e,t){return _objectSpread2({},e,_defineProperty({},t.name,t.schema))}),{})}},{key:"plugins",get:function get(){return this.extensions.filter((function(e){return e.plugins})).reduce((function(e,t){var n=t.plugins;return[].concat(_toConsumableArray(e),_toConsumableArray(n))}),[])}}]),ExtensionManager}();function injectCSS(e){var t=document.createElement("style");t.type="text/css",t.textContent=e;var n=document.head,i=n.firstChild;i?n.insertBefore(t,i):n.appendChild(t)}var g=function(e){_inherits(Mark,e);var t=_createSuper(Mark);function Mark(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,Mark),t.call(this,e)}return _createClass(Mark,[{key:"command",value:function command(){return function(){}}},{key:"type",get:function get(){return"mark"}},{key:"view",get:function get(){return null}},{key:"schema",get:function get(){return null}}]),Mark}(v);function minMax(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(Math.max(parseInt(e,10),t),n)}var b=function(e){_inherits(Node,e);var t=_createSuper(Node);function Node(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,Node),t.call(this,e)}return _createClass(Node,[{key:"command",value:function command(){return function(){}}},{key:"type",get:function get(){return"node"}},{key:"view",get:function get(){return null}},{key:"schema",get:function get(){return null}}]),Node}(v),k=function(e){_inherits(Doc,e);var t=_createSuper(Doc);function Doc(){return _classCallCheck(this,Doc),t.apply(this,arguments)}return _createClass(Doc,[{key:"name",get:function get(){return"doc"}},{key:"schema",get:function get(){return{content:"block+"}}}]),Doc}(b),w=function(e){_inherits(Paragraph,e);var t=_createSuper(Paragraph);function Paragraph(){return _classCallCheck(this,Paragraph),t.apply(this,arguments)}return _createClass(Paragraph,[{key:"commands",value:function commands(e){var t=e.type;return function(){return(0,p.setBlockType)(t)}}},{key:"name",get:function get(){return"paragraph"}},{key:"schema",get:function get(){return{content:"inline*",group:"block",draggable:!1,parseDOM:[{tag:"p"}],toDOM:function toDOM(){return["p",0]}}}}]),Paragraph}(b),_=function(e){_inherits(Text,e);var t=_createSuper(Text);function Text(){return _classCallCheck(this,Text),t.apply(this,arguments)}return _createClass(Text,[{key:"name",get:function get(){return"text"}},{key:"schema",get:function get(){return{group:"inline"}}}]),Text}(b),A='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n',C=function(e){_inherits(Editor,e);var t=_createSuper(Editor);function Editor(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,Editor),(e=t.call(this)).defaultOptions={editorProps:{},editable:!0,autoFocus:null,extensions:[],content:"",topNode:"doc",emptyDocument:{type:"doc",content:[{type:"paragraph"}]},useBuiltInExtensions:!0,disableInputRules:!1,disablePasteRules:!1,dropCursor:{},parseOptions:{},injectCSS:!0,onInit:function onInit(){},onTransaction:function onTransaction(){},onUpdate:function onUpdate(){},onFocus:function onFocus(){},onBlur:function onBlur(){},onPaste:function onPaste(){},onDrop:function onDrop(){}},e.events=["init","transaction","update","focus","blur","paste","drop"],e.init(n),e}return _createClass(Editor,[{key:"init",value:function init(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setOptions(_objectSpread2({},this.defaultOptions,{},t)),this.focused=!1,this.selection={from:0,to:0},this.element=document.createElement("div"),this.extensions=this.createExtensions(),this.nodes=this.createNodes(),this.marks=this.createMarks(),this.schema=this.createSchema(),this.plugins=this.createPlugins(),this.keymaps=this.createKeymaps(),this.inputRules=this.createInputRules(),this.pasteRules=this.createPasteRules(),this.view=this.createView(),this.commands=this.createCommands(),this.setActiveNodesAndMarks(),this.options.injectCSS&&injectCSS(A),null!==this.options.autoFocus&&this.focus(this.options.autoFocus),this.events.forEach((function(t){e.on(t,e.options[camelCase("on ".concat(t))]||function(){})})),this.emit("init",{view:this.view,state:this.state}),this.extensions.view=this.view}},{key:"setOptions",value:function setOptions(e){this.options=_objectSpread2({},this.options,{},e),this.view&&this.state&&this.view.updateState(this.state)}},{key:"createExtensions",value:function createExtensions(){return new y([].concat(_toConsumableArray(this.builtInExtensions),_toConsumableArray(this.options.extensions)),this)}},{key:"createPlugins",value:function createPlugins(){return this.extensions.plugins}},{key:"createKeymaps",value:function createKeymaps(){return this.extensions.keymaps({schema:this.schema})}},{key:"createInputRules",value:function createInputRules(){return this.extensions.inputRules({schema:this.schema,excludedExtensions:this.options.disableInputRules})}},{key:"createPasteRules",value:function createPasteRules(){return this.extensions.pasteRules({schema:this.schema,excludedExtensions:this.options.disablePasteRules})}},{key:"createCommands",value:function createCommands(){return this.extensions.commands({schema:this.schema,view:this.view})}},{key:"createNodes",value:function createNodes(){return this.extensions.nodes}},{key:"createMarks",value:function createMarks(){return this.extensions.marks}},{key:"createSchema",value:function createSchema(){return new o.Schema({topNode:this.options.topNode,nodes:this.nodes,marks:this.marks})}},{key:"createState",value:function createState(){var e=this;return i.EditorState.create({schema:this.schema,doc:this.createDocument(this.options.content),plugins:[].concat(_toConsumableArray(this.plugins),[(0,l.Hw)({rules:this.inputRules})],_toConsumableArray(this.pasteRules),_toConsumableArray(this.keymaps),[(0,u.h)({Backspace:l.dU}),(0,u.h)(c.baseKeymap),(0,s.q)(this.options.dropCursor),(0,a.d)(),new i.Plugin({key:new i.PluginKey("editable"),props:{editable:function editable(){return e.options.editable}}}),new i.Plugin({props:{attributes:{tabindex:0},handleDOMEvents:{focus:function focus(t,n){e.focused=!0,e.emit("focus",{event:n,state:t.state,view:t});var i=e.state.tr.setMeta("focused",!0);e.view.dispatch(i)},blur:function blur(t,n){e.focused=!1,e.emit("blur",{event:n,state:t.state,view:t});var i=e.state.tr.setMeta("focused",!1);e.view.dispatch(i)}}}}),new i.Plugin({props:this.options.editorProps})])})}},{key:"createDocument",value:function createDocument(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.parseOptions;if(null===e)return this.schema.nodeFromJSON(this.options.emptyDocument);if("object"===_typeof(e))try{return this.schema.nodeFromJSON(e)}catch(t){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",t),this.schema.nodeFromJSON(this.options.emptyDocument)}if("string"==typeof e){var n=document.createElement("div");return n.innerHTML=e.trim(),o.DOMParser.fromSchema(this.schema).parse(n,t)}return!1}},{key:"createView",value:function createView(){var e=this;return new r.EditorView(this.element,{state:this.createState(),handlePaste:function handlePaste(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.emit.apply(e,["paste"].concat(n))},handleDrop:function handleDrop(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.emit.apply(e,["drop"].concat(n))},dispatchTransaction:this.dispatchTransaction.bind(this)})}},{key:"setParentComponent",value:function setParentComponent(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&this.view.setProps({nodeViews:this.initNodeViews({parent:e,extensions:[].concat(_toConsumableArray(this.builtInExtensions),_toConsumableArray(this.options.extensions))})})}},{key:"initNodeViews",value:function initNodeViews(e){var t=this,n=e.parent;return e.extensions.filter((function(e){return["node","mark"].includes(e.type)})).filter((function(e){return e.view})).reduce((function(e,i){return _objectSpread2({},e,_defineProperty({},i.name,(function nodeView(e,r,o,s){var a=i.view;return new f(a,{editor:t,extension:i,parent:n,node:e,view:r,getPos:o,decorations:s})})))}),{})}},{key:"dispatchTransaction",value:function dispatchTransaction(e){var t=this.state.apply(e);this.view.updateState(t),this.selection={from:this.state.selection.from,to:this.state.selection.to},this.setActiveNodesAndMarks(),this.emit("transaction",{getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this.emitUpdate(e)}},{key:"emitUpdate",value:function emitUpdate(e){this.emit("update",{getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:e})}},{key:"resolveSelection",value:function resolveSelection(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.selection&&null===e)return this.selection;if("start"===e||!0===e)return{from:0,to:0};if("end"===e){var t=this.state.doc;return{from:t.content.size,to:t.content.size}}return{from:e,to:e}}},{key:"focus",value:function focus(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!(this.view.focused&&null===t||!1===t)){var n=this.resolveSelection(t),i=n.from,r=n.to;this.setSelection(i,r),setTimeout((function(){return e.view.focus()}),10)}}},{key:"setSelection",value:function setSelection(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.state,r=n.doc,o=n.tr,s=minMax(e,0,r.content.size),a=minMax(t,0,r.content.size),u=i.TextSelection.create(r,s,a),c=o.setSelection(u);this.view.dispatch(c)}},{key:"blur",value:function blur(){this.view.dom.blur()}},{key:"getSchemaJSON",value:function getSchemaJSON(){return JSON.parse(JSON.stringify({nodes:this.extensions.nodes,marks:this.extensions.marks}))}},{key:"getHTML",value:function getHTML(){var e=document.createElement("div"),t=o.DOMSerializer.fromSchema(this.schema).serializeFragment(this.state.doc.content);return e.appendChild(t),e.innerHTML}},{key:"getJSON",value:function getJSON(){return this.state.doc.toJSON()}},{key:"setContent",value:function setContent(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.state,o=r.doc,s=r.tr,a=this.createDocument(e,n),u=i.TextSelection.create(o,0,o.content.size),c=s.setSelection(u).replaceSelectionWith(a,!1).setMeta("preventUpdate",!t);this.view.dispatch(c)}},{key:"clearContent",value:function clearContent(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setContent(this.options.emptyDocument,e)}},{key:"setActiveNodesAndMarks",value:function setActiveNodesAndMarks(){var e=this;this.activeMarks=Object.entries(this.schema.marks).reduce((function(t,n){var i=_slicedToArray(n,2),r=i[0],o=i[1];return _objectSpread2({},t,_defineProperty({},r,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,d.markIsActive)(e.state,o,t)})))}),{}),this.activeMarkAttrs=Object.entries(this.schema.marks).reduce((function(t,n){var i=_slicedToArray(n,2),r=i[0],o=i[1];return _objectSpread2({},t,_defineProperty({},r,(0,d.getMarkAttrs)(e.state,o)))}),{}),this.activeNodes=Object.entries(this.schema.nodes).reduce((function(t,n){var i=_slicedToArray(n,2),r=i[0],o=i[1];return _objectSpread2({},t,_defineProperty({},r,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,d.nodeIsActive)(e.state,o,t)})))}),{})}},{key:"getMarkAttrs",value:function getMarkAttrs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.activeMarkAttrs[e]}},{key:"getNodeAttrs",value:function getNodeAttrs$1(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return _objectSpread2({},(0,d.getNodeAttrs)(this.state,this.schema.nodes[e]))}},{key:"registerPlugin",value:function registerPlugin(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n="function"==typeof t?t(e,this.state.plugins):[e].concat(_toConsumableArray(this.state.plugins)),i=this.state.reconfigure({plugins:n});this.view.updateState(i)}},{key:"unregisterPlugin",value:function unregisterPlugin(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e&&this.view.docView){var t=this.state.reconfigure({plugins:this.state.plugins.filter((function(t){return!t.key.startsWith("".concat(e,"$"))}))});this.view.updateState(t)}}},{key:"destroy",value:function destroy(){this.view&&this.view.destroy()}},{key:"builtInExtensions",get:function get(){return this.options.useBuiltInExtensions?[new k,new _,new w]:[]}},{key:"state",get:function get(){return this.view?this.view.state:null}},{key:"isActive",get:function get(){return Object.entries(_objectSpread2({},this.activeMarks,{},this.activeNodes)).reduce((function(e,t){var n=_slicedToArray(t,2),i=n[0],r=n[1];return _objectSpread2({},e,_defineProperty({},i,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(e)})))}),{})}}]),Editor}(m),P={props:{editor:{default:null,type:Object}},watch:{editor:{immediate:!0,handler:function handler(e){var t=this;e&&e.element&&this.$nextTick((function(){t.$el.appendChild(e.element.firstChild),e.setParentComponent(t)}))}}},render:function render(e){return e("div")},beforeDestroy:function beforeDestroy(){this.editor.element=this.$el}},x=function(){function Menu(e){var t=this,n=e.options;_classCallCheck(this,Menu),this.options=n,this.preventHide=!1,this.mousedownHandler=this.handleClick.bind(this),this.options.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.blurHandler=function(){t.preventHide?t.preventHide=!1:t.options.editor.emit("menubar:focusUpdate",!1)},this.options.editor.on("blur",this.blurHandler)}return _createClass(Menu,[{key:"handleClick",value:function handleClick(){this.preventHide=!0}},{key:"destroy",value:function destroy(){this.options.element.removeEventListener("mousedown",this.mousedownHandler),this.options.editor.off("blur",this.blurHandler)}}]),Menu}();var M={props:{editor:{default:null,type:Object}},data:function data(){return{focused:!1}},watch:{editor:{immediate:!0,handler:function handler(e){var t=this;e&&this.$nextTick((function(){e.registerPlugin(function MenuBar(e){return new i.Plugin({key:new i.PluginKey("menu_bar"),view:function view(t){return new x({editorView:t,options:e})}})}({editor:e,element:t.$el})),t.focused=e.focused,e.on("focus",(function(){t.focused=!0})),e.on("menubar:focusUpdate",(function(e){t.focused=e}))}))}}},render:function render(){return this.editor?this.$scopedSlots.default({focused:this.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor),getNodeAttrs:this.editor.getNodeAttrs.bind(this.editor)}):null}};function textRange(e,t,n){var i=document.createRange();return i.setEnd(e,null==n?e.nodeValue.length:n),i.setStart(e,t||0),i}function singleRect(e,t){var n=e.getClientRects();return n.length?n[t<0?0:n.length-1]:e.getBoundingClientRect()}function coordsAtPos(e,t){var n,i,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.docView.domFromPos(t),s=o.node,a=o.offset;if(3===s.nodeType)r&&a<s.nodeValue.length?(i=singleRect(textRange(s,a-1,a),-1),n="right"):a<s.nodeValue.length&&(i=singleRect(textRange(s,a,a+1),-1),n="left");else if(s.firstChild){if(a<s.childNodes.length){var u=s.childNodes[a];i=singleRect(3===u.nodeType?textRange(u):u,-1),n="left"}if((!i||i.top===i.bottom)&&a){var c=s.childNodes[a-1];i=singleRect(3===c.nodeType?textRange(c):c,1),n="right"}}else i=s.getBoundingClientRect(),n="left";var l=i[n];return{top:i.top,bottom:i.bottom,left:l,right:l}}var S=function(){function Menu(e){var t=this,n=e.options,i=e.editorView;_classCallCheck(this,Menu),this.options=_objectSpread2({},{element:null,keepInBounds:!0,onUpdate:function onUpdate(){return!1}},{},n),this.editorView=i,this.isActive=!1,this.left=0,this.bottom=0,this.top=0,this.preventHide=!1,this.mousedownHandler=this.handleClick.bind(this),this.options.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.focusHandler=function(e){var n=e.view;t.update(n)},this.options.editor.on("focus",this.focusHandler),this.blurHandler=function(e){var n=e.event;t.preventHide?t.preventHide=!1:t.hide(n)},this.options.editor.on("blur",this.blurHandler)}return _createClass(Menu,[{key:"handleClick",value:function handleClick(){this.preventHide=!0}},{key:"update",value:function update(e,t){var n=e.state;if(!(e.composing||t&&t.doc.eq(n.doc)&&t.selection.eq(n.selection)))if(n.selection.empty)this.hide();else{var i=n.selection,r=i.from,o=i.to,s=coordsAtPos(e,r),a=coordsAtPos(e,o,!0),u=this.options.element.offsetParent;if(u){var c=u.getBoundingClientRect(),l=this.options.element.getBoundingClientRect(),d=(s.left+a.left)/2-c.left;this.left=Math.round(this.options.keepInBounds?Math.min(c.width-l.width/2,Math.max(d,l.width/2)):d),this.bottom=Math.round(c.bottom-s.top),this.top=Math.round(a.bottom-c.top),this.isActive=!0,this.sendUpdate()}else this.hide()}}},{key:"sendUpdate",value:function sendUpdate(){this.options.onUpdate({isActive:this.isActive,left:this.left,bottom:this.bottom,top:this.top})}},{key:"hide",value:function hide(e){e&&e.relatedTarget&&this.options.element.parentNode&&this.options.element.parentNode.contains(e.relatedTarget)||(this.isActive=!1,this.sendUpdate())}},{key:"destroy",value:function destroy(){this.options.element.removeEventListener("mousedown",this.mousedownHandler),this.options.editor.off("focus",this.focusHandler),this.options.editor.off("blur",this.blurHandler)}}]),Menu}();var O={props:{editor:{default:null,type:Object},keepInBounds:{default:!0,type:Boolean}},data:function data(){return{menu:{isActive:!1,left:0,bottom:0}}},watch:{editor:{immediate:!0,handler:function handler(e){var t=this;e&&this.$nextTick((function(){e.registerPlugin(function MenuBubble(e){return new i.Plugin({key:new i.PluginKey("menu_bubble"),view:function view(t){return new S({editorView:t,options:e})}})}({editor:e,element:t.$el,keepInBounds:t.keepInBounds,onUpdate:function onUpdate(e){e.isActive&&!1===t.menu.isActive?t.$emit("show",e):e.isActive||!0!==t.menu.isActive||t.$emit("hide",e),t.menu=e}}))}))}}},render:function render(){return this.editor?this.$scopedSlots.default({focused:this.editor.view.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor),getNodeAttrs:this.editor.getNodeAttrs.bind(this.editor),menu:this.menu}):null},beforeDestroy:function beforeDestroy(){this.editor.unregisterPlugin("menu_bubble")}},E=function(){function Menu(e){var t=this,n=e.options,i=e.editorView;_classCallCheck(this,Menu),this.options=_objectSpread2({},{resizeObserver:!0,element:null,onUpdate:function onUpdate(){return!1}},{},n),this.preventHide=!1,this.editorView=i,this.isActive=!1,this.top=0,this.mousedownHandler=this.handleClick.bind(this),this.options.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.focusHandler=function(e){var n=e.view;t.update(n)},this.options.editor.on("focus",this.focusHandler),this.blurHandler=function(e){var n=e.event;t.preventHide?t.preventHide=!1:t.hide(n)},this.options.editor.on("blur",this.blurHandler),this.options.resizeObserver&&window.ResizeObserver&&(this.resizeObserver=new ResizeObserver((function(){t.isActive&&t.update(t.editorView)})),this.resizeObserver.observe(this.editorView.dom))}return _createClass(Menu,[{key:"handleClick",value:function handleClick(){this.preventHide=!0}},{key:"update",value:function update(e,t){var n=e.state;if(!(t&&t.doc.eq(n.doc)&&t.selection.eq(n.selection)))if(n.selection.empty){var i=e.domAtPos(n.selection.anchor);if("<br>"===i.node.innerHTML&&"P"===i.node.tagName&&i.node.parentNode===e.dom){var r=this.options.element.offsetParent;if(r){var o=r.getBoundingClientRect(),s=e.coordsAtPos(n.selection.anchor).top-o.top;this.isActive=!0,this.top=s,this.sendUpdate()}else this.hide()}else this.hide()}else this.hide()}},{key:"sendUpdate",value:function sendUpdate(){this.options.onUpdate({isActive:this.isActive,top:this.top})}},{key:"hide",value:function hide(e){e&&e.relatedTarget&&this.options.element.parentNode&&this.options.element.parentNode.contains(e.relatedTarget)||(this.isActive=!1,this.sendUpdate())}},{key:"destroy",value:function destroy(){this.options.element.removeEventListener("mousedown",this.mousedownHandler),this.resizeObserver&&this.resizeObserver.unobserve(this.editorView.dom),this.options.editor.off("focus",this.focusHandler),this.options.editor.off("blur",this.blurHandler)}}]),Menu}();var j={props:{editor:{default:null,type:Object}},data:function data(){return{menu:{isActive:!1,left:0,bottom:0}}},watch:{editor:{immediate:!0,handler:function handler(e){var t=this;e&&this.$nextTick((function(){e.registerPlugin(function FloatingMenu(e){return new i.Plugin({key:new i.PluginKey("floating_menu"),view:function view(t){return new E({editorView:t,options:e})}})}({editor:e,element:t.$el,onUpdate:function onUpdate(e){e.isActive&&!1===t.menu.isActive?t.$emit("show",e):e.isActive||!0!==t.menu.isActive||t.$emit("hide",e),t.menu=e}}))}))}}},render:function render(){return this.editor?this.$scopedSlots.default({focused:this.editor.view.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor),getNodeAttrs:this.editor.getNodeAttrs.bind(this.editor),menu:this.menu}):null},beforeDestroy:function beforeDestroy(){this.editor.unregisterPlugin("floating_menu")}}}}]);